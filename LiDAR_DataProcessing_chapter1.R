#################### Process LiDAR data #########################################
# Load libraries 
library(dplyr)
library(lidR)

# Process LAZ files ------------------------------------------------------------
# Inputs: LAZ files for each site, CSV file with point centroids 
# Outputs: height normalized, clipped, filtered pointcounts (laz files)

## Core
# Domain 1: HARV ####################
ctg_HARV <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/DP1.30003.001/neon-aop-products/2017/FullSite/D01/2017_HARV_4/L1/DiscreteLidar/ClassifiedPointCloud")

temp <- read.csv("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/BirdPlot_AllPoints_HARV.csv")
HARV_plots <- unique(temp$plotID)

temp_miss <- read.csv("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/BirdPoints_Missing_HARV.csv")
HARV_plots_missing <- unique(temp_miss$plotID)

HARV_plots_all <- c(HARV_plots, HARV_plots_missing)
HARV_plots_all # list of all HARV plot IDs

# non-missing
test <- filter(temp, pointID=="B2")
E_B2 <- test$easting
N_B2 <- test$northing
E_B2 
N_B2

# missing
test_miss <- filter(temp_miss, pointID=="B2")
E_B2 <- test_miss$easting
N_B2 <- test_miss$northing
E_B2 
N_B2

## Clip the LiDAR to the plot radius (250m)
#"HARV_001" 
HARV1_circ_clip <- clip_circle(ctg_HARV, 725641.2, 4700331, radius=250)
#"HARV_004"
HARV4_circ_clip <- clip_circle(ctg_HARV, 728023.8, 4701009 , radius=250)
#"HARV_006" 
HARV6_circ_clip <- clip_circle(ctg_HARV, 726054.0, 4697972  , radius=250)
#"HARV_008" 
HARV8_circ_clip <- clip_circle(ctg_HARV, 728303.4, 4702757, radius=250)
#"HARV_012" 
HARV12_circ_clip <- clip_circle(ctg_HARV, 727057.9, 4701180, radius=250)
#"HARV_013" 
HARV13_circ_clip <- clip_circle(ctg_HARV, 726085.6, 4697024 , radius=250)
#"HARV_014"
HARV14_circ_clip <- clip_circle(ctg_HARV, 724800.0, 4705735, radius=250)
#"HARV_016" 
HARV16_circ_clip <- clip_circle(ctg_HARV, 727596.7, 4704367, radius=250)
#"HARV_021" 
HARV21_circ_clip <- clip_circle(ctg_HARV, 726128.6, 4703561 , radius=250)
#"HARV_023" 
HARV23_circ_clip <- clip_circle(ctg_HARV, 728046.8, 4699568, radius=250)
#"HARV_024" - missing 
HARV24_circ_clip <- clip_circle(ctg_HARV, 726034.8, 4704554, radius=250)
#"HARV_025" - missing
HARV25_circ_clip <- clip_circle(ctg_HARV, 724100.6, 4706398, radius=250)

# HARV filter
# Now we can examine the point cloud with a histogram and then filter out any extreme outliers that don't make sense. I was conservative in my filtering based on the bulk of where the points were. 

hist(HARV1_circ_clip@data$Z, breaks=100)
HARV1_circ_clip <- filter_poi(HARV1_circ_clip, Z >= 0, Z<= 250)

hist(HARV4_circ_clip@data$Z, breaks=100)
HARV4_circ_clip <-filter_poi(HARV4_circ_clip, Z >= 100, Z<= 300)

hist(HARV6_circ_clip@data$Z, breaks=100)
HARV6_circ_clip <- filter_poi(HARV6_circ_clip, Z >= 100, Z<= 300)

hist(HARV8_circ_clip@data$Z, breaks=100)
#HARV8_circ_clip <- filter_poi(HARV8_circ_clip, Z >= 180, Z<= 300)

hist(HARV12_circ_clip@data$Z, breaks=100)
HARV12_circ_clip<- filter_poi(HARV12_circ_clip, Z >= 200, Z<= 350)

hist(HARV13_circ_clip@data$Z, breaks=100)
HARV13_circ_clip <- filter_poi(HARV13_circ_clip, Z >= 150, Z<= 300)

hist(HARV14_circ_clip@data$Z, breaks=100)
HARV14_circ_clip <- filter_poi(HARV14_circ_clip, Z >= 150, Z<= 350)

hist(HARV16_circ_clip@data$Z, breaks=100)
HARV16_circ_clip <- filter_poi(HARV16_circ_clip, Z >= 110, Z<= 310)

hist(HARV21_circ_clip@data$Z, breaks=100)
HARV21_circ_clip <- filter_poi(HARV21_circ_clip, Z >= 100, Z<= 250)

hist(HARV23_circ_clip@data$Z, breaks=100) 
HARV23_circ_clip <- filter_poi(HARV23_circ_clip, Z >= 150, Z<= 250)

hist(HARV24_circ_clip@data$Z, breaks=100) 
HARV24_circ_clip <- filter_poi(HARV24_circ_clip, Z >= 150, Z<= 250)

hist(HARV25_circ_clip@data$Z, breaks=100) 
HARV25_circ_clip <- filter_poi(HARV25_circ_clip, Z >= 140, Z<= 270)

# HARV DTM
# Now create a Digital Terain Model to be used in the next step for height normalization. There are multiple methods to do this. I chose one based on recommendations. I'm using default values. 
HARV1_circ_clip_dtm_idw <- grid_terrain(HARV1_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV4_circ_clip_dtm_idw<- grid_terrain(HARV4_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV6_circ_clip_dtm_idw<- grid_terrain(HARV6_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV8_circ_clip_dtm_idw<- grid_terrain(HARV8_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV12_circ_clip_dtm_idw<- grid_terrain(HARV12_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV13_circ_clip_dtm_idw<- grid_terrain(HARV13_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV14_circ_clip_dtm_idw<- grid_terrain(HARV14_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV16_circ_clip_dtm_idw<- grid_terrain(HARV16_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV21_circ_clip_dtm_idw<- grid_terrain(HARV21_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV23_circ_clip_dtm_idw <- grid_terrain(HARV23_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV24_circ_clip_dtm_idw <- grid_terrain(HARV24_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HARV25_circ_clip_dtm_idw <- grid_terrain(HARV25_circ_clip, algorithm = knnidw(k = 10L, p = 2))

# HARV normalization
# Normalize to produce the final layers. Resulting heights now reflect just the tree heights now that elevational changes have been analyzed. I also am elminating any points bellow zero (ground level). Shannon diversity in particular cannot be calculated with negative values. I also clip a few remaining outliers based on plotting and histograms (similar to above). 
HARV1_rec_clip_normalized <- filter_poi(normalize_height(HARV1_circ_clip, HARV1_circ_clip_dtm_idw),Z >= 0)
HARV4_rec_clip_normalized <- filter_poi(normalize_height(HARV4_circ_clip, HARV4_circ_clip_dtm_idw),Z >= 0)
HARV6_rec_clip_normalized <- filter_poi(normalize_height(HARV6_circ_clip, HARV6_circ_clip_dtm_idw),Z >= 0)
HARV8_rec_clip_normalized <- filter_poi(normalize_height(HARV8_circ_clip, HARV8_circ_clip_dtm_idw),Z >= 0)
HARV12_rec_clip_normalized <- filter_poi(normalize_height(HARV12_circ_clip, HARV12_circ_clip_dtm_idw),Z >= 0)
HARV13_rec_clip_normalized <- filter_poi(normalize_height(HARV13_circ_clip, HARV13_circ_clip_dtm_idw),Z >= 0)
HARV14_rec_clip_normalized <- filter_poi(normalize_height(HARV14_circ_clip, HARV14_circ_clip_dtm_idw),Z >= 0)
HARV16_rec_clip_normalized <- filter_poi(normalize_height(HARV16_circ_clip, HARV16_circ_clip_dtm_idw),Z >= 0)
HARV21_rec_clip_normalized <- filter_poi(normalize_height(HARV21_circ_clip, HARV21_circ_clip_dtm_idw),Z >= 0)
HARV23_rec_clip_normalized <- filter_poi(normalize_height(HARV23_circ_clip, HARV23_circ_clip_dtm_idw),Z >= 0)
HARV24_rec_clip_normalized <- filter_poi(normalize_height(HARV24_circ_clip, HARV24_circ_clip_dtm_idw),Z >= 0)
HARV25_rec_clip_normalized <- filter_poi(normalize_height(HARV25_circ_clip, HARV25_circ_clip_dtm_idw),Z >= 0)

# write LAZ files so you can save them for later.
writeLAS(HARV1_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV1_rec_clip_normalized.laz")
writeLAS(HARV4_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV4_rec_clip_normalized.laz")
writeLAS(HARV6_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV6_rec_clip_normalized.laz")
writeLAS(HARV8_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV8_rec_clip_normalized.laz")
writeLAS(HARV12_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV12_rec_clip_normalized.laz")
writeLAS(HARV13_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV13_rec_clip_normalized.laz")
writeLAS(HARV14_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV14_rec_clip_normalized.laz")
writeLAS(HARV16_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV16_rec_clip_normalized.laz")
writeLAS(HARV21_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV21_rec_clip_normalized.laz")
writeLAS(HARV23_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV23_rec_clip_normalized.laz")
writeLAS(HARV24_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV24_rec_clip_normalized.laz")
writeLAS(HARV25_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_HARV/HtNorm_250_radius/HARV25_rec_clip_normalized.laz")


# Domain 2: SCBI #################### - point
ctg_SCBI <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/DP1.30003.001/neon-aop-products/2017/FullSite/D02/2017_SCBI_2/L1/DiscreteLidar/ClassifiedPointCloud")

temp <- read.csv("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/BirdPoints_AllPoints_SCBI.csv")
SCBI_plots <- unique(temp$plotID)

head(temp)
# points
E_B2 <- temp$easting_B2
N_B2 <- temp$northing_B2
E_B2 
N_B2

## Clip the LiDAR to the plot radius (250m)
#"SCBI_002"
SCBI2_circ_clip <- clip_circle(ctg_SCBI,747804.7,4309030,radius=250)
#"SCBI_003" 
SCBI3_circ_clip <- clip_circle(ctg_SCBI,749783.7,4307769,radius=250)
#"SCBI_004" 
SCBI4_circ_clip <- clip_circle(ctg_SCBI,747473.1, 4309211,radius=250)
#"SCBI_005" 
SCBI5_circ_clip <- clip_circle(ctg_SCBI,746124.7, 4309569,radius=250)
#"SCBI_006" 
SCBI6_circ_clip <- clip_circle(ctg_SCBI,746989.5, 4309271,radius=250)
#"SCBI_007"
SCBI7_circ_clip <- clip_circle(ctg_SCBI,748916.3, 4307920,radius=250)
#"SCBI_008" 
SCBI8_circ_clip <- clip_circle(ctg_SCBI,747443.7, 4308191,radius=250)
#"SCBI_010" 
SCBI10_circ_clip <- clip_circle(ctg_SCBI,749364.1, 4307919,radius=250)
#"SCBI_011"
SCBI11_circ_clip <- clip_circle(ctg_SCBI,748101.8, 4307319, radius=250)
#"SCBI_012" 
SCBI12_circ_clip <- clip_circle(ctg_SCBI,745553.9, 4308280, radius=250)
# "SCBI_013" 
SCBI13_circ_clip <- clip_circle(ctg_SCBI,746030.7, 4306660,radius=250)
#"SCBI_014" 
SCBI14_circ_clip <- clip_circle(ctg_SCBI,746093.5, 4305850,radius=250)
#"SCBI_015" 
SCBI15_circ_clip <- clip_circle(ctg_SCBI,747984.3, 4307832,radius=250)
#"SCBI_016" 
SCBI16_circ_clip <- clip_circle(ctg_SCBI,746390.6, 4309988, radius=250)
# "SCBI_017" 
SCBI17_circ_clip <- clip_circle(ctg_SCBI,748495.2, 4307290, radius=250)
# "SCBI_018" 
SCBI18_circ_clip <- clip_circle(ctg_SCBI,746602.4, 4306298,radius=250)
#"SCBI_019" 
SCBI19_circ_clip <- clip_circle(ctg_SCBI,744923.6, 4309543,radius=250)
#"SCBI_021"
SCBI21_circ_clip <- clip_circle(ctg_SCBI,746902.5, 4309628,radius=250)
#"SCBI_022" 
SCBI22_circ_clip <- clip_circle(ctg_SCBI,749543.7, 4307678,radius=250)
#"SCBI_023" 
SCBI23_circ_clip <- clip_circle(ctg_SCBI,747746.3, 4308039,radius=250)
#"SCBI_033" 
SCBI33_circ_clip <- clip_circle(ctg_SCBI,746213.3, 4308281,radius=250)
#"SCBI_035" 
SCBI35_circ_clip <- clip_circle(ctg_SCBI,745582.5, 4307591,radius=250)
#"SCBI_037" 
SCBI37_circ_clip <- clip_circle(ctg_SCBI,746182.4, 4308641,radius=250)
#"SCBI_039" 
SCBI39_circ_clip <- clip_circle(ctg_SCBI,745852.7, 4309002,radius=250)
#"SCBI_043"
SCBI43_circ_clip <- clip_circle(ctg_SCBI,747051.8, 4308491,radius=250)


# HARV filter
# Now we can examine the point cloud with a histogram and then filter out any extreme outliers that don't make sense. I was conservative in my filtering based on the bulk of where the points were. 
# SCBI 2
hist(SCBI2_circ_clip@data$Z, breaks=100)
SCBI2_circ_clip <- filter_poi(SCBI2_circ_clip, Z >= 200, Z<= 420)
# SCBI 3
hist(SCBI3_circ_clip@data$Z, breaks=100)
SCBI3_circ_clip <-filter_poi(SCBI3_circ_clip, Z >= 500, Z<= 700)
# SCBI 4
hist(SCBI4_circ_clip@data$Z, breaks=100)
SCBI4_circ_clip <-filter_poi(SCBI4_circ_clip, Z >= 200, Z<= 400)
# SCBI 5
hist(SCBI5_circ_clip@data$Z, breaks=100)
SCBI5_circ_clip <-filter_poi(SCBI5_circ_clip, Z >= 150, Z<= 375)
# SCBI 6
hist(SCBI6_circ_clip@data$Z, breaks=100)
SCBI6_circ_clip <-filter_poi(SCBI6_circ_clip, Z >= 200, Z<= 360)
# SCBI 7
hist(SCBI7_circ_clip@data$Z, breaks=100)
SCBI7_circ_clip <-filter_poi(SCBI7_circ_clip, Z >= 370, Z<= 600)
# SCBI 8
hist(SCBI8_circ_clip@data$Z, breaks=100)
SCBI8_circ_clip <-filter_poi(SCBI8_circ_clip, Z >= 269, Z<= 500)
# SCBI 10
hist(SCBI10_circ_clip@data$Z, breaks=100)
SCBI10_circ_clip <-filter_poi(SCBI10_circ_clip, Z >= 400, Z<= 620)
# SCBI 11
hist(SCBI11_circ_clip@data$Z, breaks=100)
SCBI11_circ_clip <-filter_poi(SCBI11_circ_clip, Z >= 150, Z<= 500)
# SCBI 12
hist(SCBI7_circ_clip@data$Z, breaks=100)
SCBI7_circ_clip <-filter_poi(SCBI7_circ_clip, Z >= 370, Z<= 600)
# SCBI 13
hist(SCBI13_circ_clip@data$Z, breaks=100)
SCBI13_circ_clip <-filter_poi(SCBI13_circ_clip, Z >= 250, Z<= 450)
# SCBI 14
hist(SCBI14_circ_clip@data$Z, breaks=100)
SCBI14_circ_clip <-filter_poi(SCBI14_circ_clip, Z >= 150, Z<= 480)
# SCBI 15
hist(SCBI15_circ_clip@data$Z, breaks=100)
SCBI15_circ_clip <-filter_poi(SCBI15_circ_clip, Z >= 150, Z<= 510)
# SCBI 16
hist(SCBI16_circ_clip@data$Z, breaks=100)
SCBI16_circ_clip <-filter_poi(SCBI16_circ_clip, Z >= 230, Z<= 400)
# SCBI 17
hist(SCBI17_circ_clip@data$Z, breaks=100)
SCBI17_circ_clip <-filter_poi(SCBI17_circ_clip, Z >= 150, Z<= 500)
# SCBI 18
hist(SCBI18_circ_clip@data$Z, breaks=100)
SCBI18_circ_clip <-filter_poi(SCBI18_circ_clip, Z >= 300, Z<= 475)
# SCBI 19
hist(SCBI19_circ_clip@data$Z, breaks=100)
SCBI19_circ_clip <-filter_poi(SCBI19_circ_clip, Z >= 220, Z<= 400)
# SCBI 21
hist(SCBI21_circ_clip@data$Z, breaks=100)
SCBI21_circ_clip <-filter_poi(SCBI21_circ_clip, Z >= 150, Z<= 360)
# SCBI 23
hist(SCBI23_circ_clip@data$Z, breaks=100)
SCBI23_circ_clip <-filter_poi(SCBI23_circ_clip, Z >= 200, Z<= 450)
# SCBI 33
hist(SCBI33_circ_clip@data$Z, breaks=100)
SCBI33_circ_clip <-filter_poi(SCBI33_circ_clip, Z >= 220, Z<= 370)
# SCBI 35
hist(SCBI35_circ_clip@data$Z, breaks=100)
SCBI35_circ_clip <-filter_poi(SCBI35_circ_clip, Z >= 200, Z<= 360)
# SCBI 39
hist(SCBI39_circ_clip@data$Z, breaks=100)
SCBI39_circ_clip <-filter_poi(SCBI39_circ_clip, Z >= 270, Z<= 420)
# SCBI 35
hist(SCBI35_circ_clip@data$Z, breaks=100)
SCBI35_circ_clip <-filter_poi(SCBI35_circ_clip, Z >= 150, Z<= 360)

# HARV DTM
# Now create a Digital Terain Model to be used in the next step for height normalization. There are multiple methods to do this. I chose one based on recommendations. I'm using default values. 
SCBI2_circ_clip_dtm_idw <- grid_terrain(SCBI2_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI3_circ_clip_dtm_idw <- grid_terrain(SCBI3_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI4_circ_clip_dtm_idw <- grid_terrain(SCBI4_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI5_circ_clip_dtm_idw <- grid_terrain(SCBI5_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI6_circ_clip_dtm_idw <- grid_terrain(SCBI6_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI7_circ_clip_dtm_idw <- grid_terrain(SCBI7_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI8_circ_clip_dtm_idw <- grid_terrain(SCBI8_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI10_circ_clip_dtm_idw <- grid_terrain(SCBI10_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI11_circ_clip_dtm_idw <- grid_terrain(SCBI11_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI12_circ_clip_dtm_idw <- grid_terrain(SCBI12_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI13_circ_clip_dtm_idw <- grid_terrain(SCBI13_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI14_circ_clip_dtm_idw <- grid_terrain(SCBI14_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI15_circ_clip_dtm_idw <- grid_terrain(SCBI15_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI16_circ_clip_dtm_idw <- grid_terrain(SCBI16_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI17_circ_clip_dtm_idw <- grid_terrain(SCBI17_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI18_circ_clip_dtm_idw <- grid_terrain(SCBI18_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI19_circ_clip_dtm_idw <- grid_terrain(SCBI19_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI21_circ_clip_dtm_idw <- grid_terrain(SCBI21_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI22_circ_clip_dtm_idw <- grid_terrain(SCBI22_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI23_circ_clip_dtm_idw <- grid_terrain(SCBI23_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI33_circ_clip_dtm_idw <- grid_terrain(SCBI33_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI35_circ_clip_dtm_idw <- grid_terrain(SCBI35_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI39_circ_clip_dtm_idw <- grid_terrain(SCBI39_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SCBI43_circ_clip_dtm_idw <- grid_terrain(SCBI43_circ_clip, algorithm = knnidw(k = 10L, p = 2))


# HARV normalization
# Normalize to produce the final layers. Resulting heights now reflect just the tree heights now that elevational changes have been analyzed. I also am elminating any points bellow zero (ground level). Shannon diversity in particular cannot be calculated with negative values. I also clip a few remaining outliers based on plotting and histograms (similar to above). 
SCBI2_rec_clip_normalized <- filter_poi(normalize_height(SCBI2_circ_clip, SCBI2_circ_clip_dtm_idw),Z >= 0)
SCBI3_rec_clip_normalized <- filter_poi(normalize_height(SCBI3_circ_clip, SCBI3_circ_clip_dtm_idw),Z >= 0)
SCBI4_rec_clip_normalized <- filter_poi(normalize_height(SCBI4_circ_clip, SCBI4_circ_clip_dtm_idw),Z >= 0)
SCBI5_rec_clip_normalized <- filter_poi(normalize_height(SCBI5_circ_clip, SCBI5_circ_clip_dtm_idw),Z >= 0)
SCBI6_rec_clip_normalized <- filter_poi(normalize_height(SCBI6_circ_clip, SCBI6_circ_clip_dtm_idw),Z >= 0)
SCBI7_rec_clip_normalized <- filter_poi(normalize_height(SCBI7_circ_clip, SCBI7_circ_clip_dtm_idw),Z >= 0)
SCBI8_rec_clip_normalized <- filter_poi(normalize_height(SCBI8_circ_clip, SCBI8_circ_clip_dtm_idw),Z >= 0)
SCBI10_rec_clip_normalized <- filter_poi(normalize_height(SCBI10_circ_clip, SCBI10_circ_clip_dtm_idw),Z >= 0)
SCBI11_rec_clip_normalized <- filter_poi(normalize_height(SCBI11_circ_clip, SCBI11_circ_clip_dtm_idw),Z >= 0)
SCBI12_rec_clip_normalized <- filter_poi(normalize_height(SCBI12_circ_clip, SCBI12_circ_clip_dtm_idw),Z >= 0)
SCBI13_rec_clip_normalized <- filter_poi(normalize_height(SCBI13_circ_clip, SCBI13_circ_clip_dtm_idw),Z >= 0)
SCBI14_rec_clip_normalized <- filter_poi(normalize_height(SCBI14_circ_clip, SCBI14_circ_clip_dtm_idw),Z >= 0)
SCBI15_rec_clip_normalized <- filter_poi(normalize_height(SCBI15_circ_clip, SCBI15_circ_clip_dtm_idw),Z >= 0)
SCBI16_rec_clip_normalized <- filter_poi(normalize_height(SCBI16_circ_clip, SCBI16_circ_clip_dtm_idw),Z >= 0)
SCBI17_rec_clip_normalized <- filter_poi(normalize_height(SCBI17_circ_clip, SCBI17_circ_clip_dtm_idw),Z >= 0)
SCBI18_rec_clip_normalized <- filter_poi(normalize_height(SCBI18_circ_clip, SCBI18_circ_clip_dtm_idw),Z >= 0)
SCBI19_rec_clip_normalized <- filter_poi(normalize_height(SCBI19_circ_clip, SCBI19_circ_clip_dtm_idw),Z >= 0)
SCBI21_rec_clip_normalized <- filter_poi(normalize_height(SCBI21_circ_clip, SCBI21_circ_clip_dtm_idw),Z >= 0)
SCBI22_rec_clip_normalized <- filter_poi(normalize_height(SCBI22_circ_clip, SCBI22_circ_clip_dtm_idw),Z >= 0)
SCBI23_rec_clip_normalized <- filter_poi(normalize_height(SCBI23_circ_clip, SCBI23_circ_clip_dtm_idw),Z >= 0)
SCBI33_rec_clip_normalized <- filter_poi(normalize_height(SCBI33_circ_clip, SCBI33_circ_clip_dtm_idw),Z >= 0)
SCBI35_rec_clip_normalized <- filter_poi(normalize_height(SCBI35_circ_clip, SCBI35_circ_clip_dtm_idw),Z >= 0)
SCBI39_rec_clip_normalized <- filter_poi(normalize_height(SCBI39_circ_clip, SCBI39_circ_clip_dtm_idw),Z >= 0)
SCBI43_rec_clip_normalized <- filter_poi(normalize_height(SCBI43_circ_clip, SCBI43_circ_clip_dtm_idw),Z >= 0)



# write LAZ files so you can save them for later.
writeLAS(SCBI2_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI2_rec_clip_normalized.laz")
writeLAS(SCBI3_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI3_rec_clip_normalized.laz")
writeLAS(SCBI4_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI4_rec_clip_normalized.laz")
writeLAS(SCBI5_rec_clip_normalized , "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI5_rec_clip_normalized.laz")
writeLAS(SCBI6_rec_clip_normalized , "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI6_rec_clip_normalized.laz")
writeLAS(SCBI7_rec_clip_normalized , "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI7_rec_clip_normalized.laz")
writeLAS(SCBI8_rec_clip_normalized , "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI8_rec_clip_normalized.laz")
writeLAS(SCBI10_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI10_rec_clip_normalized.laz")
writeLAS(SCBI11_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI11_rec_clip_normalized.laz")
writeLAS(SCBI12_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI12_rec_clip_normalized.laz")
writeLAS(SCBI13_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI13_rec_clip_normalized.laz")
writeLAS(SCBI14_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI14_rec_clip_normalized.laz")
writeLAS(SCBI15_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI15_rec_clip_normalized.laz")
writeLAS(SCBI16_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI16_rec_clip_normalized.laz")
writeLAS(SCBI17_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI17_rec_clip_normalized.laz")
writeLAS(SCBI18_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI18_rec_clip_normalized.laz")
writeLAS(SCBI19_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI19_rec_clip_normalized.laz")
writeLAS(SCBI21_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI21_rec_clip_normalized.laz")
writeLAS(SCBI22_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI22_rec_clip_normalized.laz")
writeLAS(SCBI23_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI23_rec_clip_normalized.laz")
writeLAS(SCBI33_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI33_rec_clip_normalized.laz")
writeLAS(SCBI35_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI35_rec_clip_normalized.laz")
writeLAS(SCBI39_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI39_rec_clip_normalized.laz")
writeLAS(SCBI43_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SCBI/HtNorm_250_radius/SCBI43_rec_clip_normalized.laz")

# Domain 3: OSBS ####################
ctg_OSBS <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/DP1.30003.001/neon-aop-products/2017/FullSite/D03/2017_OSBS_3/L1/DiscreteLidar/ClassifiedPointCloud")

OSBS_001_circ_clip <- clip_circle(ctg_OSBS,402542.846,3286268.041,radius=250)
OSBS_002_circ_clip <- clip_circle(ctg_OSBS,407446.949,3286324.647,radius=250)
OSBS_003_circ_clip <- clip_circle(ctg_OSBS,408557.411,3285274.775,radius=250)
OSBS_004_circ_clip <- clip_circle(ctg_OSBS,407126.098,3284005.412,radius=250)
OSBS_005_circ_clip <- clip_circle(ctg_OSBS,400889.669,3285453,radius=250)
OSBS_006_circ_clip <- clip_circle(ctg_OSBS,404893.717,3284492.647,radius=250)
OSBS_007_circ_clip <- clip_circle(ctg_OSBS,407091.051,3284912.622,radius=250)
OSBS_008_circ_clip <- clip_circle(ctg_OSBS,402559.271,3284155.521,radius=250)
OSBS_009_circ_clip <- clip_circle(ctg_OSBS,401715.7637,3285715.018,radius=250)
OSBS_012_circ_clip <- clip_circle(ctg_OSBS,404835.0496,3288040.304,radius=250)
OSBS_047_circ_clip <- clip_circle(ctg_OSBS,400952.3795,3283550.885,radius=250)
OSBS_063_circ_clip <- clip_circle(ctg_OSBS,406025.02,3284484.506,radius=250)
OSBS_065_circ_clip <- clip_circle(ctg_OSBS,404127.387,3285822.899,radius=250)
#
hist(OSBS_001_circ_clip@data$Z, breaks=100)
OSBS_001_circ_clip <- filter_poi(OSBS_001_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_002_circ_clip@data$Z, breaks=100)
OSBS_002_circ_clip <- filter_poi(OSBS_002_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_003_circ_clip@data$Z, breaks=100)
OSBS_003_circ_clip <- filter_poi(OSBS_003_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_004_circ_clip@data$Z, breaks=100)
OSBS_004_circ_clip <- filter_poi(OSBS_004_circ_clip, Z >= 0, Z<= 200)
hist(OSBS_005_circ_clip@data$Z, breaks=100)
OSBS_005_circ_clip <- filter_poi(OSBS_005_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_006_circ_clip@data$Z, breaks=100)
OSBS_006_circ_clip <- filter_poi(OSBS_006_circ_clip, Z >= 0, Z<= 200)
hist(OSBS_007_circ_clip@data$Z, breaks=100)
OSBS_007_circ_clip <- filter_poi(OSBS_007_circ_clip, Z >= 0, Z<= 200)
hist(OSBS_008_circ_clip@data$Z, breaks=100)
OSBS_008_circ_clip <- filter_poi(OSBS_008_circ_clip, Z >= 0, Z<= 200)
hist(OSBS_009_circ_clip@data$Z, breaks=100)
OSBS_009_circ_clip <- filter_poi(OSBS_009_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_012_circ_clip@data$Z, breaks=100)
OSBS_012_circ_clip <- filter_poi(OSBS_012_circ_clip, Z >= 0, Z<= 100)
hist(OSBS_047_circ_clip@data$Z, breaks=100)
OSBS_047_circ_clip <- filter_poi(OSBS_047_circ_clip, Z >= 0, Z<= 600)
hist(OSBS_063_circ_clip@data$Z, breaks=100)
OSBS_063_circ_clip <- filter_poi(OSBS_063_circ_clip, Z >= 0, Z<= 200)
hist(OSBS_065_circ_clip@data$Z, breaks=100)
OSBS_065_circ_clip <- filter_poi(OSBS_065_circ_clip, Z >= 0, Z<= 600)
#
OSBS_001_circ_clip_dtm_idw <- grid_terrain(OSBS_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_002_circ_clip_dtm_idw <- grid_terrain(OSBS_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_003_circ_clip_dtm_idw <- grid_terrain(OSBS_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_004_circ_clip_dtm_idw <- grid_terrain(OSBS_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_005_circ_clip_dtm_idw <- grid_terrain(OSBS_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_006_circ_clip_dtm_idw <- grid_terrain(OSBS_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_007_circ_clip_dtm_idw <- grid_terrain(OSBS_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_008_circ_clip_dtm_idw <- grid_terrain(OSBS_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_009_circ_clip_dtm_idw <- grid_terrain(OSBS_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_012_circ_clip_dtm_idw <- grid_terrain(OSBS_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_047_circ_clip_dtm_idw <- grid_terrain(OSBS_047_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_063_circ_clip_dtm_idw <- grid_terrain(OSBS_063_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OSBS_065_circ_clip_dtm_idw <- grid_terrain(OSBS_065_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
OSBS_001_rec_clip_normalized <- filter_poi(normalize_height(OSBS_001_circ_clip,OSBS_001_circ_clip_dtm_idw),Z >= 0)
OSBS_002_rec_clip_normalized <- filter_poi(normalize_height(OSBS_002_circ_clip,OSBS_002_circ_clip_dtm_idw),Z >= 0)
OSBS_003_rec_clip_normalized <- filter_poi(normalize_height(OSBS_003_circ_clip,OSBS_003_circ_clip_dtm_idw),Z >= 0)
OSBS_004_rec_clip_normalized <- filter_poi(normalize_height(OSBS_004_circ_clip,OSBS_004_circ_clip_dtm_idw),Z >= 0)
OSBS_005_rec_clip_normalized <- filter_poi(normalize_height(OSBS_005_circ_clip,OSBS_005_circ_clip_dtm_idw),Z >= 0)
OSBS_006_rec_clip_normalized <- filter_poi(normalize_height(OSBS_006_circ_clip,OSBS_006_circ_clip_dtm_idw),Z >= 0)
OSBS_007_rec_clip_normalized <- filter_poi(normalize_height(OSBS_007_circ_clip,OSBS_007_circ_clip_dtm_idw),Z >= 0)
OSBS_008_rec_clip_normalized <- filter_poi(normalize_height(OSBS_008_circ_clip,OSBS_008_circ_clip_dtm_idw),Z >= 0)
OSBS_009_rec_clip_normalized <- filter_poi(normalize_height(OSBS_009_circ_clip,OSBS_009_circ_clip_dtm_idw),Z >= 0)
OSBS_012_rec_clip_normalized <- filter_poi(normalize_height(OSBS_012_circ_clip,OSBS_012_circ_clip_dtm_idw),Z >= 0)
OSBS_047_rec_clip_normalized <- filter_poi(normalize_height(OSBS_047_circ_clip,OSBS_047_circ_clip_dtm_idw),Z >= 0)
OSBS_063_rec_clip_normalized <- filter_poi(normalize_height(OSBS_063_circ_clip,OSBS_063_circ_clip_dtm_idw),Z >= 0)
OSBS_065_rec_clip_normalized <- filter_poi(normalize_height(OSBS_065_circ_clip,OSBS_065_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(OSBS_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_001_rec_clip_normalized.laz")
writeLAS(OSBS_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_002_rec_clip_normalized.laz")
writeLAS(OSBS_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_003_rec_clip_normalized.laz")
writeLAS(OSBS_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_004_rec_clip_normalized.laz")
writeLAS(OSBS_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_005_rec_clip_normalized.laz")
writeLAS(OSBS_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_006_rec_clip_normalized.laz")
writeLAS(OSBS_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_007_rec_clip_normalized.laz")
writeLAS(OSBS_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_008_rec_clip_normalized.laz")
writeLAS(OSBS_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_009_rec_clip_normalized.laz")
writeLAS(OSBS_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_012_rec_clip_normalized.laz")
writeLAS(OSBS_047_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_047_rec_clip_normalized.laz")
writeLAS(OSBS_063_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_063_rec_clip_normalized.laz")
writeLAS(OSBS_065_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_OSBS/HtNorm_250_radius/OSBS_065_rec_clip_normalized.laz")

# Domain 5: UNDE ####################
ctg_UNDE <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/DP1.30003.001/neon-aop-products/2017/FullSite/D05/2017_UNDE_2/L1/DiscreteLidar/ClassifiedPointCloud")
UNDE_001_circ_clip <- clip_circle(ctg_UNDE,302554.92,5123279.253,radius=250)
UNDE_002_circ_clip <- clip_circle(ctg_UNDE,303745.673,5124211.306,radius=250)
UNDE_003_circ_clip <- clip_circle(ctg_UNDE,304538.127,5125619.47,radius=250)
UNDE_007_circ_clip <- clip_circle(ctg_UNDE,304509.858,5124779.004,radius=250)
UNDE_008_circ_clip <- clip_circle(ctg_UNDE,306320.236,5125628.813,radius=250)
UNDE_009_circ_clip <- clip_circle(ctg_UNDE,305960.175,5122435.196,radius=250)
UNDE_013_circ_clip <- clip_circle(ctg_UNDE,303981.858,5122546.451,radius=250)
UNDE_020_circ_clip <- clip_circle(ctg_UNDE,308341.555,5120230.807,radius=250)
UNDE_023_circ_clip <- clip_circle(ctg_UNDE,307269.995,5122542.234,radius=250)
UNDE_034_circ_clip <- clip_circle(ctg_UNDE,305680.3446,5124714.325,radius=250)
UNDE_035_circ_clip <- clip_circle(ctg_UNDE,306382.9727,5121193.091,radius=250)
UNDE_062_circ_clip <- clip_circle(ctg_UNDE,305527.931,5123602.013,radius=250)
#
hist(UNDE_001_circ_clip@data$Z, breaks=100)
hist(UNDE_002_circ_clip@data$Z, breaks=100)
hist(UNDE_003_circ_clip@data$Z, breaks=100)
hist(UNDE_007_circ_clip@data$Z, breaks=100)
hist(UNDE_008_circ_clip@data$Z, breaks=100)
hist(UNDE_009_circ_clip@data$Z, breaks=100)
hist(UNDE_013_circ_clip@data$Z, breaks=100)
hist(UNDE_020_circ_clip@data$Z, breaks=100)
hist(UNDE_023_circ_clip@data$Z, breaks=100)
hist(UNDE_034_circ_clip@data$Z, breaks=100)
hist(UNDE_035_circ_clip@data$Z, breaks=100)
hist(UNDE_062_circ_clip@data$Z, breaks=100)
UNDE_001_circ_clip <- filter_poi(UNDE_001_circ_clip, Z >= 0, Z<= 600)
UNDE_002_circ_clip <- filter_poi(UNDE_002_circ_clip, Z >= 0, Z<= 600)
UNDE_003_circ_clip <- filter_poi(UNDE_003_circ_clip, Z >= 470, Z<= 600)
UNDE_007_circ_clip <- filter_poi(UNDE_007_circ_clip, Z >= 0, Z<= 600)
UNDE_008_circ_clip <- filter_poi(UNDE_008_circ_clip, Z >= 0, Z<= 600)
UNDE_009_circ_clip <- filter_poi(UNDE_009_circ_clip, Z >= 400, Z<= 600)
UNDE_013_circ_clip <- filter_poi(UNDE_013_circ_clip, Z >= 400, Z<= 700)
UNDE_020_circ_clip <- filter_poi(UNDE_020_circ_clip, Z >= 450, Z<= 550)
UNDE_023_circ_clip <- filter_poi(UNDE_023_circ_clip, Z >= 0, Z<= 600)
UNDE_034_circ_clip <- filter_poi(UNDE_034_circ_clip, Z >= 0, Z<= 600)
UNDE_035_circ_clip <- filter_poi(UNDE_035_circ_clip, Z >= 0, Z<= 600)
UNDE_062_circ_clip <- filter_poi(UNDE_062_circ_clip, Z >= 490, Z<= 600)
#
UNDE_001_circ_clip_dtm_idw <- grid_terrain(UNDE_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_002_circ_clip_dtm_idw <- grid_terrain(UNDE_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_003_circ_clip_dtm_idw <- grid_terrain(UNDE_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_007_circ_clip_dtm_idw <- grid_terrain(UNDE_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_008_circ_clip_dtm_idw <- grid_terrain(UNDE_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_009_circ_clip_dtm_idw <- grid_terrain(UNDE_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_013_circ_clip_dtm_idw <- grid_terrain(UNDE_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_020_circ_clip_dtm_idw <- grid_terrain(UNDE_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_023_circ_clip_dtm_idw <- grid_terrain(UNDE_023_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_034_circ_clip_dtm_idw <- grid_terrain(UNDE_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_035_circ_clip_dtm_idw <- grid_terrain(UNDE_035_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UNDE_062_circ_clip_dtm_idw <- grid_terrain(UNDE_062_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
UNDE_001_rec_clip_normalized <- filter_poi(normalize_height(UNDE_001_circ_clip,UNDE_001_circ_clip_dtm_idw),Z >= 0)
UNDE_002_rec_clip_normalized <- filter_poi(normalize_height(UNDE_002_circ_clip,UNDE_002_circ_clip_dtm_idw),Z >= 0)
UNDE_003_rec_clip_normalized <- filter_poi(normalize_height(UNDE_003_circ_clip,UNDE_003_circ_clip_dtm_idw),Z >= 0)
UNDE_007_rec_clip_normalized <- filter_poi(normalize_height(UNDE_007_circ_clip,UNDE_007_circ_clip_dtm_idw),Z >= 0)
UNDE_008_rec_clip_normalized <- filter_poi(normalize_height(UNDE_008_circ_clip,UNDE_008_circ_clip_dtm_idw),Z >= 0)
UNDE_009_rec_clip_normalized <- filter_poi(normalize_height(UNDE_009_circ_clip,UNDE_009_circ_clip_dtm_idw),Z >= 0)
UNDE_013_rec_clip_normalized <- filter_poi(normalize_height(UNDE_013_circ_clip,UNDE_013_circ_clip_dtm_idw),Z >= 0)
UNDE_020_rec_clip_normalized <- filter_poi(normalize_height(UNDE_020_circ_clip,UNDE_020_circ_clip_dtm_idw),Z >= 0)
UNDE_023_rec_clip_normalized <- filter_poi(normalize_height(UNDE_023_circ_clip,UNDE_023_circ_clip_dtm_idw),Z >= 0)
UNDE_034_rec_clip_normalized <- filter_poi(normalize_height(UNDE_034_circ_clip,UNDE_034_circ_clip_dtm_idw),Z >= 0)
UNDE_035_rec_clip_normalized <- filter_poi(normalize_height(UNDE_035_circ_clip,UNDE_035_circ_clip_dtm_idw),Z >= 0)
UNDE_062_rec_clip_normalized <- filter_poi(normalize_height(UNDE_062_circ_clip,UNDE_062_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(UNDE_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_001_rec_clip_normalized.laz")
writeLAS(UNDE_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_002_rec_clip_normalized.laz")
writeLAS(UNDE_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_003_rec_clip_normalized.laz")
writeLAS(UNDE_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_007_rec_clip_normalized.laz")
writeLAS(UNDE_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_008_rec_clip_normalized.laz")
writeLAS(UNDE_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_009_rec_clip_normalized.laz")
writeLAS(UNDE_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_013_rec_clip_normalized.laz")
writeLAS(UNDE_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_020_rec_clip_normalized.laz")
writeLAS(UNDE_023_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_023_rec_clip_normalized.laz")
writeLAS(UNDE_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_034_rec_clip_normalized.laz")
writeLAS(UNDE_035_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_035_rec_clip_normalized.laz")
writeLAS(UNDE_062_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_UNDE/HtNorm_250_radius/UNDE_062_rec_clip_normalized.laz")

# Domain 6: KONZ ####################
ctg_KONZ <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/DP1.30003.001/neon-aop-products/2017/FullSite/D06/2017_KONZ_2/L1/DiscreteLidar/ClassifiedPointCloud")
KONZ_001_circ_clip <- clip_circle(ctg_KONZ,711440.811,4328162.241,radius=250)
KONZ_002_circ_clip <- clip_circle(ctg_KONZ,712361.257,4332952.414,radius=250)
KONZ_003_circ_clip <- clip_circle(ctg_KONZ,710161.557,4329336.064,radius=250)
KONZ_005_circ_clip <- clip_circle(ctg_KONZ,710283.131,4328557.281,radius=250)
KONZ_006_circ_clip <- clip_circle(ctg_KONZ,708603.828,4327418.079,radius=250)
KONZ_007_circ_clip <- clip_circle(ctg_KONZ,712341.206,4329279.483,radius=250)
KONZ_008_circ_clip <- clip_circle(ctg_KONZ,712220.02,4331657.978,radius=250)
KONZ_010_circ_clip <- clip_circle(ctg_KONZ,710286.782,4327667.385,radius=250)
KONZ_013_circ_clip <- clip_circle(ctg_KONZ,711191.66,4329419.515,radius=250)
KONZ_025_circ_clip <- clip_circle(ctg_KONZ,707879.859,4331048.959,radius=250)
KONZ_027_circ_clip <- clip_circle(ctg_KONZ,708905.4576,4330875.508,radius=250)
KONZ_031_circ_clip <- clip_circle(ctg_KONZ,708798.7495,4329729.741,radius=250)
#
hist(KONZ_001_circ_clip@data$Z, breaks=100)
hist(KONZ_002_circ_clip@data$Z, breaks=100)
hist(KONZ_003_circ_clip@data$Z, breaks=100)
hist(KONZ_005_circ_clip@data$Z, breaks=100)
hist(KONZ_006_circ_clip@data$Z, breaks=100)
hist(KONZ_007_circ_clip@data$Z, breaks=100)
hist(KONZ_008_circ_clip@data$Z, breaks=100)
hist(KONZ_010_circ_clip@data$Z, breaks=100)
hist(KONZ_013_circ_clip@data$Z, breaks=100)
hist(KONZ_025_circ_clip@data$Z, breaks=100)
hist(KONZ_027_circ_clip@data$Z, breaks=100)
hist(KONZ_031_circ_clip@data$Z, breaks=100)
KONZ_001_circ_clip <- filter_poi(KONZ_001_circ_clip, Z >= 400, Z<= 600)
KONZ_002_circ_clip <- filter_poi(KONZ_002_circ_clip, Z >= 300, Z<= 500)
KONZ_003_circ_clip <- filter_poi(KONZ_003_circ_clip, Z >= 300, Z<= 420)
KONZ_005_circ_clip <- filter_poi(KONZ_005_circ_clip, Z >= 300, Z<= 500)
KONZ_006_circ_clip <- filter_poi(KONZ_006_circ_clip, Z >= 300, Z<= 500)
KONZ_007_circ_clip <- filter_poi(KONZ_007_circ_clip, Z >= 100, Z<= 600)
KONZ_008_circ_clip <- filter_poi(KONZ_008_circ_clip, Z >= 300, Z<= 500)
KONZ_010_circ_clip <- filter_poi(KONZ_010_circ_clip, Z >= 100, Z<= 500)
KONZ_013_circ_clip <- filter_poi(KONZ_013_circ_clip, Z >= 350, Z<= 600)
KONZ_025_circ_clip <- filter_poi(KONZ_025_circ_clip, Z >= 100, Z<= 400)
KONZ_027_circ_clip <- filter_poi(KONZ_027_circ_clip, Z >= 300, Z<= 500)
KONZ_031_circ_clip <- filter_poi(KONZ_031_circ_clip, Z >= 300, Z<= 400)
#
KONZ_001_circ_clip_dtm_idw <- grid_terrain(KONZ_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_002_circ_clip_dtm_idw <- grid_terrain(KONZ_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_003_circ_clip_dtm_idw <- grid_terrain(KONZ_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_005_circ_clip_dtm_idw <- grid_terrain(KONZ_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_006_circ_clip_dtm_idw <- grid_terrain(KONZ_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_007_circ_clip_dtm_idw <- grid_terrain(KONZ_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_008_circ_clip_dtm_idw <- grid_terrain(KONZ_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_010_circ_clip_dtm_idw <- grid_terrain(KONZ_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_013_circ_clip_dtm_idw <- grid_terrain(KONZ_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_025_circ_clip_dtm_idw <- grid_terrain(KONZ_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_027_circ_clip_dtm_idw <- grid_terrain(KONZ_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
KONZ_031_circ_clip_dtm_idw <- grid_terrain(KONZ_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
KONZ_001_rec_clip_normalized <- filter_poi(normalize_height(KONZ_001_circ_clip,KONZ_001_circ_clip_dtm_idw),Z >= 0)
KONZ_002_rec_clip_normalized <- filter_poi(normalize_height(KONZ_002_circ_clip,KONZ_002_circ_clip_dtm_idw),Z >= 0)
KONZ_003_rec_clip_normalized <- filter_poi(normalize_height(KONZ_003_circ_clip,KONZ_003_circ_clip_dtm_idw),Z >= 0)
KONZ_005_rec_clip_normalized <- filter_poi(normalize_height(KONZ_005_circ_clip,KONZ_005_circ_clip_dtm_idw),Z >= 0)
KONZ_006_rec_clip_normalized <- filter_poi(normalize_height(KONZ_006_circ_clip,KONZ_006_circ_clip_dtm_idw),Z >= 0)
KONZ_007_rec_clip_normalized <- filter_poi(normalize_height(KONZ_007_circ_clip,KONZ_007_circ_clip_dtm_idw),Z >= 0)
KONZ_008_rec_clip_normalized <- filter_poi(normalize_height(KONZ_008_circ_clip,KONZ_008_circ_clip_dtm_idw),Z >= 0)
KONZ_010_rec_clip_normalized <- filter_poi(normalize_height(KONZ_010_circ_clip,KONZ_010_circ_clip_dtm_idw),Z >= 0)
KONZ_013_rec_clip_normalized <- filter_poi(normalize_height(KONZ_013_circ_clip,KONZ_013_circ_clip_dtm_idw),Z >= 0)
KONZ_025_rec_clip_normalized <- filter_poi(normalize_height(KONZ_025_circ_clip,KONZ_025_circ_clip_dtm_idw),Z >= 0)
KONZ_027_rec_clip_normalized <- filter_poi(normalize_height(KONZ_027_circ_clip,KONZ_027_circ_clip_dtm_idw),Z >= 0)
KONZ_031_rec_clip_normalized <- filter_poi(normalize_height(KONZ_031_circ_clip,KONZ_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(KONZ_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_001_rec_clip_normalized.laz")
writeLAS(KONZ_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_002_rec_clip_normalized.laz")
writeLAS(KONZ_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_003_rec_clip_normalized.laz")
writeLAS(KONZ_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_005_rec_clip_normalized.laz")
writeLAS(KONZ_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_006_rec_clip_normalized.laz")
writeLAS(KONZ_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_007_rec_clip_normalized.laz")
writeLAS(KONZ_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_008_rec_clip_normalized.laz")
writeLAS(KONZ_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_010_rec_clip_normalized.laz")
writeLAS(KONZ_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_013_rec_clip_normalized.laz")
writeLAS(KONZ_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_025_rec_clip_normalized.laz")
writeLAS(KONZ_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_027_rec_clip_normalized.laz")
writeLAS(KONZ_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_KONZ/HtNorm_250_radius/KONZ_031_rec_clip_normalized.laz")

# Domain 8:TALL ####################
ctg_TALL <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/DP1.30003.001/neon-aop-products/2017/FullSite/D08/2017_TALL_3/L1/DiscreteLidar/ClassifiedPointCloud")
TALL_001_circ_clip <- clip_circle(ctg_TALL,459713.821,3648823.568,radius=250)
TALL_002_circ_clip <- clip_circle(ctg_TALL,459896.437,3642713.863,radius=250)
TALL_004_circ_clip <- clip_circle(ctg_TALL,459669.108,3646877.151,radius=250)
TALL_006_circ_clip <- clip_circle(ctg_TALL,458299.32,3640290.198,radius=250)
TALL_009_circ_clip <- clip_circle(ctg_TALL,461826.334,3640244.985,radius=250)
TALL_010_circ_clip <- clip_circle(ctg_TALL,460858.055,3643225.33,radius=250)
TALL_011_circ_clip <- clip_circle(ctg_TALL,461820.331,3646419.138,radius=250)
TALL_012_circ_clip <- clip_circle(ctg_TALL,462858.778,3642192.832,radius=250)
TALL_013_circ_clip <- clip_circle(ctg_TALL,457650.791,3638576.73,radius=250)
TALL_015_circ_clip <- clip_circle(ctg_TALL,459044.1863,3642230.667,radius=250)
TALL_017_circ_clip <- clip_circle(ctg_TALL,461791.013,3641355.867,radius=250)
TALL_018_circ_clip <- clip_circle(ctg_TALL,463732.9618,3641993.241,radius=250)
TALL_025_circ_clip <- clip_circle(ctg_TALL,463076.0616,3640166.139,radius=250)
TALL_027_circ_clip <- clip_circle(ctg_TALL,459529.2445,3639278.97,radius=250)
TALL_029_circ_clip <- clip_circle(ctg_TALL,459670.7042,3640546.535,radius=250)
#
hist(TALL_001_circ_clip@data$Z, breaks=100)
hist(TALL_002_circ_clip@data$Z, breaks=100)
hist(TALL_004_circ_clip@data$Z, breaks=100)
hist(TALL_006_circ_clip@data$Z, breaks=100)
hist(TALL_009_circ_clip@data$Z, breaks=100)
hist(TALL_010_circ_clip@data$Z, breaks=100)
hist(TALL_011_circ_clip@data$Z, breaks=100)
hist(TALL_012_circ_clip@data$Z, breaks=100)
hist(TALL_013_circ_clip@data$Z, breaks=100)
hist(TALL_015_circ_clip@data$Z, breaks=100)
hist(TALL_017_circ_clip@data$Z, breaks=100)
hist(TALL_018_circ_clip@data$Z, breaks=100)
hist(TALL_025_circ_clip@data$Z, breaks=100)
hist(TALL_027_circ_clip@data$Z, breaks=100)
hist(TALL_029_circ_clip@data$Z, breaks=100)
TALL_001_circ_clip <- filter_poi(TALL_001_circ_clip, Z >= 0, Z<= 600)
TALL_002_circ_clip <- filter_poi(TALL_002_circ_clip, Z >= 0, Z<= 200)
TALL_004_circ_clip <- filter_poi(TALL_004_circ_clip, Z >= 0, Z<= 600)
TALL_006_circ_clip <- filter_poi(TALL_006_circ_clip, Z >= 0, Z<= 600)
TALL_009_circ_clip <- filter_poi(TALL_009_circ_clip, Z >= 0, Z<= 200)
TALL_010_circ_clip <- filter_poi(TALL_010_circ_clip, Z >= 0, Z<= 600)
TALL_011_circ_clip <- filter_poi(TALL_011_circ_clip, Z >= 0, Z<= 600)
TALL_012_circ_clip <- filter_poi(TALL_012_circ_clip, Z >= 100, Z<= 600)
TALL_013_circ_clip <- filter_poi(TALL_013_circ_clip, Z >= 100, Z<= 600)
TALL_015_circ_clip <- filter_poi(TALL_015_circ_clip, Z >= 100, Z<= 600)
TALL_017_circ_clip <- filter_poi(TALL_017_circ_clip, Z >= 0, Z<= 600)
TALL_018_circ_clip <- filter_poi(TALL_018_circ_clip, Z >= 0, Z<= 190)
TALL_025_circ_clip <- filter_poi(TALL_025_circ_clip, Z >= 0, Z<= 600)
TALL_027_circ_clip <- filter_poi(TALL_027_circ_clip, Z >= 0, Z<= 160)
TALL_029_circ_clip <- filter_poi(TALL_029_circ_clip, Z >= 0, Z<= 170)
#
TALL_001_circ_clip_dtm_idw <- grid_terrain(TALL_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_002_circ_clip_dtm_idw <- grid_terrain(TALL_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_004_circ_clip_dtm_idw <- grid_terrain(TALL_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_006_circ_clip_dtm_idw <- grid_terrain(TALL_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_009_circ_clip_dtm_idw <- grid_terrain(TALL_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_010_circ_clip_dtm_idw <- grid_terrain(TALL_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_011_circ_clip_dtm_idw <- grid_terrain(TALL_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_012_circ_clip_dtm_idw <- grid_terrain(TALL_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_013_circ_clip_dtm_idw <- grid_terrain(TALL_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_015_circ_clip_dtm_idw <- grid_terrain(TALL_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_017_circ_clip_dtm_idw <- grid_terrain(TALL_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_018_circ_clip_dtm_idw <- grid_terrain(TALL_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_025_circ_clip_dtm_idw <- grid_terrain(TALL_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_027_circ_clip_dtm_idw <- grid_terrain(TALL_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TALL_029_circ_clip_dtm_idw <- grid_terrain(TALL_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
TALL_001_rec_clip_normalized <- filter_poi(normalize_height(TALL_001_circ_clip,TALL_001_circ_clip_dtm_idw),Z >= 0)
TALL_002_rec_clip_normalized <- filter_poi(normalize_height(TALL_002_circ_clip,TALL_002_circ_clip_dtm_idw),Z >= 0)
TALL_004_rec_clip_normalized <- filter_poi(normalize_height(TALL_004_circ_clip,TALL_004_circ_clip_dtm_idw),Z >= 0)
TALL_006_rec_clip_normalized <- filter_poi(normalize_height(TALL_006_circ_clip,TALL_006_circ_clip_dtm_idw),Z >= 0)
TALL_009_rec_clip_normalized <- filter_poi(normalize_height(TALL_009_circ_clip,TALL_009_circ_clip_dtm_idw),Z >= 0)
TALL_010_rec_clip_normalized <- filter_poi(normalize_height(TALL_010_circ_clip,TALL_010_circ_clip_dtm_idw),Z >= 0)
TALL_011_rec_clip_normalized <- filter_poi(normalize_height(TALL_011_circ_clip,TALL_011_circ_clip_dtm_idw),Z >= 0)
TALL_012_rec_clip_normalized <- filter_poi(normalize_height(TALL_012_circ_clip,TALL_012_circ_clip_dtm_idw),Z >= 0)
TALL_013_rec_clip_normalized <- filter_poi(normalize_height(TALL_013_circ_clip,TALL_013_circ_clip_dtm_idw),Z >= 0)
TALL_015_rec_clip_normalized <- filter_poi(normalize_height(TALL_015_circ_clip,TALL_015_circ_clip_dtm_idw),Z >= 0)
TALL_017_rec_clip_normalized <- filter_poi(normalize_height(TALL_017_circ_clip,TALL_017_circ_clip_dtm_idw),Z >= 0)
TALL_018_rec_clip_normalized <- filter_poi(normalize_height(TALL_018_circ_clip,TALL_018_circ_clip_dtm_idw),Z >= 0)
TALL_025_rec_clip_normalized <- filter_poi(normalize_height(TALL_025_circ_clip,TALL_025_circ_clip_dtm_idw),Z >= 0)
TALL_027_rec_clip_normalized <- filter_poi(normalize_height(TALL_027_circ_clip,TALL_027_circ_clip_dtm_idw),Z >= 0)
TALL_029_rec_clip_normalized <- filter_poi(normalize_height(TALL_029_circ_clip,TALL_029_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(TALL_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_001_rec_clip_normalized.laz")
writeLAS(TALL_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_002_rec_clip_normalized.laz")
writeLAS(TALL_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_004_rec_clip_normalized.laz")
writeLAS(TALL_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_006_rec_clip_normalized.laz")
writeLAS(TALL_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_009_rec_clip_normalized.laz")
writeLAS(TALL_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_010_rec_clip_normalized.laz")
writeLAS(TALL_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_011_rec_clip_normalized.laz")
writeLAS(TALL_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_012_rec_clip_normalized.laz")
writeLAS(TALL_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_013_rec_clip_normalized.laz")
writeLAS(TALL_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_015_rec_clip_normalized.laz")
writeLAS(TALL_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_017_rec_clip_normalized.laz")
writeLAS(TALL_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_018_rec_clip_normalized.laz")
writeLAS(TALL_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_025_rec_clip_normalized.laz")
writeLAS(TALL_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_027_rec_clip_normalized.laz")
writeLAS(TALL_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_TALL/HtNorm_250_radius/TALL_029_rec_clip_normalized.laz")

# Domain 9:WOOD ####################
ctg_WOOD <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/DP1.30003.001/neon-aop-products/2017/FullSite/D09/2017_WOOD_2/L1/DiscreteLidar/ClassifiedPointCloud")
WOOD_006_circ_clip <- clip_circle(ctg_WOOD,481319.031,5221053.755,radius=250)
WOOD_008_circ_clip <- clip_circle(ctg_WOOD,483879.884,5221054.296,radius=250)
WOOD_009_circ_clip <- clip_circle(ctg_WOOD,482419.681,5221418.221,radius=250)
WOOD_011_circ_clip <- clip_circle(ctg_WOOD,480029.89,5219388.473,radius=250)
WOOD_012_circ_clip <- clip_circle(ctg_WOOD,482308.532,5219344.159,radius=250)
WOOD_013_circ_clip <- clip_circle(ctg_WOOD,482375.658,5220650.164,radius=250)
WOOD_020_circ_clip <- clip_circle(ctg_WOOD,480604.654,5220337.586,radius=250)
WOOD_029_circ_clip <- clip_circle(ctg_WOOD,481481.065,5218576.264,radius=250)
WOOD_031_circ_clip <- clip_circle(ctg_WOOD,480588.186,5221793.007,radius=250)
#
hist(WOOD_006_circ_clip@data$Z, breaks=100)
hist(WOOD_008_circ_clip@data$Z, breaks=100)
hist(WOOD_009_circ_clip@data$Z, breaks=100)
hist(WOOD_011_circ_clip@data$Z, breaks=100)
hist(WOOD_012_circ_clip@data$Z, breaks=100)
hist(WOOD_013_circ_clip@data$Z, breaks=100)
hist(WOOD_020_circ_clip@data$Z, breaks=100)
hist(WOOD_029_circ_clip@data$Z, breaks=100)
hist(WOOD_031_circ_clip@data$Z, breaks=100)
WOOD_006_circ_clip <- filter_poi(WOOD_006_circ_clip, Z >= 100, Z<= 700)
WOOD_008_circ_clip <- filter_poi(WOOD_008_circ_clip, Z >= 500, Z<= 650)
WOOD_009_circ_clip <- filter_poi(WOOD_009_circ_clip, Z >= 520, Z<= 650)
WOOD_011_circ_clip <- filter_poi(WOOD_011_circ_clip, Z >= 550, Z<= 615)
WOOD_012_circ_clip <- filter_poi(WOOD_012_circ_clip, Z >= 500, Z<= 600)
WOOD_013_circ_clip <- filter_poi(WOOD_013_circ_clip, Z >= 550, Z<= 610)
WOOD_020_circ_clip <- filter_poi(WOOD_020_circ_clip, Z >= 100, Z<= 600)
WOOD_029_circ_clip <- filter_poi(WOOD_029_circ_clip, Z >= 100, Z<= 700)
WOOD_031_circ_clip <- filter_poi(WOOD_031_circ_clip, Z >= 550, Z<= 650)
#
WOOD_006_circ_clip_dtm_idw <- grid_terrain(WOOD_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_008_circ_clip_dtm_idw <- grid_terrain(WOOD_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_009_circ_clip_dtm_idw <- grid_terrain(WOOD_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_011_circ_clip_dtm_idw <- grid_terrain(WOOD_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_012_circ_clip_dtm_idw <- grid_terrain(WOOD_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_013_circ_clip_dtm_idw <- grid_terrain(WOOD_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_020_circ_clip_dtm_idw <- grid_terrain(WOOD_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_029_circ_clip_dtm_idw <- grid_terrain(WOOD_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
WOOD_031_circ_clip_dtm_idw <- grid_terrain(WOOD_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
WOOD_006_rec_clip_normalized <- filter_poi(normalize_height(WOOD_006_circ_clip,WOOD_006_circ_clip_dtm_idw),Z >= 0)
WOOD_008_rec_clip_normalized <- filter_poi(normalize_height(WOOD_008_circ_clip,WOOD_008_circ_clip_dtm_idw),Z >= 0)
WOOD_009_rec_clip_normalized <- filter_poi(normalize_height(WOOD_009_circ_clip,WOOD_009_circ_clip_dtm_idw),Z >= 0)
WOOD_011_rec_clip_normalized <- filter_poi(normalize_height(WOOD_011_circ_clip,WOOD_011_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
WOOD_012_rec_clip_normalized <- filter_poi(normalize_height(WOOD_012_circ_clip,WOOD_012_circ_clip_dtm_idw),Z >= 0)
WOOD_013_rec_clip_normalized <- filter_poi(normalize_height(WOOD_013_circ_clip,WOOD_013_circ_clip_dtm_idw),Z >= 0)
WOOD_020_rec_clip_normalized <- filter_poi(normalize_height(WOOD_020_circ_clip,WOOD_020_circ_clip_dtm_idw),Z >= 0)
WOOD_029_rec_clip_normalized <- filter_poi(normalize_height(WOOD_029_circ_clip,WOOD_029_circ_clip_dtm_idw),Z >= 0)
WOOD_031_rec_clip_normalized <- filter_poi(normalize_height(WOOD_031_circ_clip,WOOD_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(WOOD_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_006_rec_clip_normalized.laz")
writeLAS(WOOD_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_008_rec_clip_normalized.laz")
writeLAS(WOOD_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_009_rec_clip_normalized.laz")
writeLAS(WOOD_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_011_rec_clip_normalized.laz")
writeLAS(WOOD_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_012_rec_clip_normalized.laz")
writeLAS(WOOD_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_013_rec_clip_normalized.laz")
writeLAS(WOOD_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_020_rec_clip_normalized.laz")
writeLAS(WOOD_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_029_rec_clip_normalized.laz")
writeLAS(WOOD_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_WOOD/HtNorm_250_radius/WOOD_031_rec_clip_normalized.laz")

# Domain 10:CPER ####################
ctg_CPER <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/DP1.30003.001/neon-aop-products/2017/FullSite/D10/2017_CPER_3/L1/DiscreteLidar/ClassifiedPointCloud")
CPER_004_circ_clip <- clip_circle(ctg_CPER,525365.093,4518223.642,radius=250)
CPER_005_circ_clip <- clip_circle(ctg_CPER,522925.722,4522436.899,radius=250)
CPER_009_circ_clip <- clip_circle(ctg_CPER,521325.472,4519268.106,radius=250)
CPER_011_circ_clip <- clip_circle(ctg_CPER,524874.022,4523966.583,radius=250)
CPER_014_circ_clip <- clip_circle(ctg_CPER,525460.528,4517265.563,radius=250)
CPER_015_circ_clip <- clip_circle(ctg_CPER,521657.225,4522379.091,radius=250)
CPER_016_circ_clip <- clip_circle(ctg_CPER,520520.524,4516871.862,radius=250)
CPER_018_circ_clip <- clip_circle(ctg_CPER,525555.39,4519444.048,radius=250)
CPER_029_circ_clip <- clip_circle(ctg_CPER,519494.58,4519484.118,radius=250)
CPER_036_circ_clip <- clip_circle(ctg_CPER,522715.149,4520631.194,radius=250)
CPER_042_circ_clip <- clip_circle(ctg_CPER,523757.3283,4523486.719,radius=250)
CPER_043_circ_clip <- clip_circle(ctg_CPER,522719.4328,4523985.207,radius=250)
CPER_044_circ_clip <- clip_circle(ctg_CPER,519815.8447,4517608.906,radius=250)
CPER_075_circ_clip <- clip_circle(ctg_CPER,522430.8701,4521577.229,radius=250)
CPER_076_circ_clip <- clip_circle(ctg_CPER,524782.7863,4520733.872,radius=250)
#
hist(CPER_004_circ_clip@data$Z, breaks=100)
hist(CPER_005_circ_clip@data$Z, breaks=100)
hist(CPER_009_circ_clip@data$Z, breaks=100)
hist(CPER_011_circ_clip@data$Z, breaks=100)
hist(CPER_014_circ_clip@data$Z, breaks=100)
hist(CPER_015_circ_clip@data$Z, breaks=100)
hist(CPER_016_circ_clip@data$Z, breaks=100)
hist(CPER_018_circ_clip@data$Z, breaks=100)
hist(CPER_029_circ_clip@data$Z, breaks=100)
hist(CPER_036_circ_clip@data$Z, breaks=100)
hist(CPER_042_circ_clip@data$Z, breaks=100)
hist(CPER_043_circ_clip@data$Z, breaks=100)
hist(CPER_044_circ_clip@data$Z, breaks=100)
hist(CPER_075_circ_clip@data$Z, breaks=100)
hist(CPER_076_circ_clip@data$Z, breaks=100)
CPER_004_circ_clip <- filter_poi(CPER_004_circ_clip, Z >= 100, Z<= 600)
CPER_005_circ_clip <- filter_poi(CPER_005_circ_clip, Z >= 100, Z<= 600)
CPER_009_circ_clip <- filter_poi(CPER_009_circ_clip, Z >= 100, Z<= 600)
CPER_011_circ_clip <- filter_poi(CPER_011_circ_clip, Z >= 100, Z<= 600)
CPER_014_circ_clip <- filter_poi(CPER_014_circ_clip, Z >= 100, Z<= 600)
CPER_015_circ_clip <- filter_poi(CPER_015_circ_clip, Z >= 1600, Z<= 1800)
CPER_016_circ_clip <- filter_poi(CPER_016_circ_clip, Z >= 100, Z<= 600)
CPER_018_circ_clip <- filter_poi(CPER_018_circ_clip, Z >= 1500, Z<= 1800)
CPER_029_circ_clip <- filter_poi(CPER_029_circ_clip, Z >= 100, Z<= 600)
CPER_036_circ_clip <- filter_poi(CPER_036_circ_clip, Z >= 100, Z<= 600)
CPER_042_circ_clip <- filter_poi(CPER_042_circ_clip, Z >= 100, Z<= 1800)
CPER_043_circ_clip <- filter_poi(CPER_043_circ_clip, Z >= 100, Z<= 600)
CPER_044_circ_clip <- filter_poi(CPER_044_circ_clip, Z >= 100, Z<= 600)
CPER_075_circ_clip <- filter_poi(CPER_075_circ_clip, Z >= 100, Z<= 600)
CPER_076_circ_clip <- filter_poi(CPER_076_circ_clip, Z >= 100, Z<= 600)
#
CPER_004_circ_clip_dtm_idw <- grid_terrain(CPER_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_005_circ_clip_dtm_idw <- grid_terrain(CPER_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_009_circ_clip_dtm_idw <- grid_terrain(CPER_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_011_circ_clip_dtm_idw <- grid_terrain(CPER_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_014_circ_clip_dtm_idw <- grid_terrain(CPER_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_015_circ_clip_dtm_idw <- grid_terrain(CPER_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_016_circ_clip_dtm_idw <- grid_terrain(CPER_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_018_circ_clip_dtm_idw <- grid_terrain(CPER_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_029_circ_clip_dtm_idw <- grid_terrain(CPER_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_036_circ_clip_dtm_idw <- grid_terrain(CPER_036_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_042_circ_clip_dtm_idw <- grid_terrain(CPER_042_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_043_circ_clip_dtm_idw <- grid_terrain(CPER_043_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_044_circ_clip_dtm_idw <- grid_terrain(CPER_044_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_075_circ_clip_dtm_idw <- grid_terrain(CPER_075_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CPER_076_circ_clip_dtm_idw <- grid_terrain(CPER_076_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
CPER_004_rec_clip_normalized <- filter_poi(normalize_height(CPER_004_circ_clip,CPER_004_circ_clip_dtm_idw),Z >= 0)
CPER_005_rec_clip_normalized <- filter_poi(normalize_height(CPER_005_circ_clip,CPER_005_circ_clip_dtm_idw),Z >= 0)
CPER_009_rec_clip_normalized <- filter_poi(normalize_height(CPER_009_circ_clip,CPER_009_circ_clip_dtm_idw),Z >= 0)
CPER_011_rec_clip_normalized <- filter_poi(normalize_height(CPER_011_circ_clip,CPER_011_circ_clip_dtm_idw),Z >= 0)
CPER_014_rec_clip_normalized <- filter_poi(normalize_height(CPER_014_circ_clip,CPER_014_circ_clip_dtm_idw),Z >= 0)
CPER_015_rec_clip_normalized <- filter_poi(normalize_height(CPER_015_circ_clip,CPER_015_circ_clip_dtm_idw),Z >= 0)
CPER_016_rec_clip_normalized <- filter_poi(normalize_height(CPER_016_circ_clip,CPER_016_circ_clip_dtm_idw),Z >= 0)
CPER_018_rec_clip_normalized <- filter_poi(normalize_height(CPER_018_circ_clip,CPER_018_circ_clip_dtm_idw),Z >= 0)
CPER_029_rec_clip_normalized <- filter_poi(normalize_height(CPER_029_circ_clip,CPER_029_circ_clip_dtm_idw),Z >= 0)
CPER_036_rec_clip_normalized <- filter_poi(normalize_height(CPER_036_circ_clip,CPER_036_circ_clip_dtm_idw),Z >= 0)
CPER_042_rec_clip_normalized <- filter_poi(normalize_height(CPER_042_circ_clip,CPER_042_circ_clip_dtm_idw),Z >= 0)
CPER_043_rec_clip_normalized <- filter_poi(normalize_height(CPER_043_circ_clip,CPER_043_circ_clip_dtm_idw),Z >= 0)
CPER_044_rec_clip_normalized <- filter_poi(normalize_height(CPER_044_circ_clip,CPER_044_circ_clip_dtm_idw),Z >= 0)
CPER_075_rec_clip_normalized <- filter_poi(normalize_height(CPER_075_circ_clip,CPER_075_circ_clip_dtm_idw),Z >= 0)
CPER_076_rec_clip_normalized <- filter_poi(normalize_height(CPER_076_circ_clip,CPER_076_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(CPER_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_004_rec_clip_normalized.laz")
writeLAS(CPER_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_005_rec_clip_normalized.laz")
writeLAS(CPER_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_009_rec_clip_normalized.laz")
writeLAS(CPER_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_011_rec_clip_normalized.laz")
writeLAS(CPER_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_014_rec_clip_normalized.laz")
writeLAS(CPER_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_015_rec_clip_normalized.laz")
writeLAS(CPER_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_016_rec_clip_normalized.laz")
writeLAS(CPER_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_018_rec_clip_normalized.laz")
writeLAS(CPER_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_029_rec_clip_normalized.laz")
writeLAS(CPER_036_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_036_rec_clip_normalized.laz")
writeLAS(CPER_042_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_042_rec_clip_normalized.laz")
writeLAS(CPER_043_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_043_rec_clip_normalized.laz")
writeLAS(CPER_044_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_044_rec_clip_normalized.laz")
writeLAS(CPER_075_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_075_rec_clip_normalized.laz")
writeLAS(CPER_076_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_CPER/HtNorm_250_radius/CPER_076_rec_clip_normalized.laz")

# Domain 11:CLBJ ####################
ctg_CLBJ <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/DP1.30003.001/neon-aop-products/2017/FullSite/D11/2017_CLBJ_2/L1/DiscreteLidar/ClassifiedPointCloud")
CLBJ_031_circ_clip <- clip_circle(ctg_CLBJ,630686.155,3693718.345,radius=250)
CLBJ_034_circ_clip <- clip_circle(ctg_CLBJ,632197.105,3688031.527,radius=250)
CLBJ_036_circ_clip <- clip_circle(ctg_CLBJ,631962.527,3696050.468,radius=250)
CLBJ_038_circ_clip <- clip_circle(ctg_CLBJ,630509.398,3697894.778,radius=250)
CLBJ_061_circ_clip <- clip_circle(ctg_CLBJ,625714.562,3696677.699,radius=250)
CLBJ_062_circ_clip <- clip_circle(ctg_CLBJ,629845.37,3695064.881,radius=250)
CLBJ_063_circ_clip <- clip_circle(ctg_CLBJ,630757.525,3690839.845,radius=250)
CLBJ_064_circ_clip <- clip_circle(ctg_CLBJ,626781.325,3697660.371,radius=250)
CLBJ_065_circ_clip <- clip_circle(ctg_CLBJ,630088.137,3697066.075,radius=250)
#
hist(CLBJ_031_circ_clip@data$Z, breaks=100)
hist(CLBJ_034_circ_clip@data$Z, breaks=100)
hist(CLBJ_036_circ_clip@data$Z, breaks=100)
hist(CLBJ_038_circ_clip@data$Z, breaks=100)
hist(CLBJ_061_circ_clip@data$Z, breaks=100)
hist(CLBJ_062_circ_clip@data$Z, breaks=100)
hist(CLBJ_063_circ_clip@data$Z, breaks=100)
hist(CLBJ_064_circ_clip@data$Z, breaks=100)
hist(CLBJ_065_circ_clip@data$Z, breaks=100)
CLBJ_031_circ_clip <- filter_poi(CLBJ_031_circ_clip, Z >= 250, Z<= 600)
CLBJ_034_circ_clip <- filter_poi(CLBJ_034_circ_clip, Z >= 100, Z<= 600)
CLBJ_036_circ_clip <- filter_poi(CLBJ_036_circ_clip, Z >= 100, Z<= 350)
CLBJ_038_circ_clip <- filter_poi(CLBJ_038_circ_clip, Z >= 200, Z<= 310)
CLBJ_061_circ_clip <- filter_poi(CLBJ_061_circ_clip, Z >= 200, Z<= 320)
CLBJ_062_circ_clip <- filter_poi(CLBJ_062_circ_clip, Z >= 260, Z<= 320)
CLBJ_063_circ_clip <- filter_poi(CLBJ_063_circ_clip, Z >= 290, Z<= 400)
CLBJ_064_circ_clip <- filter_poi(CLBJ_064_circ_clip, Z >= 200, Z<= 330)
CLBJ_065_circ_clip <- filter_poi(CLBJ_065_circ_clip, Z >= 200, Z<= 400)
#
CLBJ_031_circ_clip_dtm_idw <- grid_terrain(CLBJ_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_034_circ_clip_dtm_idw <- grid_terrain(CLBJ_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_036_circ_clip_dtm_idw <- grid_terrain(CLBJ_036_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_038_circ_clip_dtm_idw <- grid_terrain(CLBJ_038_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_061_circ_clip_dtm_idw <- grid_terrain(CLBJ_061_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_062_circ_clip_dtm_idw <- grid_terrain(CLBJ_062_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_063_circ_clip_dtm_idw <- grid_terrain(CLBJ_063_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_064_circ_clip_dtm_idw <- grid_terrain(CLBJ_064_circ_clip, algorithm = knnidw(k = 10L, p = 2))
CLBJ_065_circ_clip_dtm_idw <- grid_terrain(CLBJ_065_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
CLBJ_031_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_031_circ_clip,CLBJ_031_circ_clip_dtm_idw),Z >= 0)
CLBJ_034_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_034_circ_clip,CLBJ_034_circ_clip_dtm_idw),Z >= 0)
CLBJ_036_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_036_circ_clip,CLBJ_036_circ_clip_dtm_idw),Z >= 0)
CLBJ_038_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_038_circ_clip,CLBJ_038_circ_clip_dtm_idw),Z >= 0)
CLBJ_061_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_061_circ_clip,CLBJ_061_circ_clip_dtm_idw),Z >= 0)
CLBJ_062_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_062_circ_clip,CLBJ_062_circ_clip_dtm_idw),Z >= 0)
CLBJ_063_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_063_circ_clip,CLBJ_063_circ_clip_dtm_idw),Z >= 0)
CLBJ_064_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_064_circ_clip,CLBJ_064_circ_clip_dtm_idw),Z >= 0)
CLBJ_065_rec_clip_normalized <- filter_poi(normalize_height(CLBJ_065_circ_clip,CLBJ_065_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(CLBJ_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_031_rec_clip_normalized.laz")
writeLAS(CLBJ_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_034_rec_clip_normalized.laz")
writeLAS(CLBJ_036_rec_clip_normalized,"/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_036_rec_clip_normalized.laz")
writeLAS(CLBJ_038_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_038_rec_clip_normalized.laz")
writeLAS(CLBJ_061_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_061_rec_clip_normalized.laz")
writeLAS(CLBJ_062_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_062_rec_clip_normalized.laz")
writeLAS(CLBJ_063_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_063_rec_clip_normalized.laz")
writeLAS(CLBJ_064_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_064_rec_clip_normalized.laz")
writeLAS(CLBJ_065_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_CLBJ/HtNorm_250_radius/CLBJ_065_rec_clip_normalized.laz")
# Domain 13:NIWO ####################
ctg_NIWO <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/DP1.30003.001/neon-aop-products/2017/FullSite/D13/2017_NIWO_1/L1/DiscreteLidar/ClassifiedPointCloud")
NIWO_001_circ_clip <- clip_circle(ctg_NIWO,452331.855,4432583.848,radius=250)
NIWO_005_circ_clip <- clip_circle(ctg_NIWO,451401.612,4432739.392,radius=250)
NIWO_011_circ_clip <- clip_circle(ctg_NIWO,452823.666,4431821.76,radius=250)
NIWO_026_circ_clip <- clip_circle(ctg_NIWO,451205.526,4433593.838,radius=250)
NIWO_028_circ_clip <- clip_circle(ctg_NIWO,449598.74,4434249.927,radius=250)
NIWO_031_circ_clip <- clip_circle(ctg_NIWO,453528.918,4432945.358,radius=250)
#
hist(NIWO_001_circ_clip@data$Z, breaks=100)
hist(NIWO_005_circ_clip@data$Z, breaks=100)
hist(NIWO_011_circ_clip@data$Z, breaks=100)
hist(NIWO_026_circ_clip@data$Z, breaks=100)
hist(NIWO_028_circ_clip@data$Z, breaks=100)
hist(NIWO_031_circ_clip@data$Z, breaks=100)
NIWO_001_circ_clip <- filter_poi(NIWO_001_circ_clip, Z >= 100, Z<= 3350)
NIWO_005_circ_clip <- filter_poi(NIWO_005_circ_clip, Z >= 100, Z<= 3400)
NIWO_011_circ_clip <- filter_poi(NIWO_011_circ_clip, Z >= 100, Z<= 3200)
NIWO_026_circ_clip <- filter_poi(NIWO_026_circ_clip, Z >= 3200, Z<= 3600)
NIWO_028_circ_clip <- filter_poi(NIWO_028_circ_clip, Z >= 3200, Z<= 3800)
NIWO_031_circ_clip <- filter_poi(NIWO_031_circ_clip, Z >= 100, Z<= 3300)
#
NIWO_001_circ_clip_dtm_idw <- grid_terrain(NIWO_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NIWO_005_circ_clip_dtm_idw <- grid_terrain(NIWO_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NIWO_011_circ_clip_dtm_idw <- grid_terrain(NIWO_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NIWO_026_circ_clip_dtm_idw <- grid_terrain(NIWO_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NIWO_028_circ_clip_dtm_idw <- grid_terrain(NIWO_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NIWO_031_circ_clip_dtm_idw <- grid_terrain(NIWO_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
NIWO_001_rec_clip_normalized <- filter_poi(normalize_height(NIWO_001_circ_clip,NIWO_001_circ_clip_dtm_idw),Z >= 0)
NIWO_005_rec_clip_normalized <- filter_poi(normalize_height(NIWO_005_circ_clip,NIWO_005_circ_clip_dtm_idw),Z >= 0)
NIWO_011_rec_clip_normalized <- filter_poi(normalize_height(NIWO_011_circ_clip,NIWO_011_circ_clip_dtm_idw),Z >= 0)
NIWO_026_rec_clip_normalized <- filter_poi(normalize_height(NIWO_026_circ_clip,NIWO_026_circ_clip_dtm_idw),Z >= 0)
NIWO_028_rec_clip_normalized <- filter_poi(normalize_height(NIWO_028_circ_clip,NIWO_028_circ_clip_dtm_idw),Z >= 0)
NIWO_031_rec_clip_normalized <- filter_poi(normalize_height(NIWO_031_circ_clip,NIWO_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(NIWO_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_001_rec_clip_normalized.laz")
writeLAS(NIWO_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_005_rec_clip_normalized.laz")
writeLAS(NIWO_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_011_rec_clip_normalized.laz")
writeLAS(NIWO_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_026_rec_clip_normalized.laz")
writeLAS(NIWO_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_028_rec_clip_normalized.laz")
writeLAS(NIWO_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_NIWO/HtNorm_250_radius/NIWO_031_rec_clip_normalized.laz")

# Domain 14:SRER ####################
ctg_SRER <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/DP1.30003.001/neon-aop-products/2017/FullSite/D14/2017_SRER_1/L1/DiscreteLidar/ClassifiedPointCloud")
SRER_001_circ_clip <- clip_circle(ctg_SRER,517126.652,3525141.747,radius=250)
SRER_002_circ_clip <- clip_circle(ctg_SRER,513485.241,3526046.042,radius=250)
SRER_003_circ_clip <- clip_circle(ctg_SRER,507828.14,3522739.655,radius=250)
SRER_004_circ_clip <- clip_circle(ctg_SRER,517462.026,3530091.841,radius=250)
SRER_005_circ_clip <- clip_circle(ctg_SRER,516510.348,3521697.139,radius=250)
SRER_007_circ_clip <- clip_circle(ctg_SRER,511882.204,3529308.613,radius=250)
SRER_009_circ_clip <- clip_circle(ctg_SRER,515631.379,3523189.477,radius=250)
SRER_010_circ_clip <- clip_circle(ctg_SRER,508560.656,3518298.624,radius=250)
SRER_015_circ_clip <- clip_circle(ctg_SRER,518487.867,3517616.223,radius=250)
SRER_018_circ_clip <- clip_circle(ctg_SRER,508668.8021,3529092.951,radius=250)
SRER_020_circ_clip <- clip_circle(ctg_SRER,511700.9289,3515251.07,radius=250)
SRER_031_circ_clip <- clip_circle(ctg_SRER,517907.52,3528806.03,radius=250)
#
hist(SRER_001_circ_clip@data$Z, breaks=100)
hist(SRER_002_circ_clip@data$Z, breaks=100)
hist(SRER_003_circ_clip@data$Z, breaks=100)
hist(SRER_004_circ_clip@data$Z, breaks=100)
hist(SRER_005_circ_clip@data$Z, breaks=100)
hist(SRER_007_circ_clip@data$Z, breaks=100)
hist(SRER_009_circ_clip@data$Z, breaks=100)
hist(SRER_010_circ_clip@data$Z, breaks=100)
hist(SRER_015_circ_clip@data$Z, breaks=100)
hist(SRER_018_circ_clip@data$Z, breaks=100)
hist(SRER_020_circ_clip@data$Z, breaks=100)
hist(SRER_031_circ_clip@data$Z, breaks=100)
SRER_001_circ_clip <- filter_poi(SRER_001_circ_clip, Z >= 100, Z<= 1200)
SRER_002_circ_clip <- filter_poi(SRER_002_circ_clip, Z >= 900, Z<= 1050)
SRER_003_circ_clip <- filter_poi(SRER_003_circ_clip, Z >= 800, Z<= 990)
SRER_004_circ_clip <- filter_poi(SRER_004_circ_clip, Z >= 100, Z<= 1100)
SRER_005_circ_clip <- filter_poi(SRER_005_circ_clip, Z >= 100, Z<= 1350)
SRER_007_circ_clip <- filter_poi(SRER_007_circ_clip, Z >= 100, Z<= 1100)
SRER_009_circ_clip <- filter_poi(SRER_009_circ_clip, Z >= 100, Z<= 1300)
SRER_010_circ_clip <- filter_poi(SRER_010_circ_clip, Z >= 100, Z<= 1150)
SRER_015_circ_clip <- filter_poi(SRER_015_circ_clip, Z >= 100, Z<= 1600)
SRER_018_circ_clip <- filter_poi(SRER_018_circ_clip, Z >= 100, Z<= 1100)
SRER_020_circ_clip <- filter_poi(SRER_020_circ_clip, Z >= 1100, Z<= 1500)
SRER_031_circ_clip <- filter_poi(SRER_031_circ_clip, Z >= 100, Z<= 1300)
#
SRER_001_circ_clip_dtm_idw <- grid_terrain(SRER_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_002_circ_clip_dtm_idw <- grid_terrain(SRER_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_003_circ_clip_dtm_idw <- grid_terrain(SRER_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_004_circ_clip_dtm_idw <- grid_terrain(SRER_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_005_circ_clip_dtm_idw <- grid_terrain(SRER_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_007_circ_clip_dtm_idw <- grid_terrain(SRER_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_009_circ_clip_dtm_idw <- grid_terrain(SRER_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_010_circ_clip_dtm_idw <- grid_terrain(SRER_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_015_circ_clip_dtm_idw <- grid_terrain(SRER_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_018_circ_clip_dtm_idw <- grid_terrain(SRER_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_020_circ_clip_dtm_idw <- grid_terrain(SRER_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SRER_031_circ_clip_dtm_idw <- grid_terrain(SRER_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
SRER_001_rec_clip_normalized <- filter_poi(normalize_height(SRER_001_circ_clip,SRER_001_circ_clip_dtm_idw),Z >= 0)
SRER_002_rec_clip_normalized <- filter_poi(normalize_height(SRER_002_circ_clip,SRER_002_circ_clip_dtm_idw),Z >= 0)
SRER_003_rec_clip_normalized <- filter_poi(normalize_height(SRER_003_circ_clip,SRER_003_circ_clip_dtm_idw),Z >= 0)
SRER_004_rec_clip_normalized <- filter_poi(normalize_height(SRER_004_circ_clip,SRER_004_circ_clip_dtm_idw),Z >= 0)
SRER_005_rec_clip_normalized <- filter_poi(normalize_height(SRER_005_circ_clip,SRER_005_circ_clip_dtm_idw),Z >= 0)
SRER_007_rec_clip_normalized <- filter_poi(normalize_height(SRER_007_circ_clip,SRER_007_circ_clip_dtm_idw),Z >= 0)
SRER_009_rec_clip_normalized <- filter_poi(normalize_height(SRER_009_circ_clip,SRER_009_circ_clip_dtm_idw),Z >= 0)
SRER_010_rec_clip_normalized <- filter_poi(normalize_height(SRER_010_circ_clip,SRER_010_circ_clip_dtm_idw),Z >= 0)
SRER_015_rec_clip_normalized <- filter_poi(normalize_height(SRER_015_circ_clip,SRER_015_circ_clip_dtm_idw),Z >= 0)
SRER_018_rec_clip_normalized <- filter_poi(normalize_height(SRER_018_circ_clip,SRER_018_circ_clip_dtm_idw),Z >= 0)
SRER_020_rec_clip_normalized <- filter_poi(normalize_height(SRER_020_circ_clip,SRER_020_circ_clip_dtm_idw),Z >= 0)
SRER_031_rec_clip_normalized <- filter_poi(normalize_height(SRER_031_circ_clip,SRER_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(SRER_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_001_rec_clip_normalized.laz")
writeLAS(SRER_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_002_rec_clip_normalized.laz")
writeLAS(SRER_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_003_rec_clip_normalized.laz")
writeLAS(SRER_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_004_rec_clip_normalized.laz")
writeLAS(SRER_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_005_rec_clip_normalized.laz")
writeLAS(SRER_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_007_rec_clip_normalized.laz")
writeLAS(SRER_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_009_rec_clip_normalized.laz")
writeLAS(SRER_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_010_rec_clip_normalized.laz")
writeLAS(SRER_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_015_rec_clip_normalized.laz")
writeLAS(SRER_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_018_rec_clip_normalized.laz")
writeLAS(SRER_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_020_rec_clip_normalized.laz")
writeLAS(SRER_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_SRER/HtNorm_250_radius/SRER_031_rec_clip_normalized.laz")

# Domain 15:ONAQ ####################
ctg_ONAQ <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/DP1.30003.001/neon-aop-products/2017/FullSite/D15/2017_ONAQ_1/L1/DiscreteLidar/ClassifiedPointCloud")
ONAQ_004_circ_clip <- clip_circle(ctg_ONAQ,374652.741,4449404.241,radius=250)
ONAQ_005_circ_clip <- clip_circle(ctg_ONAQ,378105.509,4448785.969,radius=250)
ONAQ_016_circ_clip <- clip_circle(ctg_ONAQ,376876.948,4448190.928,radius=250)
ONAQ_019_circ_clip <- clip_circle(ctg_ONAQ,373778.715,4448288.866,radius=250)
ONAQ_030_circ_clip <- clip_circle(ctg_ONAQ,371169.376,4451206.599,radius=250)
ONAQ_073_circ_clip <- clip_circle(ctg_ONAQ,371227.392,4448938.029,radius=250)
#
hist(ONAQ_004_circ_clip@data$Z, breaks=100)
hist(ONAQ_005_circ_clip@data$Z, breaks=100)
hist(ONAQ_016_circ_clip@data$Z, breaks=100)
hist(ONAQ_019_circ_clip@data$Z, breaks=100)
hist(ONAQ_030_circ_clip@data$Z, breaks=100)
hist(ONAQ_073_circ_clip@data$Z, breaks=100)
ONAQ_004_circ_clip <- filter_poi(ONAQ_004_circ_clip, Z >= 100, Z<= 1800)
ONAQ_005_circ_clip <- filter_poi(ONAQ_005_circ_clip, Z >= 1500, Z<= 1650)
ONAQ_016_circ_clip <- filter_poi(ONAQ_016_circ_clip, Z >= 100, Z<= 1750)
ONAQ_019_circ_clip <- filter_poi(ONAQ_019_circ_clip, Z >= 100, Z<= 1890)
ONAQ_030_circ_clip <- filter_poi(ONAQ_030_circ_clip, Z >= 1750, Z<= 2200)
ONAQ_073_circ_clip <- filter_poi(ONAQ_073_circ_clip, Z >= 1600, Z<= 2100)
#
ONAQ_004_circ_clip_dtm_idw <- grid_terrain(ONAQ_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ONAQ_005_circ_clip_dtm_idw <- grid_terrain(ONAQ_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ONAQ_016_circ_clip_dtm_idw <- grid_terrain(ONAQ_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ONAQ_019_circ_clip_dtm_idw <- grid_terrain(ONAQ_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ONAQ_030_circ_clip_dtm_idw <- grid_terrain(ONAQ_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ONAQ_073_circ_clip_dtm_idw <- grid_terrain(ONAQ_073_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
ONAQ_004_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_004_circ_clip,ONAQ_004_circ_clip_dtm_idw),Z >= 0)
ONAQ_005_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_005_circ_clip,ONAQ_005_circ_clip_dtm_idw),Z >= 0)
ONAQ_016_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_016_circ_clip,ONAQ_016_circ_clip_dtm_idw),Z >= 0)
ONAQ_019_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_019_circ_clip,ONAQ_019_circ_clip_dtm_idw),Z >= 0)
ONAQ_030_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_030_circ_clip,ONAQ_030_circ_clip_dtm_idw),Z >= 0)
ONAQ_073_rec_clip_normalized <- filter_poi(normalize_height(ONAQ_073_circ_clip,ONAQ_073_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(ONAQ_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_004_rec_clip_normalized.laz")
writeLAS(ONAQ_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_005_rec_clip_normalized.laz")
writeLAS(ONAQ_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_016_rec_clip_normalized.laz")
writeLAS(ONAQ_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_019_rec_clip_normalized.laz")
writeLAS(ONAQ_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_030_rec_clip_normalized.laz")
writeLAS(ONAQ_073_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D15_ONAQ/HtNorm_250_radius/ONAQ_073_rec_clip_normalized.laz")

# Domain 17:SJER ####################
ctg_SJER <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/DP1.30003.001/neon-aop-products/2017/FullSite/D17/2017_SJER_2/L1/DiscreteLidar/ClassifiedPointCloud")
SJER_002_circ_clip <- clip_circle(ctg_SJER,256174.709,4107560.465,radius=250)
SJER_006_circ_clip <- clip_circle(ctg_SJER,255657.159,4109906.603,radius=250)
SJER_007_circ_clip <- clip_circle(ctg_SJER,255309.797,4111223.368,radius=250)
SJER_008_circ_clip <- clip_circle(ctg_SJER,258627.721,4110083.671,radius=250)
SJER_031_circ_clip <- clip_circle(ctg_SJER,254829.621,4110353.695,radius=250)
SJER_032_circ_clip <- clip_circle(ctg_SJER,256238.121,4108734.755,radius=250)
SJER_033_circ_clip <- clip_circle(ctg_SJER,258612.452,4107124.736,radius=250)
SJER_034_circ_clip <- clip_circle(ctg_SJER,257654.681,4108944.486,radius=250)
SJER_010_circ_clip <- clip_circle(ctg_SJER,255931.5365,4112494.092,radius=250)
SJER_013_circ_clip <- clip_circle(ctg_SJER,257483.4239,4107590.566,radius=250)
#
hist(SJER_002_circ_clip@data$Z, breaks=100)
hist(SJER_006_circ_clip@data$Z, breaks=100)
hist(SJER_007_circ_clip@data$Z, breaks=100)
hist(SJER_008_circ_clip@data$Z, breaks=100)
hist(SJER_031_circ_clip@data$Z, breaks=100)
hist(SJER_032_circ_clip@data$Z, breaks=100)
hist(SJER_033_circ_clip@data$Z, breaks=100)
hist(SJER_034_circ_clip@data$Z, breaks=100)
hist(SJER_010_circ_clip@data$Z, breaks=100)
hist(SJER_013_circ_clip@data$Z, breaks=100)
SJER_002_circ_clip <- filter_poi(SJER_002_circ_clip, Z >= 200, Z<= 380)
SJER_006_circ_clip <- filter_poi(SJER_006_circ_clip, Z >= 200, Z<= 550)
SJER_007_circ_clip <- filter_poi(SJER_007_circ_clip, Z >= 350, Z<= 600)
SJER_008_circ_clip <- filter_poi(SJER_008_circ_clip, Z >= 200, Z<= 600)
SJER_031_circ_clip <- filter_poi(SJER_031_circ_clip, Z >= 200, Z<= 600)
SJER_032_circ_clip <- filter_poi(SJER_032_circ_clip, Z >= 150, Z<= 380)
SJER_033_circ_clip <- filter_poi(SJER_033_circ_clip, Z >= 150, Z<= 500)
SJER_034_circ_clip <- filter_poi(SJER_034_circ_clip, Z >= 200, Z<= 600)
SJER_010_circ_clip <- filter_poi(SJER_010_circ_clip, Z >= 200, Z<= 700)
SJER_013_circ_clip <- filter_poi(SJER_013_circ_clip, Z >= 200, Z<= 500)
#
SJER_002_circ_clip_dtm_idw <- grid_terrain(SJER_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_006_circ_clip_dtm_idw <- grid_terrain(SJER_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_007_circ_clip_dtm_idw <- grid_terrain(SJER_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_008_circ_clip_dtm_idw <- grid_terrain(SJER_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_031_circ_clip_dtm_idw <- grid_terrain(SJER_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_032_circ_clip_dtm_idw <- grid_terrain(SJER_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_033_circ_clip_dtm_idw <- grid_terrain(SJER_033_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_034_circ_clip_dtm_idw <- grid_terrain(SJER_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_010_circ_clip_dtm_idw <- grid_terrain(SJER_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SJER_013_circ_clip_dtm_idw <- grid_terrain(SJER_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
SJER_002_rec_clip_normalized <- filter_poi(normalize_height(SJER_002_circ_clip,SJER_002_circ_clip_dtm_idw),Z >= 0)
SJER_006_rec_clip_normalized <- filter_poi(normalize_height(SJER_006_circ_clip,SJER_006_circ_clip_dtm_idw),Z >= 0)
SJER_007_rec_clip_normalized <- filter_poi(normalize_height(SJER_007_circ_clip,SJER_007_circ_clip_dtm_idw),Z >= 0)
SJER_008_rec_clip_normalized <- filter_poi(normalize_height(SJER_008_circ_clip,SJER_008_circ_clip_dtm_idw),Z >= 0)
SJER_031_rec_clip_normalized <- filter_poi(normalize_height(SJER_031_circ_clip,SJER_031_circ_clip_dtm_idw),Z >= 0)
SJER_032_rec_clip_normalized <- filter_poi(normalize_height(SJER_032_circ_clip,SJER_032_circ_clip_dtm_idw),Z >= 0)
SJER_033_rec_clip_normalized <- filter_poi(normalize_height(SJER_033_circ_clip,SJER_033_circ_clip_dtm_idw),Z >= 0)
SJER_034_rec_clip_normalized <- filter_poi(normalize_height(SJER_034_circ_clip,SJER_034_circ_clip_dtm_idw),Z >= 0)
SJER_010_rec_clip_normalized <- filter_poi(normalize_height(SJER_010_circ_clip,SJER_010_circ_clip_dtm_idw),Z >= 0)
SJER_013_rec_clip_normalized <- filter_poi(normalize_height(SJER_013_circ_clip,SJER_013_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(SJER_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_002_rec_clip_normalized.laz")
writeLAS(SJER_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_006_rec_clip_normalized.laz")
writeLAS(SJER_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_007_rec_clip_normalized.laz")
writeLAS(SJER_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_008_rec_clip_normalized.laz")
writeLAS(SJER_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_031_rec_clip_normalized.laz")
writeLAS(SJER_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_032_rec_clip_normalized.laz")
writeLAS(SJER_033_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_033_rec_clip_normalized.laz")
writeLAS(SJER_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_034_rec_clip_normalized.laz")
writeLAS(SJER_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_010_rec_clip_normalized.laz")
writeLAS(SJER_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SJER/HtNorm_250_radius/SJER_013_rec_clip_normalized.laz")

# Domain 18:TOOL #################### - point
ctg_TOOL <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/DP1.30003.001/neon-aop-products/2017/FullSite/D18/2017_TOOL_1/L1/DiscreteLidar/ClassifiedPointCloud")
TOOL_001_circ_clip <- clip_circle(ctg_TOOL,396401.191768706,7610316.36632124,radius=250)
TOOL_002_circ_clip <- clip_circle(ctg_TOOL,404559.353950155,7614697.86415451,radius=250)
TOOL_003_circ_clip <- clip_circle(ctg_TOOL,392619.789992188,7616556.41090308,radius=250)
TOOL_005_circ_clip <- clip_circle(ctg_TOOL,396880.225557042,7607436.32361115,radius=250)
TOOL_006_circ_clip <- clip_circle(ctg_TOOL,407260.447290919,7613947.22625561,radius=250)
TOOL_007_circ_clip <- clip_circle(ctg_TOOL,404259.96370351,7616737.75434446,radius=250)
TOOL_008_circ_clip <- clip_circle(ctg_TOOL,397629.554995168,7607527.17389698,radius=250)
TOOL_009_circ_clip <- clip_circle(ctg_TOOL,405490.050922205,7614605.93507446,radius=250)
TOOL_010_circ_clip <- clip_circle(ctg_TOOL,396220.618555213,7611277.65374597,radius=250)
TOOL_011_circ_clip <- clip_circle(ctg_TOOL,394630.601014217,7614876.94652775,radius=250)
TOOL_012_circ_clip <- clip_circle(ctg_TOOL,395499.758320656,7609296.73729971,radius=250)
TOOL_013_circ_clip <- clip_circle(ctg_TOOL,405010.08077753,7613257.56484887,radius=250)
TOOL_014_circ_clip <- clip_circle(ctg_TOOL,396460.731172135,7614274.91692087,radius=250)
TOOL_016_circ_clip <- clip_circle(ctg_TOOL,392710.112481994,7614217.37031395,radius=250)
TOOL_017_circ_clip <- clip_circle(ctg_TOOL,398561.186907092,7612386.86367417,radius=250)
TOOL_018_circ_clip <- clip_circle(ctg_TOOL,395290.520764311,7615297.45660936,radius=250)
TOOL_019_circ_clip <- clip_circle(ctg_TOOL,403930.804300703,7615115.19470286,radius=250)
TOOL_020_circ_clip <- clip_circle(ctg_TOOL,392170.719689561,7616076.25666658,radius=250)
TOOL_021_circ_clip <- clip_circle(ctg_TOOL,397000.045761377,7608187.42835414,radius=250)
TOOL_022_circ_clip <- clip_circle(ctg_TOOL,404230.206034126,7615717.13891662,radius=250)
TOOL_024_circ_clip <- clip_circle(ctg_TOOL,395920.015845001,7608637.71957707,radius=250)
TOOL_026_circ_clip <- clip_circle(ctg_TOOL,393160.449453847,7613735.10550658,radius=250)
TOOL_027_circ_clip <- clip_circle(ctg_TOOL,396461.21659697,7614996.56528908,radius=250)
TOOL_028_circ_clip <- clip_circle(ctg_TOOL,398260.066952721,7607797.72222374,radius=250)
TOOL_071_circ_clip <- clip_circle(ctg_TOOL,397810.282327767,7611846.54145415,radius=250)
#
hist(TOOL_001_circ_clip@data$Z, breaks=100)
hist(TOOL_002_circ_clip@data$Z, breaks=100)
hist(TOOL_003_circ_clip@data$Z, breaks=100)
hist(TOOL_005_circ_clip@data$Z, breaks=100)
hist(TOOL_006_circ_clip@data$Z, breaks=100)
hist(TOOL_007_circ_clip@data$Z, breaks=100)
hist(TOOL_008_circ_clip@data$Z, breaks=100)
hist(TOOL_009_circ_clip@data$Z, breaks=100)
hist(TOOL_010_circ_clip@data$Z, breaks=100)
hist(TOOL_011_circ_clip@data$Z, breaks=100)
hist(TOOL_012_circ_clip@data$Z, breaks=100)
hist(TOOL_013_circ_clip@data$Z, breaks=100)
hist(TOOL_014_circ_clip@data$Z, breaks=100)
hist(TOOL_016_circ_clip@data$Z, breaks=100)
hist(TOOL_017_circ_clip@data$Z, breaks=100)
hist(TOOL_018_circ_clip@data$Z, breaks=100)
hist(TOOL_019_circ_clip@data$Z, breaks=100)
hist(TOOL_020_circ_clip@data$Z, breaks=100)
hist(TOOL_021_circ_clip@data$Z, breaks=100)
hist(TOOL_022_circ_clip@data$Z, breaks=100)
hist(TOOL_024_circ_clip@data$Z, breaks=100)
hist(TOOL_026_circ_clip@data$Z, breaks=100)
hist(TOOL_027_circ_clip@data$Z, breaks=100)
hist(TOOL_028_circ_clip@data$Z, breaks=100)
hist(TOOL_071_circ_clip@data$Z, breaks=100)
TOOL_001_circ_clip <- filter_poi(TOOL_001_circ_clip, Z >= 100, Z<= 600)
TOOL_002_circ_clip <- filter_poi(TOOL_002_circ_clip, Z >= 100, Z<= 1000)
TOOL_003_circ_clip <- filter_poi(TOOL_003_circ_clip, Z >= 100, Z<= 600)
TOOL_005_circ_clip <- filter_poi(TOOL_005_circ_clip, Z >= 100, Z<= 600)
TOOL_006_circ_clip <- filter_poi(TOOL_006_circ_clip, Z >= 100, Z<= 600)
TOOL_007_circ_clip <- filter_poi(TOOL_007_circ_clip, Z >= 100, Z<= 600)
TOOL_008_circ_clip <- filter_poi(TOOL_008_circ_clip, Z >= 100, Z<= 600)
TOOL_009_circ_clip <- filter_poi(TOOL_009_circ_clip, Z >= 100, Z<= 600)
TOOL_010_circ_clip <- filter_poi(TOOL_010_circ_clip, Z >= 100, Z<= 600)
TOOL_011_circ_clip <- filter_poi(TOOL_011_circ_clip, Z >= 100, Z<= 900)
TOOL_012_circ_clip <- filter_poi(TOOL_012_circ_clip, Z >= 100, Z<= 600)
TOOL_013_circ_clip <- filter_poi(TOOL_013_circ_clip, Z >= 100, Z<= 1000)
TOOL_014_circ_clip <- filter_poi(TOOL_014_circ_clip, Z >= 100, Z<= 600)
TOOL_016_circ_clip <- filter_poi(TOOL_016_circ_clip, Z >= 100, Z<= 600)
TOOL_017_circ_clip <- filter_poi(TOOL_017_circ_clip, Z >= 700, Z<= 2000)
TOOL_018_circ_clip <- filter_poi(TOOL_018_circ_clip, Z >= 100, Z<= 1000)
TOOL_019_circ_clip <- filter_poi(TOOL_019_circ_clip, Z >= 100, Z<= 600)
TOOL_020_circ_clip <- filter_poi(TOOL_020_circ_clip, Z >= 100, Z<= 1000)
TOOL_021_circ_clip <- filter_poi(TOOL_021_circ_clip, Z >= 100, Z<= 600)
TOOL_022_circ_clip <- filter_poi(TOOL_022_circ_clip, Z >= 700, Z<= 900)
TOOL_024_circ_clip <- filter_poi(TOOL_024_circ_clip, Z >= 100, Z<= 900)
TOOL_026_circ_clip <- filter_poi(TOOL_026_circ_clip, Z >= 100, Z<= 600)
TOOL_027_circ_clip <- filter_poi(TOOL_027_circ_clip, Z >= 100, Z<= 600)
TOOL_028_circ_clip <- filter_poi(TOOL_028_circ_clip, Z >= 100, Z<= 600)
TOOL_071_circ_clip <- filter_poi(TOOL_071_circ_clip, Z >= 100, Z<= 600)
#
TOOL_001_circ_clip_dtm_idw <- grid_terrain(TOOL_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_002_circ_clip_dtm_idw <- grid_terrain(TOOL_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_003_circ_clip_dtm_idw <- grid_terrain(TOOL_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_005_circ_clip_dtm_idw <- grid_terrain(TOOL_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_006_circ_clip_dtm_idw <- grid_terrain(TOOL_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_007_circ_clip_dtm_idw <- grid_terrain(TOOL_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_008_circ_clip_dtm_idw <- grid_terrain(TOOL_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_009_circ_clip_dtm_idw <- grid_terrain(TOOL_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_010_circ_clip_dtm_idw <- grid_terrain(TOOL_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_011_circ_clip_dtm_idw <- grid_terrain(TOOL_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_012_circ_clip_dtm_idw <- grid_terrain(TOOL_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_013_circ_clip_dtm_idw <- grid_terrain(TOOL_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_014_circ_clip_dtm_idw <- grid_terrain(TOOL_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_016_circ_clip_dtm_idw <- grid_terrain(TOOL_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_017_circ_clip_dtm_idw <- grid_terrain(TOOL_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_018_circ_clip_dtm_idw <- grid_terrain(TOOL_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_019_circ_clip_dtm_idw <- grid_terrain(TOOL_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_020_circ_clip_dtm_idw <- grid_terrain(TOOL_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_021_circ_clip_dtm_idw <- grid_terrain(TOOL_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_022_circ_clip_dtm_idw <- grid_terrain(TOOL_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_024_circ_clip_dtm_idw <- grid_terrain(TOOL_024_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_026_circ_clip_dtm_idw <- grid_terrain(TOOL_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_027_circ_clip_dtm_idw <- grid_terrain(TOOL_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_028_circ_clip_dtm_idw <- grid_terrain(TOOL_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TOOL_071_circ_clip_dtm_idw <- grid_terrain(TOOL_071_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
TOOL_001_rec_clip_normalized <- filter_poi(normalize_height(TOOL_001_circ_clip,TOOL_001_circ_clip_dtm_idw),Z >= 0)
TOOL_002_rec_clip_normalized <- filter_poi(normalize_height(TOOL_002_circ_clip,TOOL_002_circ_clip_dtm_idw),Z >= 0)
TOOL_003_rec_clip_normalized <- filter_poi(normalize_height(TOOL_003_circ_clip,TOOL_003_circ_clip_dtm_idw),Z >= 0)
TOOL_005_rec_clip_normalized <- filter_poi(normalize_height(TOOL_005_circ_clip,TOOL_005_circ_clip_dtm_idw),Z >= 0)
TOOL_006_rec_clip_normalized <- filter_poi(normalize_height(TOOL_006_circ_clip,TOOL_006_circ_clip_dtm_idw),Z >= 0)
TOOL_007_rec_clip_normalized <- filter_poi(normalize_height(TOOL_007_circ_clip,TOOL_007_circ_clip_dtm_idw),Z >= 0)
TOOL_008_rec_clip_normalized <- filter_poi(normalize_height(TOOL_008_circ_clip,TOOL_008_circ_clip_dtm_idw),Z >= 0)
TOOL_009_rec_clip_normalized <- filter_poi(normalize_height(TOOL_009_circ_clip,TOOL_009_circ_clip_dtm_idw),Z >= 0)
TOOL_010_rec_clip_normalized <- filter_poi(normalize_height(TOOL_010_circ_clip,TOOL_010_circ_clip_dtm_idw),Z >= 0)
TOOL_011_rec_clip_normalized <- filter_poi(normalize_height(TOOL_011_circ_clip,TOOL_011_circ_clip_dtm_idw),Z >= 0)
TOOL_012_rec_clip_normalized <- filter_poi(normalize_height(TOOL_012_circ_clip,TOOL_012_circ_clip_dtm_idw),Z >= 0)
TOOL_013_rec_clip_normalized <- filter_poi(normalize_height(TOOL_013_circ_clip,TOOL_013_circ_clip_dtm_idw),Z >= 0)
TOOL_014_rec_clip_normalized <- filter_poi(normalize_height(TOOL_014_circ_clip,TOOL_014_circ_clip_dtm_idw),Z >= 0)
TOOL_016_rec_clip_normalized <- filter_poi(normalize_height(TOOL_016_circ_clip,TOOL_016_circ_clip_dtm_idw),Z >= 0)
TOOL_017_rec_clip_normalized <- filter_poi(normalize_height(TOOL_017_circ_clip,TOOL_017_circ_clip_dtm_idw),Z >= 0)
TOOL_018_rec_clip_normalized <- filter_poi(normalize_height(TOOL_018_circ_clip,TOOL_018_circ_clip_dtm_idw),Z >= 0)
TOOL_019_rec_clip_normalized <- filter_poi(normalize_height(TOOL_019_circ_clip,TOOL_019_circ_clip_dtm_idw),Z >= 0)
TOOL_020_rec_clip_normalized <- filter_poi(normalize_height(TOOL_020_circ_clip,TOOL_020_circ_clip_dtm_idw),Z >= 0)
TOOL_021_rec_clip_normalized <- filter_poi(normalize_height(TOOL_021_circ_clip,TOOL_021_circ_clip_dtm_idw),Z >= 0)
TOOL_022_rec_clip_normalized <- filter_poi(normalize_height(TOOL_022_circ_clip,TOOL_022_circ_clip_dtm_idw),Z >= 0)
TOOL_024_rec_clip_normalized <- filter_poi(normalize_height(TOOL_024_circ_clip,TOOL_024_circ_clip_dtm_idw),Z >= 0)
TOOL_026_rec_clip_normalized <- filter_poi(normalize_height(TOOL_026_circ_clip,TOOL_026_circ_clip_dtm_idw),Z >= 0)
TOOL_027_rec_clip_normalized <- filter_poi(normalize_height(TOOL_027_circ_clip,TOOL_027_circ_clip_dtm_idw),Z >= 0)
TOOL_028_rec_clip_normalized <- filter_poi(normalize_height(TOOL_028_circ_clip,TOOL_028_circ_clip_dtm_idw),Z >= 0)
TOOL_071_rec_clip_normalized <- filter_poi(normalize_height(TOOL_071_circ_clip,TOOL_071_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(TOOL_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_001_rec_clip_normalized.laz")
writeLAS(TOOL_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_002_rec_clip_normalized.laz")
writeLAS(TOOL_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_003_rec_clip_normalized.laz")
writeLAS(TOOL_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_005_rec_clip_normalized.laz")
writeLAS(TOOL_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_006_rec_clip_normalized.laz")
writeLAS(TOOL_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_007_rec_clip_normalized.laz")
writeLAS(TOOL_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_008_rec_clip_normalized.laz")
writeLAS(TOOL_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_009_rec_clip_normalized.laz")
writeLAS(TOOL_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_010_rec_clip_normalized.laz")
writeLAS(TOOL_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_011_rec_clip_normalized.laz")
writeLAS(TOOL_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_012_rec_clip_normalized.laz")
writeLAS(TOOL_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_013_rec_clip_normalized.laz")
writeLAS(TOOL_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_014_rec_clip_normalized.laz")
writeLAS(TOOL_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_016_rec_clip_normalized.laz")
writeLAS(TOOL_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_017_rec_clip_normalized.laz")
writeLAS(TOOL_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_018_rec_clip_normalized.laz")
writeLAS(TOOL_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_019_rec_clip_normalized.laz")
writeLAS(TOOL_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_020_rec_clip_normalized.laz")
writeLAS(TOOL_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_021_rec_clip_normalized.laz")
writeLAS(TOOL_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_022_rec_clip_normalized.laz")
writeLAS(TOOL_024_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_024_rec_clip_normalized.laz")
writeLAS(TOOL_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_026_rec_clip_normalized.laz")
writeLAS(TOOL_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_027_rec_clip_normalized.laz")
writeLAS(TOOL_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_028_rec_clip_normalized.laz")
writeLAS(TOOL_071_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_TOOL/HtNorm_250_radius/TOOL_071_rec_clip_normalized.laz")

# Domain 19:BONA ####################
ctg_BONA <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/DP1.30003.001/neon-aop-products/2017/FullSite/D19/2017_BONA_1/L1/DiscreteLidar/ClassifiedPointCloud")
BONA_002_circ_clip <- clip_circle(ctg_BONA,475069.01,7226566.302,radius=250)
BONA_003_circ_clip <- clip_circle(ctg_BONA,477401.195,7230780.786,radius=250)
BONA_004_circ_clip <- clip_circle(ctg_BONA,475028.971,7229963.896,radius=250)
BONA_005_circ_clip <- clip_circle(ctg_BONA,472202.504,7226534.919,radius=250)
BONA_006_circ_clip <- clip_circle(ctg_BONA,474703.007,7228201.497,radius=250)
BONA_007_circ_clip <- clip_circle(ctg_BONA,479155.865,7229908.88,radius=250)
BONA_008_circ_clip <- clip_circle(ctg_BONA,473277.306,7225958.881,radius=250)
BONA_012_circ_clip <- clip_circle(ctg_BONA,474511.7365,7225553.835,radius=250)
BONA_013_circ_clip <- clip_circle(ctg_BONA,473801.519,7228247.304,radius=250)
BONA_014_circ_clip <- clip_circle(ctg_BONA,478163.5196,7228144.154,radius=250)
BONA_016_circ_clip <- clip_circle(ctg_BONA,476106.8911,7230797.533,radius=250)
BONA_021_circ_clip <- clip_circle(ctg_BONA,478458.5446,7225276.061,radius=250)
BONA_022_circ_clip <- clip_circle(ctg_BONA,477691.35,7226181.472,radius=250)
BONA_023_circ_clip <- clip_circle(ctg_BONA,476099.626,7226958.894,radius=250)
BONA_032_circ_clip <- clip_circle(ctg_BONA,473933.4841,7229286.398,radius=250)
#
hist(BONA_002_circ_clip@data$Z, breaks=100)
hist(BONA_003_circ_clip@data$Z, breaks=100)
hist(BONA_004_circ_clip@data$Z, breaks=100)
hist(BONA_005_circ_clip@data$Z, breaks=100)
hist(BONA_006_circ_clip@data$Z, breaks=100)
hist(BONA_007_circ_clip@data$Z, breaks=100)
hist(BONA_008_circ_clip@data$Z, breaks=100)
hist(BONA_012_circ_clip@data$Z, breaks=100)
hist(BONA_013_circ_clip@data$Z, breaks=100)
hist(BONA_014_circ_clip@data$Z, breaks=100)
hist(BONA_016_circ_clip@data$Z, breaks=100)
hist(BONA_021_circ_clip@data$Z, breaks=100)
hist(BONA_022_circ_clip@data$Z, breaks=100)
hist(BONA_023_circ_clip@data$Z, breaks=100)
hist(BONA_032_circ_clip@data$Z, breaks=100)
BONA_002_circ_clip <- filter_poi(BONA_002_circ_clip, Z >= 200, Z<= 600)
BONA_003_circ_clip <- filter_poi(BONA_003_circ_clip, Z >= 100, Z<= 900)
BONA_004_circ_clip <- filter_poi(BONA_004_circ_clip, Z >= 100, Z<= 900)
BONA_005_circ_clip <- filter_poi(BONA_005_circ_clip, Z >= 100, Z<= 800)
BONA_006_circ_clip <- filter_poi(BONA_006_circ_clip, Z >= 100, Z<= 600)
BONA_007_circ_clip <- filter_poi(BONA_007_circ_clip, Z >= 100, Z<= 800)
BONA_008_circ_clip <- filter_poi(BONA_008_circ_clip, Z >= 100, Z<= 600)
BONA_012_circ_clip <- filter_poi(BONA_012_circ_clip, Z >= 100, Z<= 600)
BONA_013_circ_clip <- filter_poi(BONA_013_circ_clip, Z >= 100, Z<= 800)
BONA_014_circ_clip <- filter_poi(BONA_014_circ_clip, Z >= 100, Z<= 600)
BONA_016_circ_clip <- filter_poi(BONA_016_circ_clip, Z >= 100, Z<= 600)
BONA_021_circ_clip <- filter_poi(BONA_021_circ_clip, Z >= 100, Z<= 600)
BONA_022_circ_clip <- filter_poi(BONA_022_circ_clip, Z >= 0, Z<= 600)
BONA_023_circ_clip <- filter_poi(BONA_023_circ_clip, Z >= 100, Z<= 600)
BONA_032_circ_clip <- filter_poi(BONA_032_circ_clip, Z >= 100, Z<= 800)
#
BONA_002_circ_clip_dtm_idw <- grid_terrain(BONA_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_003_circ_clip_dtm_idw <- grid_terrain(BONA_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_004_circ_clip_dtm_idw <- grid_terrain(BONA_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_005_circ_clip_dtm_idw <- grid_terrain(BONA_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_006_circ_clip_dtm_idw <- grid_terrain(BONA_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_007_circ_clip_dtm_idw <- grid_terrain(BONA_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_008_circ_clip_dtm_idw <- grid_terrain(BONA_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_012_circ_clip_dtm_idw <- grid_terrain(BONA_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_013_circ_clip_dtm_idw <- grid_terrain(BONA_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_014_circ_clip_dtm_idw <- grid_terrain(BONA_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_016_circ_clip_dtm_idw <- grid_terrain(BONA_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_021_circ_clip_dtm_idw <- grid_terrain(BONA_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_022_circ_clip_dtm_idw <- grid_terrain(BONA_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_023_circ_clip_dtm_idw <- grid_terrain(BONA_023_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BONA_032_circ_clip_dtm_idw <- grid_terrain(BONA_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
BONA_002_rec_clip_normalized <- filter_poi(normalize_height(BONA_002_circ_clip,BONA_002_circ_clip_dtm_idw),Z >= 0)
BONA_003_rec_clip_normalized <- filter_poi(normalize_height(BONA_003_circ_clip,BONA_003_circ_clip_dtm_idw),Z >= 0)
BONA_004_rec_clip_normalized <- filter_poi(normalize_height(BONA_004_circ_clip,BONA_004_circ_clip_dtm_idw),Z >= 0)
BONA_005_rec_clip_normalized <- filter_poi(normalize_height(BONA_005_circ_clip,BONA_005_circ_clip_dtm_idw),Z >= 0)
BONA_006_rec_clip_normalized <- filter_poi(normalize_height(BONA_006_circ_clip,BONA_006_circ_clip_dtm_idw),Z >= 0)
BONA_007_rec_clip_normalized <- filter_poi(normalize_height(BONA_007_circ_clip,BONA_007_circ_clip_dtm_idw),Z >= 0)
BONA_008_rec_clip_normalized <- filter_poi(normalize_height(BONA_008_circ_clip,BONA_008_circ_clip_dtm_idw),Z >= 0)
BONA_012_rec_clip_normalized <- filter_poi(normalize_height(BONA_012_circ_clip,BONA_012_circ_clip_dtm_idw),Z >= 0)
BONA_013_rec_clip_normalized <- filter_poi(normalize_height(BONA_013_circ_clip,BONA_013_circ_clip_dtm_idw),Z >= 0)
BONA_014_rec_clip_normalized <- filter_poi(normalize_height(BONA_014_circ_clip,BONA_014_circ_clip_dtm_idw),Z >= 0)
BONA_016_rec_clip_normalized <- filter_poi(normalize_height(BONA_016_circ_clip,BONA_016_circ_clip_dtm_idw),Z >= 0)
BONA_021_rec_clip_normalized <- filter_poi(normalize_height(BONA_021_circ_clip,BONA_021_circ_clip_dtm_idw),Z >= 0)
BONA_022_rec_clip_normalized <- filter_poi(normalize_height(BONA_022_circ_clip,BONA_022_circ_clip_dtm_idw),Z >= 0)
BONA_023_rec_clip_normalized <- filter_poi(normalize_height(BONA_023_circ_clip,BONA_023_circ_clip_dtm_idw),Z >= 0)
BONA_032_rec_clip_normalized <- filter_poi(normalize_height(BONA_032_circ_clip,BONA_032_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(BONA_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_002_rec_clip_normalized.laz")
writeLAS(BONA_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_003_rec_clip_normalized.laz")
writeLAS(BONA_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_004_rec_clip_normalized.laz")
writeLAS(BONA_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_005_rec_clip_normalized.laz")
writeLAS(BONA_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_006_rec_clip_normalized.laz")
writeLAS(BONA_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_007_rec_clip_normalized.laz")
writeLAS(BONA_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_008_rec_clip_normalized.laz")
writeLAS(BONA_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_012_rec_clip_normalized.laz")
writeLAS(BONA_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_013_rec_clip_normalized.laz")
writeLAS(BONA_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_014_rec_clip_normalized.laz")
writeLAS(BONA_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_016_rec_clip_normalized.laz")
writeLAS(BONA_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_021_rec_clip_normalized.laz")
writeLAS(BONA_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_022_rec_clip_normalized.laz")
writeLAS(BONA_023_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_023_rec_clip_normalized.laz")
writeLAS(BONA_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_BONA/HtNorm_250_radius/BONA_032_rec_clip_normalized.laz")

## Relocatable
# Domain 1: BART ####################
ctg_BART <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/DP1.30003.001/neon-aop-products/2017/FullSite/D01/2017_BART_3/L1/DiscreteLidar/ClassifiedPointCloud")
BART_003_circ_clip <- clip_circle(ctg_BART,318722.024,4880464.938,radius=250)
BART_004_circ_clip <- clip_circle(ctg_BART,316766.575,4878994.04,radius=250)
BART_009_circ_clip <- clip_circle(ctg_BART,315772.997,4880452.321,radius=250)
BART_012_circ_clip <- clip_circle(ctg_BART,314485.917,4879791.145,radius=250)
BART_015_circ_clip <- clip_circle(ctg_BART,317890.948,4879121.169,radius=250)
BART_016_circ_clip <- clip_circle(ctg_BART,316911.089,4879883.269,radius=250)
BART_018_circ_clip <- clip_circle(ctg_BART,317553.751,4881056.445,radius=250)
BART_025_circ_clip <- clip_circle(ctg_BART,314544.455,4881159.906,radius=250)
BART_082_circ_clip <- clip_circle(ctg_BART,316802.13,4880713.958,radius=250)
#
hist(BART_003_circ_clip@data$Z, breaks=100)
hist(BART_004_circ_clip@data$Z, breaks=100)
hist(BART_009_circ_clip@data$Z, breaks=100)
hist(BART_012_circ_clip@data$Z, breaks=100)
hist(BART_015_circ_clip@data$Z, breaks=100)
hist(BART_016_circ_clip@data$Z, breaks=100)
hist(BART_018_circ_clip@data$Z, breaks=100)
hist(BART_025_circ_clip@data$Z, breaks=100)
hist(BART_082_circ_clip@data$Z, breaks=100)
BART_003_circ_clip <- filter_poi(BART_003_circ_clip, Z >= 200, Z<= 600)
BART_004_circ_clip <- filter_poi(BART_004_circ_clip, Z >= 400, Z<= 800)
BART_009_circ_clip <- filter_poi(BART_009_circ_clip, Z >= 200, Z<= 600)
BART_012_circ_clip <- filter_poi(BART_012_circ_clip, Z >= 500, Z<= 750)
BART_015_circ_clip <- filter_poi(BART_015_circ_clip, Z >= 370, Z<= 700)
BART_016_circ_clip <- filter_poi(BART_016_circ_clip, Z >= 0, Z<= 450)
BART_018_circ_clip <- filter_poi(BART_018_circ_clip, Z >= 200, Z<= 400)
BART_025_circ_clip <- filter_poi(BART_025_circ_clip, Z >= 400, Z<= 900)
BART_082_circ_clip <- filter_poi(BART_082_circ_clip, Z >= 200, Z<= 600)
#
BART_003_circ_clip_dtm_idw <- grid_terrain(BART_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_004_circ_clip_dtm_idw <- grid_terrain(BART_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_009_circ_clip_dtm_idw <- grid_terrain(BART_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_012_circ_clip_dtm_idw <- grid_terrain(BART_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_015_circ_clip_dtm_idw <- grid_terrain(BART_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_016_circ_clip_dtm_idw <- grid_terrain(BART_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_018_circ_clip_dtm_idw <- grid_terrain(BART_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_025_circ_clip_dtm_idw <- grid_terrain(BART_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BART_082_circ_clip_dtm_idw <- grid_terrain(BART_082_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
BART_003_rec_clip_normalized <- filter_poi(normalize_height(BART_003_circ_clip,BART_003_circ_clip_dtm_idw),Z >= 0)
BART_004_rec_clip_normalized <- filter_poi(normalize_height(BART_004_circ_clip,BART_004_circ_clip_dtm_idw),Z >= 0)
BART_009_rec_clip_normalized <- filter_poi(normalize_height(BART_009_circ_clip,BART_009_circ_clip_dtm_idw),Z >= 0)
BART_012_rec_clip_normalized <- filter_poi(normalize_height(BART_012_circ_clip,BART_012_circ_clip_dtm_idw),Z >= 0)
BART_015_rec_clip_normalized <- filter_poi(normalize_height(BART_015_circ_clip,BART_015_circ_clip_dtm_idw),Z >= 0)
BART_016_rec_clip_normalized <- filter_poi(normalize_height(BART_016_circ_clip,BART_016_circ_clip_dtm_idw),Z >= 0)
BART_018_rec_clip_normalized <- filter_poi(normalize_height(BART_018_circ_clip,BART_018_circ_clip_dtm_idw),Z >= 0)
BART_025_rec_clip_normalized <- filter_poi(normalize_height(BART_025_circ_clip,BART_025_circ_clip_dtm_idw),Z >= 0)
BART_082_rec_clip_normalized <- filter_poi(normalize_height(BART_082_circ_clip,BART_082_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(BART_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_003_rec_clip_normalized.laz")
writeLAS(BART_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_004_rec_clip_normalized.laz")
writeLAS(BART_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_009_rec_clip_normalized.laz")
writeLAS(BART_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_012_rec_clip_normalized.laz")
writeLAS(BART_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_015_rec_clip_normalized.laz")
writeLAS(BART_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_016_rec_clip_normalized.laz")
writeLAS(BART_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_018_rec_clip_normalized.laz")
writeLAS(BART_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_025_rec_clip_normalized.laz")
writeLAS(BART_082_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D01_BART/HtNorm_250_radius/BART_082_rec_clip_normalized.laz")

# Domain 2: BLAN #################### - point
temp <- read.csv("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/BirdPoints_AllPoints_BLAN.csv")
ctg_BLAN <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/DP1.30003.001/neon-aop-products/2017/FullSite/D02/2017_BLAN_2/L1/DiscreteLidar/ClassifiedPointCloud")
BLAN_001_circ_clip <- clip_circle(ctg_BLAN,763077.750465441,4330938.21840763,radius=250)
BLAN_002_circ_clip <- clip_circle(ctg_BLAN,761126.200920707,4331359.48296001,radius=250)
BLAN_003_circ_clip <- clip_circle(ctg_BLAN,762655.42889054,4329918.69591355,radius=250)
BLAN_004_circ_clip <- clip_circle(ctg_BLAN,762717.809821689,4330881.38243384,radius=250)
BLAN_005_circ_clip <- clip_circle(ctg_BLAN,761907.000364805,4330847.62960983,radius=250)
BLAN_006_circ_clip <- clip_circle(ctg_BLAN,762623.160550937,4330487.37532173,radius=250)
BLAN_007_circ_clip <- clip_circle(ctg_BLAN,762145.891470162,4330636.56668886,radius=250)
BLAN_013_circ_clip <- clip_circle(ctg_BLAN,762264.720739199,4330125.56431204,radius=250)
BLAN_014_circ_clip <- clip_circle(ctg_BLAN,763075.476030658,4330220.13380311,radius=250)
BLAN_015_circ_clip <- clip_circle(ctg_BLAN,763404.942431929,4330907.51342224,radius=250)
BLAN_018_circ_clip <- clip_circle(ctg_BLAN,762745.926495244,4330216.9925856,radius=250)
BLAN_019_circ_clip <- clip_circle(ctg_BLAN,762416.75652363,4330907.54396579,radius=250)
BLAN_020_circ_clip <- clip_circle(ctg_BLAN,761126.035186897,4332319.84190589,radius=250)
#
hist(BLAN_001_circ_clip@data$Z, breaks=100)
BLAN_001_circ_clip <- filter_poi(BLAN_001_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_002_circ_clip@data$Z, breaks=100)
BLAN_002_circ_clip <- filter_poi(BLAN_002_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_003_circ_clip@data$Z, breaks=100)
BLAN_003_circ_clip <- filter_poi(BLAN_003_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_004_circ_clip@data$Z, breaks=100)
BLAN_004_circ_clip <- filter_poi(BLAN_004_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_005_circ_clip@data$Z, breaks=100)
BLAN_005_circ_clip <- filter_poi(BLAN_005_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_006_circ_clip@data$Z, breaks=100)
BLAN_006_circ_clip <- filter_poi(BLAN_006_circ_clip, Z >= 100, Z<= 220)
hist(BLAN_007_circ_clip@data$Z, breaks=100)
BLAN_007_circ_clip <- filter_poi(BLAN_007_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_013_circ_clip@data$Z, breaks=100)
BLAN_013_circ_clip <- filter_poi(BLAN_013_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_014_circ_clip@data$Z, breaks=100)
BLAN_014_circ_clip <- filter_poi(BLAN_014_circ_clip, Z >= 50, Z<= 300)
hist(BLAN_015_circ_clip@data$Z, breaks=100)
BLAN_015_circ_clip <- filter_poi(BLAN_015_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_018_circ_clip@data$Z, breaks=100)
BLAN_018_circ_clip <- filter_poi(BLAN_018_circ_clip, Z >= 0, Z<= 200)
hist(BLAN_019_circ_clip@data$Z, breaks=100)
BLAN_019_circ_clip <- filter_poi(BLAN_019_circ_clip, Z >= 100, Z<= 600)
hist(BLAN_020_circ_clip@data$Z, breaks=100)
BLAN_020_circ_clip <- filter_poi(BLAN_020_circ_clip, Z >= 100, Z<= 200)
#
BLAN_001_circ_clip_dtm_idw <- grid_terrain(BLAN_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_002_circ_clip_dtm_idw <- grid_terrain(BLAN_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_003_circ_clip_dtm_idw <- grid_terrain(BLAN_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_004_circ_clip_dtm_idw <- grid_terrain(BLAN_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_005_circ_clip_dtm_idw <- grid_terrain(BLAN_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_006_circ_clip_dtm_idw <- grid_terrain(BLAN_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_007_circ_clip_dtm_idw <- grid_terrain(BLAN_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_013_circ_clip_dtm_idw <- grid_terrain(BLAN_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_014_circ_clip_dtm_idw <- grid_terrain(BLAN_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_015_circ_clip_dtm_idw <- grid_terrain(BLAN_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_018_circ_clip_dtm_idw <- grid_terrain(BLAN_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_019_circ_clip_dtm_idw <- grid_terrain(BLAN_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BLAN_020_circ_clip_dtm_idw <- grid_terrain(BLAN_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
BLAN_001_rec_clip_normalized <- filter_poi(normalize_height(BLAN_001_circ_clip,BLAN_001_circ_clip_dtm_idw),Z >= 0)
BLAN_002_rec_clip_normalized <- filter_poi(normalize_height(BLAN_002_circ_clip,BLAN_002_circ_clip_dtm_idw),Z >= 0)
BLAN_003_rec_clip_normalized <- filter_poi(normalize_height(BLAN_003_circ_clip,BLAN_003_circ_clip_dtm_idw),Z >= 0)
BLAN_004_rec_clip_normalized <- filter_poi(normalize_height(BLAN_004_circ_clip,BLAN_004_circ_clip_dtm_idw),Z >= 0)
BLAN_005_rec_clip_normalized <- filter_poi(normalize_height(BLAN_005_circ_clip,BLAN_005_circ_clip_dtm_idw),Z >= 0)
BLAN_006_rec_clip_normalized <- filter_poi(normalize_height(BLAN_006_circ_clip,BLAN_006_circ_clip_dtm_idw),Z >= 0)
BLAN_007_rec_clip_normalized <- filter_poi(normalize_height(BLAN_007_circ_clip,BLAN_007_circ_clip_dtm_idw),Z >= 0)
BLAN_013_rec_clip_normalized <- filter_poi(normalize_height(BLAN_013_circ_clip,BLAN_013_circ_clip_dtm_idw),Z >= 0)
BLAN_014_rec_clip_normalized <- filter_poi(normalize_height(BLAN_014_circ_clip,BLAN_014_circ_clip_dtm_idw),Z >= 0)
BLAN_015_rec_clip_normalized <- filter_poi(normalize_height(BLAN_015_circ_clip,BLAN_015_circ_clip_dtm_idw),Z >= 0)
BLAN_018_rec_clip_normalized <- filter_poi(normalize_height(BLAN_018_circ_clip,BLAN_018_circ_clip_dtm_idw),Z >= 0)
BLAN_019_rec_clip_normalized <- filter_poi(normalize_height(BLAN_019_circ_clip,BLAN_019_circ_clip_dtm_idw),Z >= 0)
BLAN_020_rec_clip_normalized <- filter_poi(normalize_height(BLAN_020_circ_clip,BLAN_020_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(BLAN_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_001_rec_clip_normalized.laz")
writeLAS(BLAN_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_002_rec_clip_normalized.laz")
writeLAS(BLAN_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_003_rec_clip_normalized.laz")
writeLAS(BLAN_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_004_rec_clip_normalized.laz")
writeLAS(BLAN_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_005_rec_clip_normalized.laz")
writeLAS(BLAN_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_006_rec_clip_normalized.laz")
writeLAS(BLAN_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_007_rec_clip_normalized.laz")
writeLAS(BLAN_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_013_rec_clip_normalized.laz")
writeLAS(BLAN_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_014_rec_clip_normalized.laz")
writeLAS(BLAN_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_015_rec_clip_normalized.laz")
writeLAS(BLAN_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_018_rec_clip_normalized.laz")
writeLAS(BLAN_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_019_rec_clip_normalized.laz")
writeLAS(BLAN_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_BLAN/HtNorm_250_radius/BLAN_020_rec_clip_normalized.laz")

# Domain 2: SERC #################### - point
ctg_SERC <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/DP1.30003.001/neon-aop-products/2017/FullSite/D02/2017_SERC_2/L1/DiscreteLidar/ClassifiedPointCloud")
SERC_001_circ_clip <- clip_circle(ctg_SERC,366955.678938663,4303322.97300653,radius=250)
SERC_002_circ_clip <- clip_circle(ctg_SERC,364807.859058501,4306283.68579497,radius=250)
SERC_003_circ_clip <- clip_circle(ctg_SERC,366132.146281523,4306798.00900222,radius=250)
SERC_004_circ_clip <- clip_circle(ctg_SERC,365186.759048828,4303765.51235319,radius=250)
SERC_005_circ_clip <- clip_circle(ctg_SERC,365785.624502074,4306068.33073581,radius=250)
SERC_006_circ_clip <- clip_circle(ctg_SERC,365787.898624968,4304718.86057536,radius=250)
SERC_007_circ_clip <- clip_circle(ctg_SERC,366423.599021063,4303898.29716418,radius=250)
SERC_008_circ_clip <- clip_circle(ctg_SERC,367786.316863012,4303658.18127865,radius=250)
SERC_009_circ_clip <- clip_circle(ctg_SERC,364617.365644134,4306568.35464989,radius=250)
SERC_010_circ_clip <- clip_circle(ctg_SERC,365933.703739336,4307889.7097039,radius=250)
SERC_011_circ_clip <- clip_circle(ctg_SERC,365496.198523197,4306659.266753,radius=250)
SERC_012_circ_clip <- clip_circle(ctg_SERC,364598.088740468,4304468.0376071,radius=250)
SERC_013_circ_clip <- clip_circle(ctg_SERC,366020.257422853,4303682.76106607,radius=250)
SERC_014_circ_clip <- clip_circle(ctg_SERC,366317.719927511,4304144.30383618,radius=250)
SERC_016_circ_clip <- clip_circle(ctg_SERC,365802.257232171,4306757.3077399,radius=250)
SERC_017_circ_clip <- clip_circle(ctg_SERC,366797.613026211,4304141.09940032,radius=250)
SERC_018_circ_clip <- clip_circle(ctg_SERC,367135.084455281,4303789.9703143,radius=250)
SERC_019_circ_clip <- clip_circle(ctg_SERC,365477.315106447,4303690.07956473,radius=250)
SERC_020_circ_clip <- clip_circle(ctg_SERC,366755.133449501,4303483.42199063,radius=250)
SERC_022_circ_clip <- clip_circle(ctg_SERC,365146.012949459,4304104.11953647,radius=250)
SERC_024_circ_clip <- clip_circle(ctg_SERC,367352.505112215,4302994.72530679,radius=250)
SERC_025_circ_clip <- clip_circle(ctg_SERC,365406.553361538,4305315.90723049,radius=250)
SERC_026_circ_clip <- clip_circle(ctg_SERC,365541.71015178,4306958.55283636,radius=250)
SERC_029_circ_clip <- clip_circle(ctg_SERC,367362.461748531,4303594.33577312,radius=250)
SERC_068_circ_clip <- clip_circle(ctg_SERC,364968.834495219,4304624.00119384,radius=250)
#
hist(SERC_001_circ_clip@data$Z, breaks=100)
hist(SERC_002_circ_clip@data$Z, breaks=100)
hist(SERC_003_circ_clip@data$Z, breaks=100)
hist(SERC_004_circ_clip@data$Z, breaks=100)
hist(SERC_005_circ_clip@data$Z, breaks=100)
hist(SERC_006_circ_clip@data$Z, breaks=100)
hist(SERC_007_circ_clip@data$Z, breaks=100)
hist(SERC_008_circ_clip@data$Z, breaks=100)
hist(SERC_009_circ_clip@data$Z, breaks=100)
hist(SERC_010_circ_clip@data$Z, breaks=100)
hist(SERC_011_circ_clip@data$Z, breaks=100)
hist(SERC_012_circ_clip@data$Z, breaks=100)
hist(SERC_013_circ_clip@data$Z, breaks=100)
hist(SERC_014_circ_clip@data$Z, breaks=100)
hist(SERC_016_circ_clip@data$Z, breaks=100)
hist(SERC_017_circ_clip@data$Z, breaks=100)
hist(SERC_018_circ_clip@data$Z, breaks=100)
hist(SERC_019_circ_clip@data$Z, breaks=100)
hist(SERC_020_circ_clip@data$Z, breaks=100)
hist(SERC_022_circ_clip@data$Z, breaks=100)
hist(SERC_024_circ_clip@data$Z, breaks=100)
hist(SERC_025_circ_clip@data$Z, breaks=100)
hist(SERC_026_circ_clip@data$Z, breaks=100)
hist(SERC_029_circ_clip@data$Z, breaks=100)
hist(SERC_068_circ_clip@data$Z, breaks=100)
SERC_001_circ_clip <- filter_poi(SERC_001_circ_clip, Z >= 0, Z<= 100)
SERC_002_circ_clip <- filter_poi(SERC_002_circ_clip, Z >= 0, Z<= 600)
SERC_003_circ_clip <- filter_poi(SERC_003_circ_clip, Z >= 0, Z<= 600)
SERC_004_circ_clip <- filter_poi(SERC_004_circ_clip, Z >= 0, Z<= 100)
SERC_005_circ_clip <- filter_poi(SERC_005_circ_clip, Z >= 0, Z<= 100)
SERC_006_circ_clip <- filter_poi(SERC_006_circ_clip, Z >= 0, Z<= 100)
SERC_007_circ_clip <- filter_poi(SERC_007_circ_clip, Z >= 0, Z<= 50)
SERC_008_circ_clip <- filter_poi(SERC_008_circ_clip, Z >= 0, Z<= 60)
SERC_009_circ_clip <- filter_poi(SERC_009_circ_clip, Z >= 0, Z<= 600)
SERC_010_circ_clip <- filter_poi(SERC_010_circ_clip, Z >= 0, Z<= 200)
SERC_011_circ_clip <- filter_poi(SERC_011_circ_clip, Z >= 0, Z<= 200)
SERC_012_circ_clip <- filter_poi(SERC_012_circ_clip, Z >= 0, Z<= 600)
SERC_013_circ_clip <- filter_poi(SERC_013_circ_clip, Z >= 0, Z<= 80)
SERC_014_circ_clip <- filter_poi(SERC_014_circ_clip, Z >= 0, Z<= 100)
SERC_016_circ_clip <- filter_poi(SERC_016_circ_clip, Z >= 0, Z<= 200)
SERC_017_circ_clip <- filter_poi(SERC_017_circ_clip, Z >= 0, Z<= 200)
SERC_018_circ_clip <- filter_poi(SERC_018_circ_clip, Z >= 0, Z<= 100)
SERC_019_circ_clip <- filter_poi(SERC_019_circ_clip, Z >= 0, Z<= 200)
SERC_020_circ_clip <- filter_poi(SERC_020_circ_clip, Z >= 0, Z<= 100)
SERC_022_circ_clip <- filter_poi(SERC_022_circ_clip, Z >= 0, Z<= 200)
SERC_024_circ_clip <- filter_poi(SERC_024_circ_clip, Z >= 0, Z<= 600)
SERC_025_circ_clip <- filter_poi(SERC_025_circ_clip, Z >= 0, Z<= 600)
SERC_026_circ_clip <- filter_poi(SERC_026_circ_clip, Z >= 0, Z<= 600)
SERC_029_circ_clip <- filter_poi(SERC_029_circ_clip, Z >= 0, Z<= 60)
SERC_068_circ_clip <- filter_poi(SERC_068_circ_clip, Z >= 0, Z<= 600)
#
SERC_001_circ_clip_dtm_idw <- grid_terrain(SERC_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_002_circ_clip_dtm_idw <- grid_terrain(SERC_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_003_circ_clip_dtm_idw <- grid_terrain(SERC_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_004_circ_clip_dtm_idw <- grid_terrain(SERC_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_005_circ_clip_dtm_idw <- grid_terrain(SERC_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_006_circ_clip_dtm_idw <- grid_terrain(SERC_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_007_circ_clip_dtm_idw <- grid_terrain(SERC_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_008_circ_clip_dtm_idw <- grid_terrain(SERC_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_009_circ_clip_dtm_idw <- grid_terrain(SERC_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_010_circ_clip_dtm_idw <- grid_terrain(SERC_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_011_circ_clip_dtm_idw <- grid_terrain(SERC_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_012_circ_clip_dtm_idw <- grid_terrain(SERC_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_013_circ_clip_dtm_idw <- grid_terrain(SERC_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_014_circ_clip_dtm_idw <- grid_terrain(SERC_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_016_circ_clip_dtm_idw <- grid_terrain(SERC_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_017_circ_clip_dtm_idw <- grid_terrain(SERC_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_018_circ_clip_dtm_idw <- grid_terrain(SERC_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_019_circ_clip_dtm_idw <- grid_terrain(SERC_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_020_circ_clip_dtm_idw <- grid_terrain(SERC_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_022_circ_clip_dtm_idw <- grid_terrain(SERC_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_024_circ_clip_dtm_idw <- grid_terrain(SERC_024_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_025_circ_clip_dtm_idw <- grid_terrain(SERC_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_026_circ_clip_dtm_idw <- grid_terrain(SERC_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_029_circ_clip_dtm_idw <- grid_terrain(SERC_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SERC_068_circ_clip_dtm_idw <- grid_terrain(SERC_068_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
SERC_001_rec_clip_normalized <- filter_poi(normalize_height(SERC_001_circ_clip,SERC_001_circ_clip_dtm_idw),Z >= 0)
SERC_002_rec_clip_normalized <- filter_poi(normalize_height(SERC_002_circ_clip,SERC_002_circ_clip_dtm_idw),Z >= 0)
SERC_003_rec_clip_normalized <- filter_poi(normalize_height(SERC_003_circ_clip,SERC_003_circ_clip_dtm_idw),Z >= 0)
SERC_004_rec_clip_normalized <- filter_poi(normalize_height(SERC_004_circ_clip,SERC_004_circ_clip_dtm_idw),Z >= 0)
SERC_005_rec_clip_normalized <- filter_poi(normalize_height(SERC_005_circ_clip,SERC_005_circ_clip_dtm_idw),Z >= 0)
SERC_006_rec_clip_normalized <- filter_poi(normalize_height(SERC_006_circ_clip,SERC_006_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
SERC_007_rec_clip_normalized <- filter_poi(normalize_height(SERC_007_circ_clip,SERC_007_circ_clip_dtm_idw),Z >= 0)
SERC_008_rec_clip_normalized <- filter_poi(normalize_height(SERC_008_circ_clip,SERC_008_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
SERC_009_rec_clip_normalized <- filter_poi(normalize_height(SERC_009_circ_clip,SERC_009_circ_clip_dtm_idw),Z >= 0)
SERC_010_rec_clip_normalized <- filter_poi(normalize_height(SERC_010_circ_clip,SERC_010_circ_clip_dtm_idw),Z >= 0)
SERC_011_rec_clip_normalized <- filter_poi(normalize_height(SERC_011_circ_clip,SERC_011_circ_clip_dtm_idw),Z >= 0)
SERC_012_rec_clip_normalized <- filter_poi(normalize_height(SERC_012_circ_clip,SERC_012_circ_clip_dtm_idw),Z >= 0)
SERC_013_rec_clip_normalized <- filter_poi(normalize_height(SERC_013_circ_clip,SERC_013_circ_clip_dtm_idw),Z >= 0)
SERC_014_rec_clip_normalized <- filter_poi(normalize_height(SERC_014_circ_clip,SERC_014_circ_clip_dtm_idw),Z >= 0)
SERC_016_rec_clip_normalized <- filter_poi(normalize_height(SERC_016_circ_clip,SERC_016_circ_clip_dtm_idw),Z >= 0)
SERC_017_rec_clip_normalized <- filter_poi(normalize_height(SERC_017_circ_clip,SERC_017_circ_clip_dtm_idw),Z >= 0)
SERC_018_rec_clip_normalized <- filter_poi(normalize_height(SERC_018_circ_clip,SERC_018_circ_clip_dtm_idw),Z >= 0)
SERC_019_rec_clip_normalized <- filter_poi(normalize_height(SERC_019_circ_clip,SERC_019_circ_clip_dtm_idw),Z >= 0)
SERC_020_rec_clip_normalized <- filter_poi(normalize_height(SERC_020_circ_clip,SERC_020_circ_clip_dtm_idw),Z >= 0)
SERC_022_rec_clip_normalized <- filter_poi(normalize_height(SERC_022_circ_clip,SERC_022_circ_clip_dtm_idw),Z >= 0)
SERC_024_rec_clip_normalized <- filter_poi(normalize_height(SERC_024_circ_clip,SERC_024_circ_clip_dtm_idw),Z >= 0)
SERC_025_rec_clip_normalized <- filter_poi(normalize_height(SERC_025_circ_clip,SERC_025_circ_clip_dtm_idw),Z >= 0)
SERC_026_rec_clip_normalized <- filter_poi(normalize_height(SERC_026_circ_clip,SERC_026_circ_clip_dtm_idw),Z >= 0)
SERC_029_rec_clip_normalized <- filter_poi(normalize_height(SERC_029_circ_clip,SERC_029_circ_clip_dtm_idw),Z >= 0)
SERC_068_rec_clip_normalized <- filter_poi(normalize_height(SERC_068_circ_clip,SERC_068_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(SERC_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_001_rec_clip_normalized.laz")
writeLAS(SERC_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_002_rec_clip_normalized.laz")
writeLAS(SERC_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_003_rec_clip_normalized.laz")
writeLAS(SERC_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_004_rec_clip_normalized.laz")
writeLAS(SERC_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_005_rec_clip_normalized.laz")
writeLAS(SERC_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_006_rec_clip_normalized.laz")
writeLAS(SERC_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_007_rec_clip_normalized.laz")
writeLAS(SERC_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_008_rec_clip_normalized.laz")
writeLAS(SERC_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_009_rec_clip_normalized.laz")
writeLAS(SERC_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_010_rec_clip_normalized.laz")
writeLAS(SERC_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_011_rec_clip_normalized.laz")
writeLAS(SERC_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_012_rec_clip_normalized.laz")
writeLAS(SERC_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_013_rec_clip_normalized.laz")
writeLAS(SERC_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_014_rec_clip_normalized.laz")
writeLAS(SERC_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_016_rec_clip_normalized.laz")
writeLAS(SERC_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_017_rec_clip_normalized.laz")
writeLAS(SERC_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_018_rec_clip_normalized.laz")
writeLAS(SERC_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_019_rec_clip_normalized.laz")
writeLAS(SERC_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_020_rec_clip_normalized.laz")
writeLAS(SERC_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_022_rec_clip_normalized.laz")
writeLAS(SERC_024_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_024_rec_clip_normalized.laz")
writeLAS(SERC_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_025_rec_clip_normalized.laz")
writeLAS(SERC_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_026_rec_clip_normalized.laz")
writeLAS(SERC_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_029_rec_clip_normalized.laz")
writeLAS(SERC_068_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D02_SERC/HtNorm_250_radius/SERC_068_rec_clip_normalized.laz")


# Domain 3: DSNY ####################
ctg_DSNY <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/DP1.30003.001/neon-aop-products/2017/FullSite/D03/2017_DSNY_3/L1/DiscreteLidar/ClassifiedPointCloud")
DSNY_001_circ_clip <- clip_circle(ctg_DSNY,458879.093,3108012.351,radius=250)
DSNY_002_circ_clip <- clip_circle(ctg_DSNY,459028.43,3102645.18,radius=250)
DSNY_004_circ_clip <- clip_circle(ctg_DSNY,460622.094,3108165.794,radius=250)
DSNY_008_circ_clip <- clip_circle(ctg_DSNY,460503.896,3102408.885,radius=250)
DSNY_010_circ_clip <- clip_circle(ctg_DSNY,457433.094,3110415.867,radius=250)
DSNY_013_circ_clip <- clip_circle(ctg_DSNY,458158.661,3109483.029,radius=250)
DSNY_016_circ_clip <- clip_circle(ctg_DSNY,461320.775,3102310.633,radius=250)
DSNY_017_circ_clip <- clip_circle(ctg_DSNY,460410.256,3103700.952,radius=250)
DSNY_018_circ_clip <- clip_circle(ctg_DSNY,458104.486,3103983.111,radius=250)
DSNY_019_circ_clip <- clip_circle(ctg_DSNY,461223.184,3105530.834,radius=250)
DSNY_034_circ_clip <- clip_circle(ctg_DSNY,458897.4172,3104544.828,radius=250)
DSNY_038_circ_clip <- clip_circle(ctg_DSNY,461652.4307,3103700.965,radius=250)
#
hist(DSNY_001_circ_clip@data$Z, breaks=100)
hist(DSNY_002_circ_clip@data$Z, breaks=100)
hist(DSNY_004_circ_clip@data$Z, breaks=100)
hist(DSNY_008_circ_clip@data$Z, breaks=100)
hist(DSNY_010_circ_clip@data$Z, breaks=100)
hist(DSNY_013_circ_clip@data$Z, breaks=100)
hist(DSNY_016_circ_clip@data$Z, breaks=100)
hist(DSNY_017_circ_clip@data$Z, breaks=100)
hist(DSNY_018_circ_clip@data$Z, breaks=100)
hist(DSNY_019_circ_clip@data$Z, breaks=100)
hist(DSNY_034_circ_clip@data$Z, breaks=100)
hist(DSNY_038_circ_clip@data$Z, breaks=100)
DSNY_001_circ_clip <- filter_poi(DSNY_001_circ_clip, Z >= 0, Z<= 600)
DSNY_002_circ_clip <- filter_poi(DSNY_002_circ_clip, Z >= 100, Z<= 600)
DSNY_004_circ_clip <- filter_poi(DSNY_004_circ_clip, Z >= 100, Z<= 600)
DSNY_008_circ_clip <- filter_poi(DSNY_008_circ_clip, Z >= 100, Z<= 600)
DSNY_010_circ_clip <- filter_poi(DSNY_010_circ_clip, Z >= 100, Z<= 600)
DSNY_013_circ_clip <- filter_poi(DSNY_013_circ_clip, Z >= 100, Z<= 600)
DSNY_016_circ_clip <- filter_poi(DSNY_016_circ_clip, Z >= 100, Z<= 600)
DSNY_017_circ_clip <- filter_poi(DSNY_017_circ_clip, Z >= 100, Z<= 600)
DSNY_018_circ_clip <- filter_poi(DSNY_018_circ_clip, Z >= 100, Z<= 600)
DSNY_019_circ_clip <- filter_poi(DSNY_019_circ_clip, Z >= 0, Z<= 100)
DSNY_034_circ_clip <- filter_poi(DSNY_034_circ_clip, Z >= 0, Z<= 600)
DSNY_038_circ_clip <- filter_poi(DSNY_038_circ_clip, Z >= 100, Z<= 600)
#
DSNY_001_circ_clip_dtm_idw <- grid_terrain(DSNY_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_002_circ_clip_dtm_idw <- grid_terrain(DSNY_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_004_circ_clip_dtm_idw <- grid_terrain(DSNY_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_008_circ_clip_dtm_idw <- grid_terrain(DSNY_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_010_circ_clip_dtm_idw <- grid_terrain(DSNY_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_013_circ_clip_dtm_idw <- grid_terrain(DSNY_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_016_circ_clip_dtm_idw <- grid_terrain(DSNY_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_017_circ_clip_dtm_idw <- grid_terrain(DSNY_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_018_circ_clip_dtm_idw <- grid_terrain(DSNY_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_019_circ_clip_dtm_idw <- grid_terrain(DSNY_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_034_circ_clip_dtm_idw <- grid_terrain(DSNY_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DSNY_038_circ_clip_dtm_idw <- grid_terrain(DSNY_038_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
DSNY_001_rec_clip_normalized <- filter_poi(normalize_height(DSNY_001_circ_clip,DSNY_001_circ_clip_dtm_idw),Z >= 0)
DSNY_002_rec_clip_normalized <- filter_poi(normalize_height(DSNY_002_circ_clip,DSNY_002_circ_clip_dtm_idw),Z >= 0)
DSNY_004_rec_clip_normalized <- filter_poi(normalize_height(DSNY_004_circ_clip,DSNY_004_circ_clip_dtm_idw),Z >= 0)
DSNY_008_rec_clip_normalized <- filter_poi(normalize_height(DSNY_008_circ_clip,DSNY_008_circ_clip_dtm_idw),Z >= 0)
DSNY_010_rec_clip_normalized <- filter_poi(normalize_height(DSNY_010_circ_clip,DSNY_010_circ_clip_dtm_idw),Z >= 0)
DSNY_013_rec_clip_normalized <- filter_poi(normalize_height(DSNY_013_circ_clip,DSNY_013_circ_clip_dtm_idw),Z >= 0)
DSNY_016_rec_clip_normalized <- filter_poi(normalize_height(DSNY_016_circ_clip,DSNY_016_circ_clip_dtm_idw),Z >= 0)
DSNY_017_rec_clip_normalized <- filter_poi(normalize_height(DSNY_017_circ_clip,DSNY_017_circ_clip_dtm_idw),Z >= 0)
DSNY_018_rec_clip_normalized <- filter_poi(normalize_height(DSNY_018_circ_clip,DSNY_018_circ_clip_dtm_idw),Z >= 0)
DSNY_019_rec_clip_normalized <- filter_poi(normalize_height(DSNY_019_circ_clip,DSNY_019_circ_clip_dtm_idw),Z >= 0)
DSNY_034_rec_clip_normalized <- filter_poi(normalize_height(DSNY_034_circ_clip,DSNY_034_circ_clip_dtm_idw),Z >= 0)
DSNY_038_rec_clip_normalized <- filter_poi(normalize_height(DSNY_038_circ_clip,DSNY_038_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(DSNY_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_001_rec_clip_normalized.laz")
writeLAS(DSNY_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_002_rec_clip_normalized.laz")
writeLAS(DSNY_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_004_rec_clip_normalized.laz")
writeLAS(DSNY_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_008_rec_clip_normalized.laz")
writeLAS(DSNY_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_010_rec_clip_normalized.laz")
writeLAS(DSNY_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_013_rec_clip_normalized.laz")
writeLAS(DSNY_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_016_rec_clip_normalized.laz")
writeLAS(DSNY_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_017_rec_clip_normalized.laz")
writeLAS(DSNY_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_018_rec_clip_normalized.laz")
writeLAS(DSNY_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_019_rec_clip_normalized.laz")
writeLAS(DSNY_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_034_rec_clip_normalized.laz")
writeLAS(DSNY_038_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_DSNY/HtNorm_250_radius/DSNY_038_rec_clip_normalized.laz")

# Domain 3: JERC ####################
ctg_JERC <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/DP1.30003.001/neon-aop-products/2017/FullSite/D03/2017_JERC_3/L1/DiscreteLidar/ClassifiedPointCloud")
JERC_002_circ_clip <- clip_circle(ctg_JERC,742021.584,3453908.904,radius=250)
JERC_003_circ_clip <- clip_circle(ctg_JERC,740873.712,3453927.786,radius=250)
JERC_005_circ_clip <- clip_circle(ctg_JERC,742787.309,3454025.912,radius=250)
JERC_006_circ_clip <- clip_circle(ctg_JERC,742588.938,3453130.312,radius=250)
JERC_011_circ_clip <- clip_circle(ctg_JERC,741238.017,3452927.169,radius=250)
JERC_013_circ_clip <- clip_circle(ctg_JERC,741234.089,3452169.541,radius=250)
JERC_028_circ_clip <- clip_circle(ctg_JERC,740199.907,3452723.586,radius=250)
JERC_031_circ_clip <- clip_circle(ctg_JERC,741698.551,3454939.492,radius=250)
JERC_042_circ_clip <- clip_circle(ctg_JERC,740964.567,3455618.424,radius=250)
#
hist(JERC_002_circ_clip@data$Z, breaks=100)
hist(JERC_003_circ_clip@data$Z, breaks=100)
hist(JERC_005_circ_clip@data$Z, breaks=100)
hist(JERC_006_circ_clip@data$Z, breaks=100)
hist(JERC_011_circ_clip@data$Z, breaks=100)
hist(JERC_013_circ_clip@data$Z, breaks=100)
hist(JERC_028_circ_clip@data$Z, breaks=100)
hist(JERC_031_circ_clip@data$Z, breaks=100)
hist(JERC_042_circ_clip@data$Z, breaks=100)
JERC_002_circ_clip <- filter_poi(JERC_002_circ_clip, Z >= 0, Z<= 600)
JERC_003_circ_clip <- filter_poi(JERC_003_circ_clip, Z >= 100, Z<= 600)
JERC_005_circ_clip <- filter_poi(JERC_005_circ_clip, Z >= 100, Z<= 600)
JERC_006_circ_clip <- filter_poi(JERC_006_circ_clip, Z >= 100, Z<= 600)
JERC_011_circ_clip <- filter_poi(JERC_011_circ_clip, Z >= 100, Z<= 600)
JERC_013_circ_clip <- filter_poi(JERC_013_circ_clip, Z >= 100, Z<= 600)
JERC_028_circ_clip <- filter_poi(JERC_028_circ_clip, Z >= 100, Z<= 600)
JERC_031_circ_clip <- filter_poi(JERC_031_circ_clip, Z >= 100, Z<= 600)
JERC_042_circ_clip <- filter_poi(JERC_042_circ_clip, Z >= 100, Z<= 600)
#
JERC_002_circ_clip_dtm_idw <- grid_terrain(JERC_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_003_circ_clip_dtm_idw <- grid_terrain(JERC_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_005_circ_clip_dtm_idw <- grid_terrain(JERC_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_006_circ_clip_dtm_idw <- grid_terrain(JERC_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_011_circ_clip_dtm_idw <- grid_terrain(JERC_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_013_circ_clip_dtm_idw <- grid_terrain(JERC_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_028_circ_clip_dtm_idw <- grid_terrain(JERC_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_031_circ_clip_dtm_idw <- grid_terrain(JERC_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JERC_042_circ_clip_dtm_idw <- grid_terrain(JERC_042_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
JERC_002_rec_clip_normalized <- filter_poi(normalize_height(JERC_002_circ_clip,JERC_002_circ_clip_dtm_idw),Z >= 0)
JERC_003_rec_clip_normalized <- filter_poi(normalize_height(JERC_003_circ_clip,JERC_003_circ_clip_dtm_idw),Z >= 0)
JERC_005_rec_clip_normalized <- filter_poi(normalize_height(JERC_005_circ_clip,JERC_005_circ_clip_dtm_idw),Z >= 0)
JERC_006_rec_clip_normalized <- filter_poi(normalize_height(JERC_006_circ_clip,JERC_006_circ_clip_dtm_idw),Z >= 0)
JERC_011_rec_clip_normalized <- filter_poi(normalize_height(JERC_011_circ_clip,JERC_011_circ_clip_dtm_idw),Z >= 0)
JERC_013_rec_clip_normalized <- filter_poi(normalize_height(JERC_013_circ_clip,JERC_013_circ_clip_dtm_idw),Z >= 0)
JERC_028_rec_clip_normalized <- filter_poi(normalize_height(JERC_028_circ_clip,JERC_028_circ_clip_dtm_idw),Z >= 0)
JERC_031_rec_clip_normalized <- filter_poi(normalize_height(JERC_031_circ_clip,JERC_031_circ_clip_dtm_idw),Z >= 0)
JERC_042_rec_clip_normalized <- filter_poi(normalize_height(JERC_042_circ_clip,JERC_042_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(JERC_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_002_rec_clip_normalized.laz")
writeLAS(JERC_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_003_rec_clip_normalized.laz")
writeLAS(JERC_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_005_rec_clip_normalized.laz")
writeLAS(JERC_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_006_rec_clip_normalized.laz")
writeLAS(JERC_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_011_rec_clip_normalized.laz")
writeLAS(JERC_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_013_rec_clip_normalized.laz")
writeLAS(JERC_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_028_rec_clip_normalized.laz")
writeLAS(JERC_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_031_rec_clip_normalized.laz")
writeLAS(JERC_042_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D03_JERC/HtNorm_250_radius/JERC_042_rec_clip_normalized.laz")

# Domain 5: STEI ####################  Possible issue with points??
ctg_STEI <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/DP1.30003.001/neon-aop-products/2017/FullSite/D05/2017_CHEQ_3/L1/DiscreteLidar/ClassifiedPointCloud")
STEI_001_circ_clip <- clip_circle(ctg_STEI,726058.1095,5077323.325,radius=250)
STEI_002_circ_clip <- clip_circle(ctg_STEI,725864.2958,5075821.525,radius=250)
STEI_003_circ_clip <- clip_circle(ctg_STEI,727368.7863,5078623.439,radius=250)
STEI_005_circ_clip <- clip_circle(ctg_STEI,726488.2063,5078821.665,radius=250)
STEI_007_circ_clip <- clip_circle(ctg_STEI,729122.3439,5075492.029,radius=250)
STEI_011_circ_clip <- clip_circle(ctg_STEI,727317.6533,5076501.173,radius=250)
STEI_013_circ_clip <- clip_circle(ctg_STEI,727452.8057,5075205.722,radius=250)
STEI_019_circ_clip <- clip_circle(ctg_STEI,727280.6289,5079513.134,radius=250)
STEI_032_circ_clip <- clip_circle(ctg_STEI,724122.1556,5074423.402,radius=250)
STEI_033_circ_clip <- clip_circle(ctg_STEI,728223.7878,5075277.064,radius=250)
#
hist(STEI_001_circ_clip@data$Z, breaks=100)
hist(STEI_002_circ_clip@data$Z, breaks=100)
hist(STEI_003_circ_clip@data$Z, breaks=100)
hist(STEI_005_circ_clip@data$Z, breaks=100)
hist(STEI_007_circ_clip@data$Z, breaks=100)
hist(STEI_011_circ_clip@data$Z, breaks=100)
hist(STEI_013_circ_clip@data$Z, breaks=100)
hist(STEI_019_circ_clip@data$Z, breaks=100)
hist(STEI_032_circ_clip@data$Z, breaks=100)
hist(STEI_033_circ_clip@data$Z, breaks=100)
STEI_001_circ_clip <- filter_poi(STEI_001_circ_clip, Z >= 450, Z<= 600)
STEI_002_circ_clip <- filter_poi(STEI_002_circ_clip, Z >= 400, Z<= 800)
STEI_003_circ_clip <- filter_poi(STEI_003_circ_clip, Z >= 300, Z<= 800)
STEI_005_circ_clip <- filter_poi(STEI_005_circ_clip, Z >= 100, Z<= 800)
STEI_007_circ_clip <- filter_poi(STEI_007_circ_clip, Z >= 400, Z<= 600)
STEI_011_circ_clip <- filter_poi(STEI_011_circ_clip, Z >= 0, Z<= 570)
STEI_013_circ_clip <- filter_poi(STEI_013_circ_clip, Z >= 100, Z<= 700)
STEI_019_circ_clip <- filter_poi(STEI_019_circ_clip, Z >= 100, Z<= 600)
STEI_032_circ_clip <- filter_poi(STEI_032_circ_clip, Z >= 100, Z<= 700)
STEI_033_circ_clip <- filter_poi(STEI_033_circ_clip, Z >= 100, Z<= 600)
#
STEI_001_circ_clip_dtm_idw <- grid_terrain(STEI_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_002_circ_clip_dtm_idw <- grid_terrain(STEI_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_003_circ_clip_dtm_idw <- grid_terrain(STEI_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_005_circ_clip_dtm_idw <- grid_terrain(STEI_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_007_circ_clip_dtm_idw <- grid_terrain(STEI_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_011_circ_clip_dtm_idw <- grid_terrain(STEI_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_013_circ_clip_dtm_idw <- grid_terrain(STEI_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_019_circ_clip_dtm_idw <- grid_terrain(STEI_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_032_circ_clip_dtm_idw <- grid_terrain(STEI_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STEI_033_circ_clip_dtm_idw <- grid_terrain(STEI_033_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
STEI_001_rec_clip_normalized <- filter_poi(normalize_height(STEI_001_circ_clip,STEI_001_circ_clip_dtm_idw),Z >= 0)
STEI_002_rec_clip_normalized <- filter_poi(normalize_height(STEI_002_circ_clip,STEI_002_circ_clip_dtm_idw),Z >= 0)
STEI_003_rec_clip_normalized <- filter_poi(normalize_height(STEI_003_circ_clip,STEI_003_circ_clip_dtm_idw),Z >= 0)
STEI_005_rec_clip_normalized <- filter_poi(normalize_height(STEI_005_circ_clip,STEI_005_circ_clip_dtm_idw),Z >= 0)
STEI_007_rec_clip_normalized <- filter_poi(normalize_height(STEI_007_circ_clip,STEI_007_circ_clip_dtm_idw),Z >= 0)
STEI_011_rec_clip_normalized <- filter_poi(normalize_height(STEI_011_circ_clip,STEI_011_circ_clip_dtm_idw),Z >= 0)
STEI_013_rec_clip_normalized <- filter_poi(normalize_height(STEI_013_circ_clip,STEI_013_circ_clip_dtm_idw),Z >= 0)
STEI_019_rec_clip_normalized <- filter_poi(normalize_height(STEI_019_circ_clip,STEI_019_circ_clip_dtm_idw),Z >= 0)
STEI_032_rec_clip_normalized <- filter_poi(normalize_height(STEI_032_circ_clip,STEI_032_circ_clip_dtm_idw),Z >= 0)
STEI_033_rec_clip_normalized <- filter_poi(normalize_height(STEI_033_circ_clip,STEI_033_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(STEI_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_001_rec_clip_normalized.laz")
writeLAS(STEI_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_002_rec_clip_normalized.laz")
writeLAS(STEI_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_003_rec_clip_normalized.laz")
writeLAS(STEI_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_005_rec_clip_normalized.laz")
writeLAS(STEI_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_007_rec_clip_normalized.laz")
writeLAS(STEI_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_011_rec_clip_normalized.laz")
writeLAS(STEI_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_013_rec_clip_normalized.laz")
writeLAS(STEI_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_019_rec_clip_normalized.laz")
writeLAS(STEI_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_032_rec_clip_normalized.laz")
writeLAS(STEI_033_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_STEI/HtNorm_250_radius/STEI_033_rec_clip_normalized.laz")

# Domain 5: TREE #################### - point
ctg_TREE <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/DP1.30003.001/neon-aop-products/2017/FullSite/D05/2017_STEI_2/L1/DiscreteLidar/ClassifiedPointCloud")
TREE_001_circ_clip <- clip_circle(ctg_TREE,299180.86907142,5040345.86808852,radius=250)
TREE_002_circ_clip <- clip_circle(ctg_TREE,299361.397256401,5040854.3218509,radius=250)
TREE_003_circ_clip <- clip_circle(ctg_TREE,298580.792753924,5040644.683857,radius=250)
TREE_004_circ_clip <- clip_circle(ctg_TREE,300230.984570242,5039443.59198583,radius=250)
TREE_007_circ_clip <- clip_circle(ctg_TREE,300202.018634672,5041334.37868102,radius=250)
TREE_010_circ_clip <- clip_circle(ctg_TREE,299721.283908707,5041124.29060293,radius=250)
TREE_012_circ_clip <- clip_circle(ctg_TREE,298909.818428254,5040762.90952281,radius=250)
TREE_013_circ_clip <- clip_circle(ctg_TREE,298492.518090418,5040163.53408642,radius=250)
TREE_015_circ_clip <- clip_circle(ctg_TREE,300349.855097173,5040224.15581381,radius=250)
TREE_016_circ_clip <- clip_circle(ctg_TREE,299481.626238107,5041214.3526155,radius=250)
TREE_017_circ_clip <- clip_circle(ctg_TREE,298671.076326133,5040884.11155026,radius=250)
TREE_019_circ_clip <- clip_circle(ctg_TREE,298880.671295606,5041095.58131038,radius=250)
TREE_020_circ_clip <- clip_circle(ctg_TREE,299960.515061699,5040853.87216192,radius=250)
TREE_022_circ_clip <- clip_circle(ctg_TREE,300651.447767932,5040914.83912828,radius=250)
TREE_023_circ_clip <- clip_circle(ctg_TREE,300590.971314946,5040343.37596686,radius=250)
TREE_026_circ_clip <- clip_circle(ctg_TREE,300411.04542256,5041033.69080783,radius=250)
TREE_060_circ_clip <- clip_circle(ctg_TREE,299361.082519468,5041514.46769168,radius=250)
#
hist(TREE_001_circ_clip@data$Z, breaks=100)
hist(TREE_002_circ_clip@data$Z, breaks=100)
hist(TREE_003_circ_clip@data$Z, breaks=100)
hist(TREE_004_circ_clip@data$Z, breaks=100)
hist(TREE_007_circ_clip@data$Z, breaks=100)
hist(TREE_010_circ_clip@data$Z, breaks=100)
hist(TREE_012_circ_clip@data$Z, breaks=100)
hist(TREE_013_circ_clip@data$Z, breaks=100)
hist(TREE_015_circ_clip@data$Z, breaks=100)
hist(TREE_016_circ_clip@data$Z, breaks=100)
hist(TREE_017_circ_clip@data$Z, breaks=100)
hist(TREE_019_circ_clip@data$Z, breaks=100)
hist(TREE_020_circ_clip@data$Z, breaks=100)
hist(TREE_022_circ_clip@data$Z, breaks=100)
hist(TREE_023_circ_clip@data$Z, breaks=100)
hist(TREE_026_circ_clip@data$Z, breaks=100)
hist(TREE_060_circ_clip@data$Z, breaks=100)
TREE_001_circ_clip <- filter_poi(TREE_001_circ_clip, Z >= 300, Z<= 700)
TREE_002_circ_clip <- filter_poi(TREE_002_circ_clip, Z >= 100, Z<= 520)
TREE_003_circ_clip <- filter_poi(TREE_003_circ_clip, Z >= 400, Z<= 520)
TREE_004_circ_clip <- filter_poi(TREE_004_circ_clip, Z >= 400, Z<= 600)
TREE_007_circ_clip <- filter_poi(TREE_007_circ_clip, Z >= 300, Z<= 700)
TREE_010_circ_clip <- filter_poi(TREE_010_circ_clip, Z >= 450, Z<= 700)
TREE_012_circ_clip <- filter_poi(TREE_012_circ_clip, Z >= 420, Z<= 550)
TREE_013_circ_clip <- filter_poi(TREE_013_circ_clip, Z >= 300, Z<= 550)
TREE_015_circ_clip <- filter_poi(TREE_015_circ_clip, Z >= 420, Z<= 550)
TREE_016_circ_clip <- filter_poi(TREE_016_circ_clip, Z >= 430, Z<= 510)
TREE_017_circ_clip <- filter_poi(TREE_017_circ_clip, Z >= 410, Z<= 520)
TREE_019_circ_clip <- filter_poi(TREE_019_circ_clip, Z >= 300, Z<= 520)
TREE_020_circ_clip <- filter_poi(TREE_020_circ_clip, Z >= 300, Z<= 700)
TREE_022_circ_clip <- filter_poi(TREE_022_circ_clip, Z >= 440, Z<= 700)
TREE_023_circ_clip <- filter_poi(TREE_023_circ_clip, Z >= 440, Z<= 550)
TREE_026_circ_clip <- filter_poi(TREE_026_circ_clip, Z >= 390, Z<= 700)
TREE_060_circ_clip <- filter_poi(TREE_060_circ_clip, Z >= 390, Z<= 700)
#
TREE_001_circ_clip_dtm_idw <- grid_terrain(TREE_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_002_circ_clip_dtm_idw <- grid_terrain(TREE_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_003_circ_clip_dtm_idw <- grid_terrain(TREE_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_004_circ_clip_dtm_idw <- grid_terrain(TREE_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_007_circ_clip_dtm_idw <- grid_terrain(TREE_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_010_circ_clip_dtm_idw <- grid_terrain(TREE_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_012_circ_clip_dtm_idw <- grid_terrain(TREE_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_013_circ_clip_dtm_idw <- grid_terrain(TREE_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_015_circ_clip_dtm_idw <- grid_terrain(TREE_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_016_circ_clip_dtm_idw <- grid_terrain(TREE_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_017_circ_clip_dtm_idw <- grid_terrain(TREE_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_019_circ_clip_dtm_idw <- grid_terrain(TREE_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_020_circ_clip_dtm_idw <- grid_terrain(TREE_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_022_circ_clip_dtm_idw <- grid_terrain(TREE_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_023_circ_clip_dtm_idw <- grid_terrain(TREE_023_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_026_circ_clip_dtm_idw <- grid_terrain(TREE_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TREE_060_circ_clip_dtm_idw <- grid_terrain(TREE_060_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
TREE_001_rec_clip_normalized <- filter_poi(normalize_height(TREE_001_circ_clip,TREE_001_circ_clip_dtm_idw),Z >= 0)
TREE_002_rec_clip_normalized <- filter_poi(normalize_height(TREE_002_circ_clip,TREE_002_circ_clip_dtm_idw),Z >= 0)
TREE_003_rec_clip_normalized <- filter_poi(normalize_height(TREE_003_circ_clip,TREE_003_circ_clip_dtm_idw),Z >= 0)
TREE_004_rec_clip_normalized <- filter_poi(normalize_height(TREE_004_circ_clip,TREE_004_circ_clip_dtm_idw),Z >= 0)
TREE_007_rec_clip_normalized <- filter_poi(normalize_height(TREE_007_circ_clip,TREE_007_circ_clip_dtm_idw),Z >= 0)
TREE_010_rec_clip_normalized <- filter_poi(normalize_height(TREE_010_circ_clip,TREE_010_circ_clip_dtm_idw),Z >= 0)
TREE_012_rec_clip_normalized <- filter_poi(normalize_height(TREE_012_circ_clip,TREE_012_circ_clip_dtm_idw),Z >= 0)
TREE_013_rec_clip_normalized <- filter_poi(normalize_height(TREE_013_circ_clip,TREE_013_circ_clip_dtm_idw),Z >= 0)
TREE_015_rec_clip_normalized <- filter_poi(normalize_height(TREE_015_circ_clip,TREE_015_circ_clip_dtm_idw),Z >= 0)
TREE_016_rec_clip_normalized <- filter_poi(normalize_height(TREE_016_circ_clip,TREE_016_circ_clip_dtm_idw),Z >= 0)
TREE_017_rec_clip_normalized <- filter_poi(normalize_height(TREE_017_circ_clip,TREE_017_circ_clip_dtm_idw),Z >= 0)
TREE_019_rec_clip_normalized <- filter_poi(normalize_height(TREE_019_circ_clip,TREE_019_circ_clip_dtm_idw),Z >= 0)
TREE_020_rec_clip_normalized <- filter_poi(normalize_height(TREE_020_circ_clip,TREE_020_circ_clip_dtm_idw),Z >= 0)
TREE_022_rec_clip_normalized <- filter_poi(normalize_height(TREE_022_circ_clip,TREE_022_circ_clip_dtm_idw),Z >= 0)
TREE_023_rec_clip_normalized <- filter_poi(normalize_height(TREE_023_circ_clip,TREE_023_circ_clip_dtm_idw),Z >= 0)
TREE_026_rec_clip_normalized <- filter_poi(normalize_height(TREE_026_circ_clip,TREE_026_circ_clip_dtm_idw),Z >= 0)
TREE_060_rec_clip_normalized <- filter_poi(normalize_height(TREE_060_circ_clip,TREE_060_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(TREE_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_001_rec_clip_normalized.laz")
writeLAS(TREE_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_002_rec_clip_normalized.laz")
writeLAS(TREE_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_003_rec_clip_normalized.laz")
writeLAS(TREE_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_004_rec_clip_normalized.laz")
writeLAS(TREE_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_007_rec_clip_normalized.laz")
writeLAS(TREE_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_010_rec_clip_normalized.laz")
writeLAS(TREE_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_012_rec_clip_normalized.laz")
writeLAS(TREE_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_013_rec_clip_normalized.laz")
writeLAS(TREE_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_015_rec_clip_normalized.laz")
writeLAS(TREE_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_016_rec_clip_normalized.laz")
writeLAS(TREE_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_017_rec_clip_normalized.laz")
writeLAS(TREE_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_019_rec_clip_normalized.laz")
writeLAS(TREE_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_020_rec_clip_normalized.laz")
writeLAS(TREE_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_022_rec_clip_normalized.laz")
writeLAS(TREE_023_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_023_rec_clip_normalized.laz")
writeLAS(TREE_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_026_rec_clip_normalized.laz")
writeLAS(TREE_060_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D05_TREE/HtNorm_250_radius/TREE_060_rec_clip_normalized.laz")

# Domain 6: UKFS ####################
ctg_UKFS <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/DP1.30003.001/neon-aop-products/2017/FullSite/D06/2017_UKFS_2/L1/DiscreteLidar/ClassifiedPointCloud")
UKFS_004_circ_clip <- clip_circle(ctg_UKFS,309230.252,4323767.809,radius=250)
UKFS_013_circ_clip <- clip_circle(ctg_UKFS,309595.036,4324809.152,radius=250)
UKFS_025_circ_clip <- clip_circle(ctg_UKFS,310497.874,4325163.62,radius=250)
UKFS_063_circ_clip <- clip_circle(ctg_UKFS,310291.547,4322910.282,radius=250)
UKFS_064_circ_clip <- clip_circle(ctg_UKFS,310036.398,4323707.596,radius=250)
#
hist(UKFS_004_circ_clip@data$Z, breaks=100)
hist(UKFS_013_circ_clip@data$Z, breaks=100)
hist(UKFS_025_circ_clip@data$Z, breaks=100)
hist(UKFS_063_circ_clip@data$Z, breaks=100)
hist(UKFS_064_circ_clip@data$Z, breaks=100)
UKFS_004_circ_clip <- filter_poi(UKFS_004_circ_clip, Z >= 100, Z<= 360)
UKFS_013_circ_clip <- filter_poi(UKFS_013_circ_clip, Z >= 280, Z<= 600)
UKFS_025_circ_clip <- filter_poi(UKFS_025_circ_clip, Z >= 100, Z<= 600)
UKFS_063_circ_clip <- filter_poi(UKFS_063_circ_clip, Z >= 100, Z<= 600)
UKFS_064_circ_clip <- filter_poi(UKFS_064_circ_clip, Z >= 100, Z<= 600)
#
UKFS_004_circ_clip_dtm_idw <- grid_terrain(UKFS_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UKFS_013_circ_clip_dtm_idw <- grid_terrain(UKFS_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UKFS_025_circ_clip_dtm_idw <- grid_terrain(UKFS_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UKFS_063_circ_clip_dtm_idw <- grid_terrain(UKFS_063_circ_clip, algorithm = knnidw(k = 10L, p = 2))
UKFS_064_circ_clip_dtm_idw <- grid_terrain(UKFS_064_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
UKFS_004_rec_clip_normalized <- filter_poi(normalize_height(UKFS_004_circ_clip,UKFS_004_circ_clip_dtm_idw),Z >= 0)
UKFS_013_rec_clip_normalized <- filter_poi(normalize_height(UKFS_013_circ_clip,UKFS_013_circ_clip_dtm_idw),Z >= 0)
UKFS_025_rec_clip_normalized <- filter_poi(normalize_height(UKFS_025_circ_clip,UKFS_025_circ_clip_dtm_idw),Z >= 0)
UKFS_063_rec_clip_normalized <- filter_poi(normalize_height(UKFS_063_circ_clip,UKFS_063_circ_clip_dtm_idw),Z >= 0)
UKFS_064_rec_clip_normalized <- filter_poi(normalize_height(UKFS_064_circ_clip,UKFS_064_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(UKFS_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/HtNorm_250_radius/UKFS_004_rec_clip_normalized.laz")
writeLAS(UKFS_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/HtNorm_250_radius/UKFS_013_rec_clip_normalized.laz")
writeLAS(UKFS_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/HtNorm_250_radius/UKFS_025_rec_clip_normalized.laz")
writeLAS(UKFS_063_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/HtNorm_250_radius/UKFS_063_rec_clip_normalized.laz")
writeLAS(UKFS_064_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D06_UKFS/HtNorm_250_radius/UKFS_064_rec_clip_normalized.laz")

# Domain 7: GRSM ####################
ctg_GRSM <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/DP1.30003.001/neon-aop-products/2017/FullSite/D07/2017_GRSM_3/L1/DiscreteLidar/ClassifiedPointCloud")
GRSM_001_circ_clip <- clip_circle(ctg_GRSM,271046.312,3952002.34,radius=250)
GRSM_002_circ_clip <- clip_circle(ctg_GRSM,265898.415,3950511.414,radius=250)
GRSM_003_circ_clip <- clip_circle(ctg_GRSM,276034.427,3950934.415,radius=250)
GRSM_004_circ_clip <- clip_circle(ctg_GRSM,270299.857,3952367.844,radius=250)
GRSM_006_circ_clip <- clip_circle(ctg_GRSM,260789.099,3951490.013,radius=250)
GRSM_007_circ_clip <- clip_circle(ctg_GRSM,272541.231,3951926.971,radius=250)
GRSM_010_circ_clip <- clip_circle(ctg_GRSM,271255.245,3950037.7,radius=250)
GRSM_013_circ_clip <- clip_circle(ctg_GRSM,261431.614,3952214.456,radius=250)
GRSM_015_circ_clip <- clip_circle(ctg_GRSM,281971.452,3956707.38,radius=250)
GRSM_020_circ_clip <- clip_circle(ctg_GRSM,286380.332,3953484.783,radius=250)
GRSM_031_circ_clip <- clip_circle(ctg_GRSM,274934.637,3951273.49,radius=250)
GRSM_032_circ_clip <- clip_circle(ctg_GRSM,274051.1432,3950510.821,radius=250)
GRSM_033_circ_clip <- clip_circle(ctg_GRSM,272768.9125,3953177.251,radius=250)
GRSM_034_circ_clip <- clip_circle(ctg_GRSM,272566.1084,3948277.216,radius=250)
GRSM_035_circ_clip <- clip_circle(ctg_GRSM,273170.3829,3947424.623,radius=250)
#
hist(GRSM_001_circ_clip@data$Z, breaks=100)
hist(GRSM_002_circ_clip@data$Z, breaks=100)
hist(GRSM_003_circ_clip@data$Z, breaks=100)
hist(GRSM_004_circ_clip@data$Z, breaks=100)
hist(GRSM_006_circ_clip@data$Z, breaks=100)
hist(GRSM_007_circ_clip@data$Z, breaks=100)
hist(GRSM_010_circ_clip@data$Z, breaks=100)
hist(GRSM_013_circ_clip@data$Z, breaks=100)
hist(GRSM_015_circ_clip@data$Z, breaks=100)
hist(GRSM_020_circ_clip@data$Z, breaks=100)
hist(GRSM_031_circ_clip@data$Z, breaks=100)
hist(GRSM_032_circ_clip@data$Z, breaks=100)
hist(GRSM_033_circ_clip@data$Z, breaks=100)
hist(GRSM_034_circ_clip@data$Z, breaks=100)
hist(GRSM_035_circ_clip@data$Z, breaks=100)
GRSM_001_circ_clip <- filter_poi(GRSM_001_circ_clip, Z >= 400, Z<= 800)
GRSM_002_circ_clip <- filter_poi(GRSM_002_circ_clip, Z >= 600, Z<= 810)
GRSM_003_circ_clip <- filter_poi(GRSM_003_circ_clip, Z >= 800, Z<= 1000)
GRSM_004_circ_clip <- filter_poi(GRSM_004_circ_clip, Z >= 100, Z<= 600)
GRSM_006_circ_clip <- filter_poi(GRSM_006_circ_clip, Z >= 100, Z<= 1000)
GRSM_007_circ_clip <- filter_poi(GRSM_007_circ_clip, Z >= 100, Z<= 1000)
GRSM_010_circ_clip <- filter_poi(GRSM_010_circ_clip, Z >= 450, Z<= 800)
GRSM_013_circ_clip <- filter_poi(GRSM_013_circ_clip, Z >= 100, Z<= 1000)
GRSM_015_circ_clip <- filter_poi(GRSM_015_circ_clip, Z >= 350, Z<= 800)
GRSM_020_circ_clip <- filter_poi(GRSM_020_circ_clip, Z >= 400, Z<= 1000)
GRSM_031_circ_clip <- filter_poi(GRSM_031_circ_clip, Z >= 500, Z<= 1000)
GRSM_032_circ_clip <- filter_poi(GRSM_032_circ_clip, Z >= 100, Z<= 1000)
GRSM_033_circ_clip <- filter_poi(GRSM_033_circ_clip, Z >= 450, Z<= 1000)
GRSM_034_circ_clip <- filter_poi(GRSM_034_circ_clip, Z >= 500, Z<= 1000)
GRSM_035_circ_clip <- filter_poi(GRSM_035_circ_clip, Z >= 600, Z<= 1100)
#
GRSM_001_circ_clip_dtm_idw <- grid_terrain(GRSM_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_002_circ_clip_dtm_idw <- grid_terrain(GRSM_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_003_circ_clip_dtm_idw <- grid_terrain(GRSM_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_004_circ_clip_dtm_idw <- grid_terrain(GRSM_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_006_circ_clip_dtm_idw <- grid_terrain(GRSM_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_007_circ_clip_dtm_idw <- grid_terrain(GRSM_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_010_circ_clip_dtm_idw <- grid_terrain(GRSM_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_013_circ_clip_dtm_idw <- grid_terrain(GRSM_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_015_circ_clip_dtm_idw <- grid_terrain(GRSM_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_020_circ_clip_dtm_idw <- grid_terrain(GRSM_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_031_circ_clip_dtm_idw <- grid_terrain(GRSM_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_032_circ_clip_dtm_idw <- grid_terrain(GRSM_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_033_circ_clip_dtm_idw <- grid_terrain(GRSM_033_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_034_circ_clip_dtm_idw <- grid_terrain(GRSM_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
GRSM_035_circ_clip_dtm_idw <- grid_terrain(GRSM_035_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
GRSM_001_rec_clip_normalized <- filter_poi(normalize_height(GRSM_001_circ_clip,GRSM_001_circ_clip_dtm_idw),Z >= 0)
GRSM_002_rec_clip_normalized <- filter_poi(normalize_height(GRSM_002_circ_clip,GRSM_002_circ_clip_dtm_idw),Z >= 0)
GRSM_003_rec_clip_normalized <- filter_poi(normalize_height(GRSM_003_circ_clip,GRSM_003_circ_clip_dtm_idw),Z >= 0)
GRSM_004_rec_clip_normalized <- filter_poi(normalize_height(GRSM_004_circ_clip,GRSM_004_circ_clip_dtm_idw),Z >= 0)
GRSM_006_rec_clip_normalized <- filter_poi(normalize_height(GRSM_006_circ_clip,GRSM_006_circ_clip_dtm_idw),Z >= 0)
GRSM_007_rec_clip_normalized <- filter_poi(normalize_height(GRSM_007_circ_clip,GRSM_007_circ_clip_dtm_idw),Z >= 0)
GRSM_010_rec_clip_normalized <- filter_poi(normalize_height(GRSM_010_circ_clip,GRSM_010_circ_clip_dtm_idw),Z >= 0)
GRSM_013_rec_clip_normalized <- filter_poi(normalize_height(GRSM_013_circ_clip,GRSM_013_circ_clip_dtm_idw),Z >= 0)
GRSM_015_rec_clip_normalized <- filter_poi(normalize_height(GRSM_015_circ_clip,GRSM_015_circ_clip_dtm_idw),Z >= 0)
GRSM_020_rec_clip_normalized <- filter_poi(normalize_height(GRSM_020_circ_clip,GRSM_020_circ_clip_dtm_idw),Z >= 0)
GRSM_031_rec_clip_normalized <- filter_poi(normalize_height(GRSM_031_circ_clip,GRSM_031_circ_clip_dtm_idw),Z >= 0)
GRSM_032_rec_clip_normalized <- filter_poi(normalize_height(GRSM_032_circ_clip,GRSM_032_circ_clip_dtm_idw),Z >= 0)
GRSM_033_rec_clip_normalized <- filter_poi(normalize_height(GRSM_033_circ_clip,GRSM_033_circ_clip_dtm_idw),Z >= 0)
GRSM_034_rec_clip_normalized <- filter_poi(normalize_height(GRSM_034_circ_clip,GRSM_034_circ_clip_dtm_idw),Z >= 0)
GRSM_035_rec_clip_normalized <- filter_poi(normalize_height(GRSM_035_circ_clip,GRSM_035_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(GRSM_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_001_rec_clip_normalized.laz")
writeLAS(GRSM_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_002_rec_clip_normalized.laz")
writeLAS(GRSM_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_003_rec_clip_normalized.laz")
writeLAS(GRSM_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_004_rec_clip_normalized.laz")
writeLAS(GRSM_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_006_rec_clip_normalized.laz")
writeLAS(GRSM_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_007_rec_clip_normalized.laz")
writeLAS(GRSM_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_010_rec_clip_normalized.laz")
writeLAS(GRSM_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_013_rec_clip_normalized.laz")
writeLAS(GRSM_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_015_rec_clip_normalized.laz")
writeLAS(GRSM_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_020_rec_clip_normalized.laz")
writeLAS(GRSM_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_031_rec_clip_normalized.laz")
writeLAS(GRSM_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_032_rec_clip_normalized.laz")
writeLAS(GRSM_033_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_033_rec_clip_normalized.laz")
writeLAS(GRSM_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_034_rec_clip_normalized.laz")
writeLAS(GRSM_035_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D07_GRSM/HtNorm_250_radius/GRSM_035_rec_clip_normalized.laz")

# Domain 8: DELA #################### - point
ctg_DELA <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/DP1.30003.001/neon-aop-products/2017/FullSite/D08/2017_DELA_3/L1/DiscreteLidar/ClassifiedPointCloud") 
DELA_001_circ_clip <- clip_circle(ctg_DELA,424363.53538865,3599700.25169161,radius=250)
DELA_002_circ_clip <- clip_circle(ctg_DELA,423134.132914023,3599754.74314726,radius=250)
DELA_003_circ_clip <- clip_circle(ctg_DELA,423465.843986613,3600025.25580245,radius=250)
DELA_004_circ_clip <- clip_circle(ctg_DELA,423527.56797576,3599696.62908031,radius=250)
DELA_005_circ_clip <- clip_circle(ctg_DELA,423493.39780854,3598740.47547614,radius=250)
DELA_006_circ_clip <- clip_circle(ctg_DELA,424515.049188655,3599903.20571127,radius=250)
DELA_007_circ_clip <- clip_circle(ctg_DELA,424785.361178533,3600356.81555845,radius=250)
DELA_008_circ_clip <- clip_circle(ctg_DELA,423557.153178645,3600593.95065549,radius=250)
DELA_010_circ_clip <- clip_circle(ctg_DELA,424872.933240825,3600625.88655115,radius=250)
DELA_011_circ_clip <- clip_circle(ctg_DELA,423255.836197234,3598406.26881775,radius=250)
DELA_013_circ_clip <- clip_circle(ctg_DELA,423256.088775325,3600655.34641185,radius=250)
DELA_014_circ_clip <- clip_circle(ctg_DELA,423163.771980786,3599456.29364529,radius=250)
DELA_015_circ_clip <- clip_circle(ctg_DELA,423614.132495662,3599336.54997881,radius=250)
DELA_016_circ_clip <- clip_circle(ctg_DELA,424125.42753832,3600116.90364901,radius=250)
DELA_021_circ_clip <- clip_circle(ctg_DELA,423073.990316059,3599126.94406151,radius=250)
DELA_026_circ_clip <- clip_circle(ctg_DELA,423824.977718954,3599965.30926594,radius=250)
DELA_027_circ_clip <- clip_circle(ctg_DELA,423945.667409582,3600411.50142923,radius=250)
DELA_029_circ_clip <- clip_circle(ctg_DELA,423884.655693225,3599452.5573813,radius=250)
DELA_060_circ_clip <- clip_circle(ctg_DELA,422952.769321131,3598374.56224088,radius=250)
#
hist(DELA_001_circ_clip@data$Z, breaks=100)
hist(DELA_002_circ_clip@data$Z, breaks=100)
hist(DELA_003_circ_clip@data$Z, breaks=100)
hist(DELA_004_circ_clip@data$Z, breaks=100)
hist(DELA_005_circ_clip@data$Z, breaks=100)
hist(DELA_006_circ_clip@data$Z, breaks=100)
hist(DELA_007_circ_clip@data$Z, breaks=100)
hist(DELA_008_circ_clip@data$Z, breaks=100)
hist(DELA_010_circ_clip@data$Z, breaks=100)
hist(DELA_011_circ_clip@data$Z, breaks=100)
hist(DELA_013_circ_clip@data$Z, breaks=100)
hist(DELA_014_circ_clip@data$Z, breaks=100)
hist(DELA_015_circ_clip@data$Z, breaks=100)
hist(DELA_016_circ_clip@data$Z, breaks=100)
hist(DELA_021_circ_clip@data$Z, breaks=100)
hist(DELA_026_circ_clip@data$Z, breaks=100)
hist(DELA_027_circ_clip@data$Z, breaks=100)
hist(DELA_029_circ_clip@data$Z, breaks=100)
hist(DELA_060_circ_clip@data$Z, breaks=100)
DELA_001_circ_clip <- filter_poi(DELA_001_circ_clip, Z >= 0, Z<= 150)
DELA_002_circ_clip <- filter_poi(DELA_002_circ_clip, Z >= 0, Z<= 600)
DELA_003_circ_clip <- filter_poi(DELA_003_circ_clip, Z >= 0, Z<= 100)
DELA_004_circ_clip <- filter_poi(DELA_004_circ_clip, Z >= 0, Z<= 100)
DELA_005_circ_clip <- filter_poi(DELA_005_circ_clip, Z >= 0, Z<= 200)
DELA_006_circ_clip <- filter_poi(DELA_006_circ_clip, Z >= 0, Z<= 100)
DELA_007_circ_clip <- filter_poi(DELA_007_circ_clip, Z >= 0, Z<= 150)
DELA_008_circ_clip <- filter_poi(DELA_008_circ_clip, Z >= 0, Z<= 150)
DELA_010_circ_clip <- filter_poi(DELA_010_circ_clip, Z >= 0, Z<= 100)
DELA_011_circ_clip <- filter_poi(DELA_011_circ_clip, Z >= 0, Z<= 150)
DELA_013_circ_clip <- filter_poi(DELA_013_circ_clip, Z >= 0, Z<= 65)
DELA_014_circ_clip <- filter_poi(DELA_014_circ_clip, Z >= 0, Z<= 70)
DELA_015_circ_clip <- filter_poi(DELA_015_circ_clip, Z >= 0, Z<= 200)
DELA_016_circ_clip <- filter_poi(DELA_016_circ_clip, Z >= 0, Z<= 150)
DELA_021_circ_clip <- filter_poi(DELA_021_circ_clip, Z >= 0, Z<= 150)
DELA_026_circ_clip <- filter_poi(DELA_026_circ_clip, Z >= 0, Z<= 600)
DELA_027_circ_clip <- filter_poi(DELA_027_circ_clip, Z >= 0, Z<= 65)
DELA_029_circ_clip <- filter_poi(DELA_029_circ_clip, Z >= 0, Z<= 65)
DELA_060_circ_clip <- filter_poi(DELA_060_circ_clip, Z >= 0, Z<= 600)
#
DELA_001_circ_clip_dtm_idw <- grid_terrain(DELA_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_002_circ_clip_dtm_idw <- grid_terrain(DELA_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_003_circ_clip_dtm_idw <- grid_terrain(DELA_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_004_circ_clip_dtm_idw <- grid_terrain(DELA_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_005_circ_clip_dtm_idw <- grid_terrain(DELA_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_006_circ_clip_dtm_idw <- grid_terrain(DELA_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_007_circ_clip_dtm_idw <- grid_terrain(DELA_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_008_circ_clip_dtm_idw <- grid_terrain(DELA_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_010_circ_clip_dtm_idw <- grid_terrain(DELA_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_011_circ_clip_dtm_idw <- grid_terrain(DELA_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_013_circ_clip_dtm_idw <- grid_terrain(DELA_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_014_circ_clip_dtm_idw <- grid_terrain(DELA_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_015_circ_clip_dtm_idw <- grid_terrain(DELA_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_016_circ_clip_dtm_idw <- grid_terrain(DELA_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_021_circ_clip_dtm_idw <- grid_terrain(DELA_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_026_circ_clip_dtm_idw <- grid_terrain(DELA_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_027_circ_clip_dtm_idw <- grid_terrain(DELA_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_029_circ_clip_dtm_idw <- grid_terrain(DELA_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DELA_060_circ_clip_dtm_idw <- grid_terrain(DELA_060_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
DELA_001_rec_clip_normalized <- filter_poi(normalize_height(DELA_001_circ_clip,DELA_001_circ_clip_dtm_idw),Z >= 0)
DELA_002_rec_clip_normalized <- filter_poi(normalize_height(DELA_002_circ_clip,DELA_002_circ_clip_dtm_idw),Z >= 0)
DELA_003_rec_clip_normalized <- filter_poi(normalize_height(DELA_003_circ_clip,DELA_003_circ_clip_dtm_idw),Z >= 0)
DELA_004_rec_clip_normalized <- filter_poi(normalize_height(DELA_004_circ_clip,DELA_004_circ_clip_dtm_idw),Z >= 0)
DELA_005_rec_clip_normalized <- filter_poi(normalize_height(DELA_005_circ_clip,DELA_005_circ_clip_dtm_idw),Z >= 0)
DELA_006_rec_clip_normalized <- filter_poi(normalize_height(DELA_006_circ_clip,DELA_006_circ_clip_dtm_idw),Z >= 0)
DELA_007_rec_clip_normalized <- filter_poi(normalize_height(DELA_007_circ_clip,DELA_007_circ_clip_dtm_idw),Z >= 0)
DELA_008_rec_clip_normalized <- filter_poi(normalize_height(DELA_008_circ_clip,DELA_008_circ_clip_dtm_idw),Z >= 0)
DELA_010_rec_clip_normalized <- filter_poi(normalize_height(DELA_010_circ_clip,DELA_010_circ_clip_dtm_idw),Z >= 0)
DELA_011_rec_clip_normalized <- filter_poi(normalize_height(DELA_011_circ_clip,DELA_011_circ_clip_dtm_idw,na.rm = TRUE),Z >= 0)
DELA_013_rec_clip_normalized <- filter_poi(normalize_height(DELA_013_circ_clip,DELA_013_circ_clip_dtm_idw),Z >= 0)
DELA_014_rec_clip_normalized <- filter_poi(normalize_height(DELA_014_circ_clip,DELA_014_circ_clip_dtm_idw),Z >= 0)
DELA_015_rec_clip_normalized <- filter_poi(normalize_height(DELA_015_circ_clip,DELA_015_circ_clip_dtm_idw),Z >= 0)
DELA_016_rec_clip_normalized <- filter_poi(normalize_height(DELA_016_circ_clip,DELA_016_circ_clip_dtm_idw),Z >= 0)
DELA_021_rec_clip_normalized <- filter_poi(normalize_height(DELA_021_circ_clip,DELA_021_circ_clip_dtm_idw),Z >= 0)
DELA_026_rec_clip_normalized <- filter_poi(normalize_height(DELA_026_circ_clip,DELA_026_circ_clip_dtm_idw),Z >= 0)
DELA_027_rec_clip_normalized <- filter_poi(normalize_height(DELA_027_circ_clip,DELA_027_circ_clip_dtm_idw),Z >= 0)
DELA_029_rec_clip_normalized <- filter_poi(normalize_height(DELA_029_circ_clip,DELA_029_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
DELA_060_rec_clip_normalized <- filter_poi(normalize_height(DELA_060_circ_clip,DELA_060_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
#
writeLAS(DELA_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_001_rec_clip_normalized.laz")
writeLAS(DELA_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_002_rec_clip_normalized.laz")
writeLAS(DELA_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_003_rec_clip_normalized.laz")
writeLAS(DELA_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_004_rec_clip_normalized.laz")
writeLAS(DELA_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_005_rec_clip_normalized.laz")
writeLAS(DELA_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_006_rec_clip_normalized.laz")
writeLAS(DELA_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_007_rec_clip_normalized.laz")
writeLAS(DELA_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_008_rec_clip_normalized.laz")
writeLAS(DELA_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_010_rec_clip_normalized.laz")
writeLAS(DELA_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_011_rec_clip_normalized.laz")
writeLAS(DELA_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_013_rec_clip_normalized.laz")
writeLAS(DELA_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_014_rec_clip_normalized.laz")
writeLAS(DELA_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_015_rec_clip_normalized.laz")
writeLAS(DELA_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_016_rec_clip_normalized.laz")
writeLAS(DELA_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_021_rec_clip_normalized.laz")
writeLAS(DELA_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_026_rec_clip_normalized.laz")
writeLAS(DELA_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_027_rec_clip_normalized.laz")
writeLAS(DELA_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_029_rec_clip_normalized.laz")
writeLAS(DELA_060_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_DELA/HtNorm_250_radius/DELA_060_rec_clip_normalized.laz")

# Domain 8: LENO #################### - point
ctg_LENO <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/DP1.30003.001/neon-aop-products/2017/FullSite/D08/2017_LENO_3/L1/DiscreteLidar/ClassifiedPointCloud")
LENO_001_circ_clip <- clip_circle(ctg_LENO,388552.528054949,3521603.29417853,radius=250)
LENO_002_circ_clip <- clip_circle(ctg_LENO,386991.544829991,3519653.83855715,radius=250)
LENO_003_circ_clip <- clip_circle(ctg_LENO,387530.362793151,3519804.02938614,radius=250)
LENO_004_circ_clip <- clip_circle(ctg_LENO,388103.878016241,3521213.16220269,radius=250)
LENO_005_circ_clip <- clip_circle(ctg_LENO,388190.98371448,3521963.5335126,radius=250)
LENO_006_circ_clip <- clip_circle(ctg_LENO,387618.307966877,3520462.14912776,radius=250)
LENO_007_circ_clip <- clip_circle(ctg_LENO,386207.99343348,3520284.19816625,radius=250)
LENO_009_circ_clip <- clip_circle(ctg_LENO,388187.513552488,3520164.37634049,radius=250)
LENO_010_circ_clip <- clip_circle(ctg_LENO,387771.30525254,3519891.08627166,radius=250)
LENO_011_circ_clip <- clip_circle(ctg_LENO,388041.230638119,3521753.6364824,radius=250)
LENO_012_circ_clip <- clip_circle(ctg_LENO,388310.88569572,3519773.79701689,radius=250)
LENO_013_circ_clip <- clip_circle(ctg_LENO,386481.27613724,3520942.47998204,radius=250)
LENO_014_circ_clip <- clip_circle(ctg_LENO,386509.377444892,3520074.77318223,radius=250)
LENO_015_circ_clip <- clip_circle(ctg_LENO,387228.896848242,3520647.45104311,radius=250)
LENO_016_circ_clip <- clip_circle(ctg_LENO,387890.401305254,3520855.18245728,radius=250)
LENO_017_circ_clip <- clip_circle(ctg_LENO,389450.769283451,3523492.34156534,radius=250)
LENO_019_circ_clip <- clip_circle(ctg_LENO,386930.014405078,3520972.12571607,radius=250)
LENO_020_circ_clip <- clip_circle(ctg_LENO,387144.021224525,3521634.17948454,radius=250)
LENO_021_circ_clip <- clip_circle(ctg_LENO,389269.329969122,3522682.4468711,radius=250)
LENO_022_circ_clip <- clip_circle(ctg_LENO,386030.819532031,3520612.87524821,radius=250)
LENO_025_circ_clip <- clip_circle(ctg_LENO,386931.394622225,3520675.77254012,radius=250)
LENO_026_circ_clip <- clip_circle(ctg_LENO,387770.20189163,3521663.68818877,radius=250)
LENO_027_circ_clip <- clip_circle(ctg_LENO,386213.33130298,3520886.46169469,radius=250)
LENO_029_circ_clip <- clip_circle(ctg_LENO,389183.455577975,3522293.24637079,radius=250)
LENO_030_circ_clip <- clip_circle(ctg_LENO,387351.112919293,3520077.38349565,radius=250)
#
hist(LENO_001_circ_clip@data$Z, breaks=100)
hist(LENO_002_circ_clip@data$Z, breaks=100)
hist(LENO_003_circ_clip@data$Z, breaks=100)
hist(LENO_004_circ_clip@data$Z, breaks=100)
hist(LENO_005_circ_clip@data$Z, breaks=100)
hist(LENO_006_circ_clip@data$Z, breaks=100)
hist(LENO_007_circ_clip@data$Z, breaks=100)
hist(LENO_009_circ_clip@data$Z, breaks=100)
hist(LENO_010_circ_clip@data$Z, breaks=100)
hist(LENO_011_circ_clip@data$Z, breaks=100)
hist(LENO_012_circ_clip@data$Z, breaks=100)
hist(LENO_013_circ_clip@data$Z, breaks=100)
hist(LENO_014_circ_clip@data$Z, breaks=100)
hist(LENO_015_circ_clip@data$Z, breaks=100)
hist(LENO_016_circ_clip@data$Z, breaks=100)
hist(LENO_017_circ_clip@data$Z, breaks=100)
hist(LENO_019_circ_clip@data$Z, breaks=100)
hist(LENO_020_circ_clip@data$Z, breaks=100)
hist(LENO_021_circ_clip@data$Z, breaks=100)
hist(LENO_022_circ_clip@data$Z, breaks=100)
hist(LENO_025_circ_clip@data$Z, breaks=100)
hist(LENO_026_circ_clip@data$Z, breaks=100)
hist(LENO_027_circ_clip@data$Z, breaks=100)
hist(LENO_029_circ_clip@data$Z, breaks=100)
hist(LENO_030_circ_clip@data$Z, breaks=100)
LENO_001_circ_clip <- filter_poi(LENO_001_circ_clip, Z >= 0, Z<= 100)
LENO_002_circ_clip <- filter_poi(LENO_002_circ_clip, Z >= 0, Z<= 70)
LENO_003_circ_clip <- filter_poi(LENO_003_circ_clip, Z >= 0, Z<= 200)
LENO_004_circ_clip <- filter_poi(LENO_004_circ_clip, Z >= 0, Z<= 57)
LENO_005_circ_clip <- filter_poi(LENO_005_circ_clip, Z >= 0, Z<= 100)
LENO_006_circ_clip <- filter_poi(LENO_006_circ_clip, Z >= 0, Z<= 100)
LENO_007_circ_clip <- filter_poi(LENO_007_circ_clip, Z >= 0, Z<= 55)
LENO_009_circ_clip <- filter_poi(LENO_009_circ_clip, Z >= 0, Z<= 65)
LENO_010_circ_clip <- filter_poi(LENO_010_circ_clip, Z >= 0, Z<= 150)
LENO_011_circ_clip <- filter_poi(LENO_011_circ_clip, Z >= 0, Z<= 100)
LENO_012_circ_clip <- filter_poi(LENO_012_circ_clip, Z >= 0, Z<= 65)
LENO_013_circ_clip <- filter_poi(LENO_013_circ_clip, Z >= 0, Z<= 70)
LENO_014_circ_clip <- filter_poi(LENO_014_circ_clip, Z >= 0, Z<= 70)
LENO_015_circ_clip <- filter_poi(LENO_015_circ_clip, Z >= 0, Z<= 150)
LENO_016_circ_clip <- filter_poi(LENO_016_circ_clip, Z >= 0, Z<= 70)
LENO_017_circ_clip <- filter_poi(LENO_017_circ_clip, Z >= 0, Z<= 150)
LENO_019_circ_clip <- filter_poi(LENO_019_circ_clip, Z >= 0, Z<= 70)
LENO_020_circ_clip <- filter_poi(LENO_020_circ_clip, Z >= 0, Z<= 100)
LENO_021_circ_clip <- filter_poi(LENO_021_circ_clip, Z >= 0, Z<= 100)
LENO_022_circ_clip <- filter_poi(LENO_022_circ_clip, Z >= 0, Z<= 60)
LENO_025_circ_clip <- filter_poi(LENO_025_circ_clip, Z >= 0, Z<= 70)
LENO_026_circ_clip <- filter_poi(LENO_026_circ_clip, Z >= 0, Z<= 80)
LENO_027_circ_clip <- filter_poi(LENO_027_circ_clip, Z >= 0, Z<= 60)
LENO_029_circ_clip <- filter_poi(LENO_029_circ_clip, Z >= 0, Z<= 600)
LENO_030_circ_clip <- filter_poi(LENO_030_circ_clip, Z >= 0, Z<= 600)
#
LENO_001_circ_clip_dtm_idw <- grid_terrain(LENO_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_002_circ_clip_dtm_idw <- grid_terrain(LENO_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_003_circ_clip_dtm_idw <- grid_terrain(LENO_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_004_circ_clip_dtm_idw <- grid_terrain(LENO_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_005_circ_clip_dtm_idw <- grid_terrain(LENO_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_006_circ_clip_dtm_idw <- grid_terrain(LENO_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_007_circ_clip_dtm_idw <- grid_terrain(LENO_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_009_circ_clip_dtm_idw <- grid_terrain(LENO_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_010_circ_clip_dtm_idw <- grid_terrain(LENO_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_011_circ_clip_dtm_idw <- grid_terrain(LENO_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_012_circ_clip_dtm_idw <- grid_terrain(LENO_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_013_circ_clip_dtm_idw <- grid_terrain(LENO_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_014_circ_clip_dtm_idw <- grid_terrain(LENO_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_015_circ_clip_dtm_idw <- grid_terrain(LENO_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_016_circ_clip_dtm_idw <- grid_terrain(LENO_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_017_circ_clip_dtm_idw <- grid_terrain(LENO_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_019_circ_clip_dtm_idw <- grid_terrain(LENO_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_020_circ_clip_dtm_idw <- grid_terrain(LENO_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_021_circ_clip_dtm_idw <- grid_terrain(LENO_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_022_circ_clip_dtm_idw <- grid_terrain(LENO_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_025_circ_clip_dtm_idw <- grid_terrain(LENO_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_026_circ_clip_dtm_idw <- grid_terrain(LENO_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_027_circ_clip_dtm_idw <- grid_terrain(LENO_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_029_circ_clip_dtm_idw <- grid_terrain(LENO_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
LENO_030_circ_clip_dtm_idw <- grid_terrain(LENO_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
LENO_001_rec_clip_normalized <- filter_poi(normalize_height(LENO_001_circ_clip,LENO_001_circ_clip_dtm_idw),Z >= 0)
LENO_002_rec_clip_normalized <- filter_poi(normalize_height(LENO_002_circ_clip,LENO_002_circ_clip_dtm_idw),Z >= 0)
LENO_003_rec_clip_normalized <- filter_poi(normalize_height(LENO_003_circ_clip,LENO_003_circ_clip_dtm_idw),Z >= 0)
LENO_004_rec_clip_normalized <- filter_poi(normalize_height(LENO_004_circ_clip,LENO_004_circ_clip_dtm_idw),Z >= 0)
LENO_005_rec_clip_normalized <- filter_poi(normalize_height(LENO_005_circ_clip,LENO_005_circ_clip_dtm_idw),Z >= 0)
LENO_006_rec_clip_normalized <- filter_poi(normalize_height(LENO_006_circ_clip,LENO_006_circ_clip_dtm_idw),Z >= 0)
LENO_007_rec_clip_normalized <- filter_poi(normalize_height(LENO_007_circ_clip,LENO_007_circ_clip_dtm_idw),Z >= 0)
LENO_009_rec_clip_normalized <- filter_poi(normalize_height(LENO_009_circ_clip,LENO_009_circ_clip_dtm_idw),Z >= 0)
LENO_010_rec_clip_normalized <- filter_poi(normalize_height(LENO_010_circ_clip,LENO_010_circ_clip_dtm_idw),Z >= 0)
LENO_011_rec_clip_normalized <- filter_poi(normalize_height(LENO_011_circ_clip,LENO_011_circ_clip_dtm_idw),Z >= 0)
LENO_012_rec_clip_normalized <- filter_poi(normalize_height(LENO_012_circ_clip,LENO_012_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
LENO_013_rec_clip_normalized <- filter_poi(normalize_height(LENO_013_circ_clip,LENO_013_circ_clip_dtm_idw),Z >= 0)
LENO_014_rec_clip_normalized <- filter_poi(normalize_height(LENO_014_circ_clip,LENO_014_circ_clip_dtm_idw),Z >= 0)
LENO_015_rec_clip_normalized <- filter_poi(normalize_height(LENO_015_circ_clip,LENO_015_circ_clip_dtm_idw),Z >= 0)
LENO_016_rec_clip_normalized <- filter_poi(normalize_height(LENO_016_circ_clip,LENO_016_circ_clip_dtm_idw),Z >= 0)
LENO_017_rec_clip_normalized <- filter_poi(normalize_height(LENO_017_circ_clip,LENO_017_circ_clip_dtm_idw),Z >= 0)
LENO_019_rec_clip_normalized <- filter_poi(normalize_height(LENO_019_circ_clip,LENO_019_circ_clip_dtm_idw),Z >= 0)
LENO_020_rec_clip_normalized <- filter_poi(normalize_height(LENO_020_circ_clip,LENO_020_circ_clip_dtm_idw),Z >= 0)
LENO_021_rec_clip_normalized <- filter_poi(normalize_height(LENO_021_circ_clip,LENO_021_circ_clip_dtm_idw),Z >= 0)
LENO_022_rec_clip_normalized <- filter_poi(normalize_height(LENO_022_circ_clip,LENO_022_circ_clip_dtm_idw),Z >= 0)
LENO_025_rec_clip_normalized <- filter_poi(normalize_height(LENO_025_circ_clip,LENO_025_circ_clip_dtm_idw),Z >= 0)
LENO_026_rec_clip_normalized <- filter_poi(normalize_height(LENO_026_circ_clip,LENO_026_circ_clip_dtm_idw),Z >= 0)
LENO_027_rec_clip_normalized <- filter_poi(normalize_height(LENO_027_circ_clip,LENO_027_circ_clip_dtm_idw),Z >= 0)
LENO_029_rec_clip_normalized <- filter_poi(normalize_height(LENO_029_circ_clip,LENO_029_circ_clip_dtm_idw, na.rm = TRUE),Z >= 0)
LENO_030_rec_clip_normalized <- filter_poi(normalize_height(LENO_030_circ_clip,LENO_030_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(LENO_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_001_rec_clip_normalized.laz")
writeLAS(LENO_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_002_rec_clip_normalized.laz")
writeLAS(LENO_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_003_rec_clip_normalized.laz")
writeLAS(LENO_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_004_rec_clip_normalized.laz")
writeLAS(LENO_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_005_rec_clip_normalized.laz")
writeLAS(LENO_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_006_rec_clip_normalized.laz")
writeLAS(LENO_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_007_rec_clip_normalized.laz")
writeLAS(LENO_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_009_rec_clip_normalized.laz")
writeLAS(LENO_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_010_rec_clip_normalized.laz")
writeLAS(LENO_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_011_rec_clip_normalized.laz")
writeLAS(LENO_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_012_rec_clip_normalized.laz")
writeLAS(LENO_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_013_rec_clip_normalized.laz")
writeLAS(LENO_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_014_rec_clip_normalized.laz")
writeLAS(LENO_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_015_rec_clip_normalized.laz")
writeLAS(LENO_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_016_rec_clip_normalized.laz")
writeLAS(LENO_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_017_rec_clip_normalized.laz")
writeLAS(LENO_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_019_rec_clip_normalized.laz")
writeLAS(LENO_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_020_rec_clip_normalized.laz")
writeLAS(LENO_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_021_rec_clip_normalized.laz")
writeLAS(LENO_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_022_rec_clip_normalized.laz")
writeLAS(LENO_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_025_rec_clip_normalized.laz")
writeLAS(LENO_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_026_rec_clip_normalized.laz")
writeLAS(LENO_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_027_rec_clip_normalized.laz")
writeLAS(LENO_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_029_rec_clip_normalized.laz")
writeLAS(LENO_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D08_LENO/HtNorm_250_radius/LENO_030_rec_clip_normalized.laz")

# Domain 9: DCFS #################### - point
ctg_DCFS <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/DP1.30003.001/neon-aop-products/2017/FullSite/D09/2017_WOOD_2/L1/DiscreteLidar/ClassifiedPointCloud") 
DCFS_001_circ_clip <- clip_circle(ctg_DCFS,487367.437738551,5228274.75325765,radius=250)
DCFS_003_circ_clip <- clip_circle(ctg_DCFS,486049.748599172,5228092.23764228,radius=250)
DCFS_004_circ_clip <- clip_circle(ctg_DCFS,496114.815024601,5224231.06808885,radius=250)
DCFS_005_circ_clip <- clip_circle(ctg_DCFS,487396.795440386,5227196.49959154,radius=250)
DCFS_007_circ_clip <- clip_circle(ctg_DCFS,491231.381056071,5223332.13424045,radius=250)
DCFS_009_circ_clip <- clip_circle(ctg_DCFS,485988.941999314,5228574.57888044,radius=250)
DCFS_010_circ_clip <- clip_circle(ctg_DCFS,486977.879033297,5228515.19668323,radius=250)
DCFS_011_circ_clip <- clip_circle(ctg_DCFS,486827.288115102,5227645.26417306,radius=250)
DCFS_012_circ_clip <- clip_circle(ctg_DCFS,495545.816148403,5223991.98420673,radius=250)
DCFS_013_circ_clip <- clip_circle(ctg_DCFS,487006.888789013,5228035.49179386,radius=250)
DCFS_014_circ_clip <- clip_circle(ctg_DCFS,495635.535604079,5218419.23036251,radius=250)
DCFS_015_circ_clip <- clip_circle(ctg_DCFS,491562.091859983,5222284.36772307,radius=250)
DCFS_016_circ_clip <- clip_circle(ctg_DCFS,491351.374932609,5222614.05981429,radius=250)
DCFS_017_circ_clip <- clip_circle(ctg_DCFS,491801.434094164,5222462.83915977,radius=250)
DCFS_018_circ_clip <- clip_circle(ctg_DCFS,487397.735607531,5227886.50851117,radius=250)
DCFS_019_circ_clip <- clip_circle(ctg_DCFS,486767.368630231,5227166.75762791,radius=250)
DCFS_024_circ_clip <- clip_circle(ctg_DCFS,495965.492141183,5223960.90043032,radius=250)
DCFS_027_circ_clip <- clip_circle(ctg_DCFS,486708.494084825,5228033.71009264,radius=250)
DCFS_028_circ_clip <- clip_circle(ctg_DCFS,495843.717558692,5224410.50454204,radius=250)
DCFS_030_circ_clip <- clip_circle(ctg_DCFS,495725.706940461,5224170.43711055,radius=250)
#
hist(DCFS_001_circ_clip@data$Z, breaks=100)
hist(DCFS_003_circ_clip@data$Z, breaks=100)
hist(DCFS_004_circ_clip@data$Z, breaks=100)
hist(DCFS_005_circ_clip@data$Z, breaks=100)
hist(DCFS_007_circ_clip@data$Z, breaks=100)
hist(DCFS_009_circ_clip@data$Z, breaks=100)
hist(DCFS_010_circ_clip@data$Z, breaks=100)
hist(DCFS_011_circ_clip@data$Z, breaks=100)
hist(DCFS_012_circ_clip@data$Z, breaks=100)
hist(DCFS_013_circ_clip@data$Z, breaks=100)
hist(DCFS_014_circ_clip@data$Z, breaks=100)
hist(DCFS_015_circ_clip@data$Z, breaks=100)
hist(DCFS_016_circ_clip@data$Z, breaks=100)
hist(DCFS_017_circ_clip@data$Z, breaks=100)
hist(DCFS_018_circ_clip@data$Z, breaks=100)
hist(DCFS_019_circ_clip@data$Z, breaks=100)
hist(DCFS_024_circ_clip@data$Z, breaks=100)
hist(DCFS_027_circ_clip@data$Z, breaks=100)
hist(DCFS_028_circ_clip@data$Z, breaks=100)
hist(DCFS_030_circ_clip@data$Z, breaks=100)
DCFS_001_circ_clip <- filter_poi(DCFS_001_circ_clip, Z >= 100, Z<= 700)
DCFS_003_circ_clip <- filter_poi(DCFS_003_circ_clip, Z >= 500, Z<= 700)
DCFS_004_circ_clip <- filter_poi(DCFS_004_circ_clip, Z >= 450, Z<= 540)
DCFS_005_circ_clip <- filter_poi(DCFS_005_circ_clip, Z >= 400, Z<= 577)
DCFS_007_circ_clip <- filter_poi(DCFS_007_circ_clip, Z >= 100, Z<= 600)
DCFS_009_circ_clip <- filter_poi(DCFS_009_circ_clip, Z >= 400, Z<= 700)
DCFS_010_circ_clip <- filter_poi(DCFS_010_circ_clip, Z >= 550, Z<= 700)
DCFS_011_circ_clip <- filter_poi(DCFS_011_circ_clip, Z >= 400, Z<= 700)
DCFS_012_circ_clip <- filter_poi(DCFS_012_circ_clip, Z >= 400, Z<= 534)
DCFS_013_circ_clip <- filter_poi(DCFS_013_circ_clip, Z >= 400, Z<= 700)
DCFS_014_circ_clip <- filter_poi(DCFS_014_circ_clip, Z >= 500, Z<= 600)
DCFS_015_circ_clip <- filter_poi(DCFS_015_circ_clip, Z >= 500, Z<= 670)
DCFS_016_circ_clip <- filter_poi(DCFS_016_circ_clip, Z >= 400, Z<= 600)
DCFS_017_circ_clip <- filter_poi(DCFS_017_circ_clip, Z >= 500, Z<= 587)
DCFS_018_circ_clip <- filter_poi(DCFS_018_circ_clip, Z >= 100, Z<= 600)
DCFS_019_circ_clip <- filter_poi(DCFS_019_circ_clip, Z >= 400, Z<= 700)
DCFS_024_circ_clip <- filter_poi(DCFS_024_circ_clip, Z >= 500, Z<= 560)
DCFS_027_circ_clip <- filter_poi(DCFS_027_circ_clip, Z >= 100, Z<= 700)
DCFS_028_circ_clip <- filter_poi(DCFS_028_circ_clip, Z >= 400, Z<= 520)
DCFS_030_circ_clip <- filter_poi(DCFS_030_circ_clip, Z >= 400, Z<= 525)
#
DCFS_001_circ_clip_dtm_idw <- grid_terrain(DCFS_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_003_circ_clip_dtm_idw <- grid_terrain(DCFS_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_004_circ_clip_dtm_idw <- grid_terrain(DCFS_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_005_circ_clip_dtm_idw <- grid_terrain(DCFS_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_007_circ_clip_dtm_idw <- grid_terrain(DCFS_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_009_circ_clip_dtm_idw <- grid_terrain(DCFS_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_010_circ_clip_dtm_idw <- grid_terrain(DCFS_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_011_circ_clip_dtm_idw <- grid_terrain(DCFS_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_012_circ_clip_dtm_idw <- grid_terrain(DCFS_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_013_circ_clip_dtm_idw <- grid_terrain(DCFS_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_014_circ_clip_dtm_idw <- grid_terrain(DCFS_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_015_circ_clip_dtm_idw <- grid_terrain(DCFS_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_016_circ_clip_dtm_idw <- grid_terrain(DCFS_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_017_circ_clip_dtm_idw <- grid_terrain(DCFS_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_018_circ_clip_dtm_idw <- grid_terrain(DCFS_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_019_circ_clip_dtm_idw <- grid_terrain(DCFS_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_024_circ_clip_dtm_idw <- grid_terrain(DCFS_024_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_027_circ_clip_dtm_idw <- grid_terrain(DCFS_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_028_circ_clip_dtm_idw <- grid_terrain(DCFS_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DCFS_030_circ_clip_dtm_idw <- grid_terrain(DCFS_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
DCFS_001_rec_clip_normalized <- filter_poi(normalize_height(DCFS_001_circ_clip,DCFS_001_circ_clip_dtm_idw),Z >= 0)
DCFS_003_rec_clip_normalized <- filter_poi(normalize_height(DCFS_003_circ_clip,DCFS_003_circ_clip_dtm_idw),Z >= 0)
DCFS_004_rec_clip_normalized <- filter_poi(normalize_height(DCFS_004_circ_clip,DCFS_004_circ_clip_dtm_idw),Z >= 0)
DCFS_005_rec_clip_normalized <- filter_poi(normalize_height(DCFS_005_circ_clip,DCFS_005_circ_clip_dtm_idw),Z >= 0)
DCFS_007_rec_clip_normalized <- filter_poi(normalize_height(DCFS_007_circ_clip,DCFS_007_circ_clip_dtm_idw),Z >= 0)
DCFS_009_rec_clip_normalized <- filter_poi(normalize_height(DCFS_009_circ_clip,DCFS_009_circ_clip_dtm_idw),Z >= 0)
DCFS_010_rec_clip_normalized <- filter_poi(normalize_height(DCFS_010_circ_clip,DCFS_010_circ_clip_dtm_idw),Z >= 0)
DCFS_011_rec_clip_normalized <- filter_poi(normalize_height(DCFS_011_circ_clip,DCFS_011_circ_clip_dtm_idw),Z >= 0)
DCFS_012_rec_clip_normalized <- filter_poi(normalize_height(DCFS_012_circ_clip,DCFS_012_circ_clip_dtm_idw),Z >= 0)
DCFS_013_rec_clip_normalized <- filter_poi(normalize_height(DCFS_013_circ_clip,DCFS_013_circ_clip_dtm_idw),Z >= 0)
DCFS_014_rec_clip_normalized <- filter_poi(normalize_height(DCFS_014_circ_clip,DCFS_014_circ_clip_dtm_idw),Z >= 0)
DCFS_015_rec_clip_normalized <- filter_poi(normalize_height(DCFS_015_circ_clip,DCFS_015_circ_clip_dtm_idw),Z >= 0)
DCFS_016_rec_clip_normalized <- filter_poi(normalize_height(DCFS_016_circ_clip,DCFS_016_circ_clip_dtm_idw),Z >= 0)
DCFS_017_rec_clip_normalized <- filter_poi(normalize_height(DCFS_017_circ_clip,DCFS_017_circ_clip_dtm_idw),Z >= 0)
DCFS_018_rec_clip_normalized <- filter_poi(normalize_height(DCFS_018_circ_clip,DCFS_018_circ_clip_dtm_idw),Z >= 0)
DCFS_019_rec_clip_normalized <- filter_poi(normalize_height(DCFS_019_circ_clip,DCFS_019_circ_clip_dtm_idw),Z >= 0)
DCFS_024_rec_clip_normalized <- filter_poi(normalize_height(DCFS_024_circ_clip,DCFS_024_circ_clip_dtm_idw),Z >= 0)
DCFS_027_rec_clip_normalized <- filter_poi(normalize_height(DCFS_027_circ_clip,DCFS_027_circ_clip_dtm_idw),Z >= 0)
DCFS_028_rec_clip_normalized <- filter_poi(normalize_height(DCFS_028_circ_clip,DCFS_028_circ_clip_dtm_idw),Z >= 0)
DCFS_030_rec_clip_normalized <- filter_poi(normalize_height(DCFS_030_circ_clip,DCFS_030_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(DCFS_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_001_rec_clip_normalized.laz")
writeLAS(DCFS_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_003_rec_clip_normalized.laz")
writeLAS(DCFS_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_004_rec_clip_normalized.laz")
writeLAS(DCFS_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_005_rec_clip_normalized.laz")
writeLAS(DCFS_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_007_rec_clip_normalized.laz")
writeLAS(DCFS_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_009_rec_clip_normalized.laz")
writeLAS(DCFS_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_010_rec_clip_normalized.laz")
writeLAS(DCFS_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_011_rec_clip_normalized.laz")
writeLAS(DCFS_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_012_rec_clip_normalized.laz")
writeLAS(DCFS_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_013_rec_clip_normalized.laz")
writeLAS(DCFS_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_014_rec_clip_normalized.laz")
writeLAS(DCFS_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_015_rec_clip_normalized.laz")
writeLAS(DCFS_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_016_rec_clip_normalized.laz")
writeLAS(DCFS_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_017_rec_clip_normalized.laz")
writeLAS(DCFS_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_018_rec_clip_normalized.laz")
writeLAS(DCFS_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_019_rec_clip_normalized.laz")
writeLAS(DCFS_024_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_024_rec_clip_normalized.laz")
writeLAS(DCFS_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_027_rec_clip_normalized.laz")
writeLAS(DCFS_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_028_rec_clip_normalized.laz")
writeLAS(DCFS_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_DCFS/HtNorm_250_radius/DCFS_030_rec_clip_normalized.laz")

# Domain 9: NOGP #################### - point
ctg_NOGP <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/DP1.30003.001/neon-aop-products/2017/FullSite/D09/2017_NOGP_2/L1/DiscreteLidar/ClassifiedPointCloud") 
NOGP_001_circ_clip <- clip_circle(ctg_NOGP,353854.692364843,5185397.44459717,radius=250)
NOGP_002_circ_clip <- clip_circle(ctg_NOGP,354098.079328132,5184556.96446456,radius=250)
NOGP_003_circ_clip <- clip_circle(ctg_NOGP,353764.871797479,5184826.14387004,radius=250)
NOGP_005_circ_clip <- clip_circle(ctg_NOGP,353825.185421053,5183265.97656786,radius=250)
NOGP_007_circ_clip <- clip_circle(ctg_NOGP,354725.131981615,5186026.60140731,radius=250)
NOGP_008_circ_clip <- clip_circle(ctg_NOGP,354364.858825914,5182874.60140642,radius=250)
NOGP_010_circ_clip <- clip_circle(ctg_NOGP,353673.912185715,5180926.7891426,radius=250)
NOGP_013_circ_clip <- clip_circle(ctg_NOGP,353464.872172454,5181886.96219462,radius=250)
NOGP_014_circ_clip <- clip_circle(ctg_NOGP,354755.177484508,5185546.5583983,radius=250)
NOGP_015_circ_clip <- clip_circle(ctg_NOGP,354065.877617099,5183114.24210067,radius=250)
NOGP_016_circ_clip <- clip_circle(ctg_NOGP,353614.652741686,5182697.17633828,radius=250)
NOGP_017_circ_clip <- clip_circle(ctg_NOGP,353704.9148306,5183836.2836241,radius=250)
NOGP_018_circ_clip <- clip_circle(ctg_NOGP,353285.275012449,5180836.54318996,radius=250)
NOGP_019_circ_clip <- clip_circle(ctg_NOGP,354364.324724492,5183777.31702642,radius=250)
NOGP_020_circ_clip <- clip_circle(ctg_NOGP,354066.405631314,5182486.03898496,radius=250)
NOGP_022_circ_clip <- clip_circle(ctg_NOGP,354694.307736645,5184496.56639715,radius=250)
NOGP_027_circ_clip <- clip_circle(ctg_NOGP,354423.901702884,5183416.07922424,radius=250)
NOGP_028_circ_clip <- clip_circle(ctg_NOGP,354665.658071468,5184826.58771573,radius=250)
NOGP_029_circ_clip <- clip_circle(ctg_NOGP,353375.068819423,5183566.26566848,radius=250)
NOGP_041_circ_clip <- clip_circle(ctg_NOGP,353314.060488516,5182667.16043279,radius=250)
#
hist(NOGP_001_circ_clip@data$Z, breaks=100)
hist(NOGP_002_circ_clip@data$Z, breaks=100)
hist(NOGP_003_circ_clip@data$Z, breaks=100)
hist(NOGP_005_circ_clip@data$Z, breaks=100)
hist(NOGP_007_circ_clip@data$Z, breaks=100)
hist(NOGP_008_circ_clip@data$Z, breaks=100)
hist(NOGP_010_circ_clip@data$Z, breaks=100)
hist(NOGP_013_circ_clip@data$Z, breaks=100)
hist(NOGP_014_circ_clip@data$Z, breaks=100)
hist(NOGP_015_circ_clip@data$Z, breaks=100)
hist(NOGP_016_circ_clip@data$Z, breaks=100)
hist(NOGP_017_circ_clip@data$Z, breaks=100)
hist(NOGP_018_circ_clip@data$Z, breaks=100)
hist(NOGP_019_circ_clip@data$Z, breaks=100)
hist(NOGP_020_circ_clip@data$Z, breaks=100)
hist(NOGP_022_circ_clip@data$Z, breaks=100)
hist(NOGP_027_circ_clip@data$Z, breaks=100)
hist(NOGP_028_circ_clip@data$Z, breaks=100)
hist(NOGP_029_circ_clip@data$Z, breaks=100)
hist(NOGP_041_circ_clip@data$Z, breaks=100)
NOGP_001_circ_clip <- filter_poi(NOGP_001_circ_clip, Z >= 100, Z<= 650)
NOGP_002_circ_clip <- filter_poi(NOGP_002_circ_clip, Z >= 100, Z<= 600)
NOGP_003_circ_clip <- filter_poi(NOGP_003_circ_clip, Z >= 100, Z<= 650)
NOGP_005_circ_clip <- filter_poi(NOGP_005_circ_clip, Z >= 100, Z<= 650)
NOGP_007_circ_clip <- filter_poi(NOGP_007_circ_clip, Z >= 100, Z<= 650)
NOGP_008_circ_clip <- filter_poi(NOGP_008_circ_clip, Z >= 100, Z<= 650)
NOGP_010_circ_clip <- filter_poi(NOGP_010_circ_clip, Z >= 100, Z<= 595)
NOGP_013_circ_clip <- filter_poi(NOGP_013_circ_clip, Z >= 100, Z<= 600)
NOGP_014_circ_clip <- filter_poi(NOGP_014_circ_clip, Z >= 100, Z<= 600)
NOGP_015_circ_clip <- filter_poi(NOGP_015_circ_clip, Z >= 100, Z<= 700)
NOGP_016_circ_clip <- filter_poi(NOGP_016_circ_clip, Z >= 100, Z<= 600)
NOGP_017_circ_clip <- filter_poi(NOGP_017_circ_clip, Z >= 100, Z<= 700)
NOGP_018_circ_clip <- filter_poi(NOGP_018_circ_clip, Z >= 100, Z<= 600)
NOGP_019_circ_clip <- filter_poi(NOGP_019_circ_clip, Z >= 100, Z<= 600)
NOGP_020_circ_clip <- filter_poi(NOGP_020_circ_clip, Z >= 100, Z<= 700)
NOGP_022_circ_clip <- filter_poi(NOGP_022_circ_clip, Z >= 100, Z<= 600)
NOGP_027_circ_clip <- filter_poi(NOGP_027_circ_clip, Z >= 100, Z<= 600)
NOGP_028_circ_clip <- filter_poi(NOGP_028_circ_clip, Z >= 100, Z<= 600)
NOGP_029_circ_clip <- filter_poi(NOGP_029_circ_clip, Z >= 100, Z<= 600)
NOGP_041_circ_clip <- filter_poi(NOGP_041_circ_clip, Z >= 100, Z<= 600)
#
NOGP_001_circ_clip_dtm_idw <- grid_terrain(NOGP_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_002_circ_clip_dtm_idw <- grid_terrain(NOGP_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_003_circ_clip_dtm_idw <- grid_terrain(NOGP_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_005_circ_clip_dtm_idw <- grid_terrain(NOGP_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_007_circ_clip_dtm_idw <- grid_terrain(NOGP_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_008_circ_clip_dtm_idw <- grid_terrain(NOGP_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_010_circ_clip_dtm_idw <- grid_terrain(NOGP_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_013_circ_clip_dtm_idw <- grid_terrain(NOGP_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_014_circ_clip_dtm_idw <- grid_terrain(NOGP_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_015_circ_clip_dtm_idw <- grid_terrain(NOGP_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_016_circ_clip_dtm_idw <- grid_terrain(NOGP_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_017_circ_clip_dtm_idw <- grid_terrain(NOGP_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_018_circ_clip_dtm_idw <- grid_terrain(NOGP_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_019_circ_clip_dtm_idw <- grid_terrain(NOGP_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_020_circ_clip_dtm_idw <- grid_terrain(NOGP_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_022_circ_clip_dtm_idw <- grid_terrain(NOGP_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_027_circ_clip_dtm_idw <- grid_terrain(NOGP_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_028_circ_clip_dtm_idw <- grid_terrain(NOGP_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_029_circ_clip_dtm_idw <- grid_terrain(NOGP_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
NOGP_041_circ_clip_dtm_idw <- grid_terrain(NOGP_041_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
NOGP_001_rec_clip_normalized <- filter_poi(normalize_height(NOGP_001_circ_clip,NOGP_001_circ_clip_dtm_idw),Z >= 0)
NOGP_002_rec_clip_normalized <- filter_poi(normalize_height(NOGP_002_circ_clip,NOGP_002_circ_clip_dtm_idw),Z >= 0)
NOGP_003_rec_clip_normalized <- filter_poi(normalize_height(NOGP_003_circ_clip,NOGP_003_circ_clip_dtm_idw),Z >= 0)
NOGP_005_rec_clip_normalized <- filter_poi(normalize_height(NOGP_005_circ_clip,NOGP_005_circ_clip_dtm_idw),Z >= 0)
NOGP_007_rec_clip_normalized <- filter_poi(normalize_height(NOGP_007_circ_clip,NOGP_007_circ_clip_dtm_idw),Z >= 0)
NOGP_008_rec_clip_normalized <- filter_poi(normalize_height(NOGP_008_circ_clip,NOGP_008_circ_clip_dtm_idw),Z >= 0)
NOGP_010_rec_clip_normalized <- filter_poi(normalize_height(NOGP_010_circ_clip,NOGP_010_circ_clip_dtm_idw),Z >= 0)
NOGP_013_rec_clip_normalized <- filter_poi(normalize_height(NOGP_013_circ_clip,NOGP_013_circ_clip_dtm_idw),Z >= 0)
NOGP_014_rec_clip_normalized <- filter_poi(normalize_height(NOGP_014_circ_clip,NOGP_014_circ_clip_dtm_idw),Z >= 0)
NOGP_015_rec_clip_normalized <- filter_poi(normalize_height(NOGP_015_circ_clip,NOGP_015_circ_clip_dtm_idw),Z >= 0)
NOGP_016_rec_clip_normalized <- filter_poi(normalize_height(NOGP_016_circ_clip,NOGP_016_circ_clip_dtm_idw),Z >= 0)
NOGP_017_rec_clip_normalized <- filter_poi(normalize_height(NOGP_017_circ_clip,NOGP_017_circ_clip_dtm_idw),Z >= 0)
NOGP_018_rec_clip_normalized <- filter_poi(normalize_height(NOGP_018_circ_clip,NOGP_018_circ_clip_dtm_idw),Z >= 0)
NOGP_019_rec_clip_normalized <- filter_poi(normalize_height(NOGP_019_circ_clip,NOGP_019_circ_clip_dtm_idw),Z >= 0)
NOGP_020_rec_clip_normalized <- filter_poi(normalize_height(NOGP_020_circ_clip,NOGP_020_circ_clip_dtm_idw),Z >= 0)
NOGP_022_rec_clip_normalized <- filter_poi(normalize_height(NOGP_022_circ_clip,NOGP_022_circ_clip_dtm_idw),Z >= 0)
NOGP_027_rec_clip_normalized <- filter_poi(normalize_height(NOGP_027_circ_clip,NOGP_027_circ_clip_dtm_idw),Z >= 0)
NOGP_028_rec_clip_normalized <- filter_poi(normalize_height(NOGP_028_circ_clip,NOGP_028_circ_clip_dtm_idw),Z >= 0)
NOGP_029_rec_clip_normalized <- filter_poi(normalize_height(NOGP_029_circ_clip,NOGP_029_circ_clip_dtm_idw),Z >= 0)
NOGP_041_rec_clip_normalized <- filter_poi(normalize_height(NOGP_041_circ_clip,NOGP_041_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(NOGP_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_001_rec_clip_normalized.laz")
writeLAS(NOGP_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_002_rec_clip_normalized.laz")
writeLAS(NOGP_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_003_rec_clip_normalized.laz")
writeLAS(NOGP_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_005_rec_clip_normalized.laz")
writeLAS(NOGP_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_007_rec_clip_normalized.laz")
writeLAS(NOGP_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_008_rec_clip_normalized.laz")
writeLAS(NOGP_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_010_rec_clip_normalized.laz")
writeLAS(NOGP_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_013_rec_clip_normalized.laz")
writeLAS(NOGP_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_014_rec_clip_normalized.laz")
writeLAS(NOGP_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_015_rec_clip_normalized.laz")
writeLAS(NOGP_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_016_rec_clip_normalized.laz")
writeLAS(NOGP_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_017_rec_clip_normalized.laz")
writeLAS(NOGP_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_018_rec_clip_normalized.laz")
writeLAS(NOGP_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_019_rec_clip_normalized.laz")
writeLAS(NOGP_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_020_rec_clip_normalized.laz")
writeLAS(NOGP_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_022_rec_clip_normalized.laz")
writeLAS(NOGP_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_027_rec_clip_normalized.laz")
writeLAS(NOGP_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_028_rec_clip_normalized.laz")
writeLAS(NOGP_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_029_rec_clip_normalized.laz")
writeLAS(NOGP_041_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D09_NOGP/HtNorm_250_radius/NOGP_041_rec_clip_normalized.laz")

# Domain 10: RMNP ####################
ctg_RMNP <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/DP1.30003.001/neon-aop-products/2017/FullSite/D10/2017_RMNP_1/L1/DiscreteLidar/ClassifiedPointCloud")
RMNP_001_circ_clip <- clip_circle(ctg_RMNP,460338.522,4450395.101,radius=250)
RMNP_002_circ_clip <- clip_circle(ctg_RMNP,459627.084,4449691.727,radius=250)
RMNP_003_circ_clip <- clip_circle(ctg_RMNP,458848.172,4450285.651,radius=250)
RMNP_004_circ_clip <- clip_circle(ctg_RMNP,454111.181,4448564.942,radius=250)
RMNP_005_circ_clip <- clip_circle(ctg_RMNP,455193.233,4446475.838,radius=250)
RMNP_006_circ_clip <- clip_circle(ctg_RMNP,453771.306,4445414.471,radius=250)
RMNP_007_circ_clip <- clip_circle(ctg_RMNP,454337.672,4447795.697,radius=250)
RMNP_011_circ_clip <- clip_circle(ctg_RMNP,456373.651,4450529.152,radius=250)
RMNP_012_circ_clip <- clip_circle(ctg_RMNP,454581.106,4445437.906,radius=250)
RMNP_016_circ_clip <- clip_circle(ctg_RMNP,459499.164,4445042.295,radius=250)
RMNP_017_circ_clip <- clip_circle(ctg_RMNP,458062.6413,4450100.126,radius=250)
RMNP_018_circ_clip <- clip_circle(ctg_RMNP,454094.7104,4446240.018,radius=250)
#
hist(RMNP_001_circ_clip@data$Z, breaks=100)
hist(RMNP_002_circ_clip@data$Z, breaks=100)
hist(RMNP_003_circ_clip@data$Z, breaks=100)
hist(RMNP_004_circ_clip@data$Z, breaks=100)
hist(RMNP_005_circ_clip@data$Z, breaks=100)
hist(RMNP_006_circ_clip@data$Z, breaks=100)
hist(RMNP_007_circ_clip@data$Z, breaks=100)
hist(RMNP_011_circ_clip@data$Z, breaks=100)
hist(RMNP_012_circ_clip@data$Z, breaks=100)
hist(RMNP_016_circ_clip@data$Z, breaks=100)
hist(RMNP_017_circ_clip@data$Z, breaks=100)
hist(RMNP_018_circ_clip@data$Z, breaks=100)
RMNP_001_circ_clip <- filter_poi(RMNP_001_circ_clip, Z >= 100, Z<= 2900)
RMNP_002_circ_clip <- filter_poi(RMNP_002_circ_clip, Z >= 100, Z<= 2900)
RMNP_003_circ_clip <- filter_poi(RMNP_003_circ_clip, Z >= 100, Z<= 2900)
RMNP_004_circ_clip <- filter_poi(RMNP_004_circ_clip, Z >= 2500, Z<= 3100)
RMNP_005_circ_clip <- filter_poi(RMNP_005_circ_clip, Z >= 100, Z<= 3100)
RMNP_006_circ_clip <- filter_poi(RMNP_006_circ_clip, Z >= 100, Z<= 3200)
RMNP_007_circ_clip <- filter_poi(RMNP_007_circ_clip, Z >= 2500, Z<= 3200)
RMNP_011_circ_clip <- filter_poi(RMNP_011_circ_clip, Z >= 100, Z<= 600)
RMNP_012_circ_clip <- filter_poi(RMNP_012_circ_clip, Z >= 100, Z<= 3100)
RMNP_016_circ_clip <- filter_poi(RMNP_016_circ_clip, Z >= 100, Z<= 600)
RMNP_017_circ_clip <- filter_poi(RMNP_017_circ_clip, Z >= 2200, Z<= 2700)
RMNP_018_circ_clip <- filter_poi(RMNP_018_circ_clip, Z >= 100, Z<= 3100)
#
RMNP_001_circ_clip_dtm_idw <- grid_terrain(RMNP_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_002_circ_clip_dtm_idw <- grid_terrain(RMNP_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_003_circ_clip_dtm_idw <- grid_terrain(RMNP_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_004_circ_clip_dtm_idw <- grid_terrain(RMNP_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_005_circ_clip_dtm_idw <- grid_terrain(RMNP_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_006_circ_clip_dtm_idw <- grid_terrain(RMNP_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_007_circ_clip_dtm_idw <- grid_terrain(RMNP_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_011_circ_clip_dtm_idw <- grid_terrain(RMNP_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_012_circ_clip_dtm_idw <- grid_terrain(RMNP_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_016_circ_clip_dtm_idw <- grid_terrain(RMNP_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_017_circ_clip_dtm_idw <- grid_terrain(RMNP_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
RMNP_018_circ_clip_dtm_idw <- grid_terrain(RMNP_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
RMNP_001_rec_clip_normalized <- filter_poi(normalize_height(RMNP_001_circ_clip,RMNP_001_circ_clip_dtm_idw),Z >= 0)
RMNP_002_rec_clip_normalized <- filter_poi(normalize_height(RMNP_002_circ_clip,RMNP_002_circ_clip_dtm_idw),Z >= 0)
RMNP_003_rec_clip_normalized <- filter_poi(normalize_height(RMNP_003_circ_clip,RMNP_003_circ_clip_dtm_idw),Z >= 0)
RMNP_004_rec_clip_normalized <- filter_poi(normalize_height(RMNP_004_circ_clip,RMNP_004_circ_clip_dtm_idw),Z >= 0)
RMNP_005_rec_clip_normalized <- filter_poi(normalize_height(RMNP_005_circ_clip,RMNP_005_circ_clip_dtm_idw),Z >= 0)
RMNP_006_rec_clip_normalized <- filter_poi(normalize_height(RMNP_006_circ_clip,RMNP_006_circ_clip_dtm_idw),Z >= 0)
RMNP_007_rec_clip_normalized <- filter_poi(normalize_height(RMNP_007_circ_clip,RMNP_007_circ_clip_dtm_idw),Z >= 0)
RMNP_011_rec_clip_normalized <- filter_poi(normalize_height(RMNP_011_circ_clip,RMNP_011_circ_clip_dtm_idw),Z >= 0)
RMNP_012_rec_clip_normalized <- filter_poi(normalize_height(RMNP_012_circ_clip,RMNP_012_circ_clip_dtm_idw),Z >= 0)
RMNP_016_rec_clip_normalized <- filter_poi(normalize_height(RMNP_016_circ_clip,RMNP_016_circ_clip_dtm_idw),Z >= 0)
RMNP_017_rec_clip_normalized <- filter_poi(normalize_height(RMNP_017_circ_clip,RMNP_017_circ_clip_dtm_idw),Z >= 0)
RMNP_018_rec_clip_normalized <- filter_poi(normalize_height(RMNP_018_circ_clip,RMNP_018_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(RMNP_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_001_rec_clip_normalized.laz")
writeLAS(RMNP_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_002_rec_clip_normalized.laz")
writeLAS(RMNP_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_003_rec_clip_normalized.laz")
writeLAS(RMNP_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_004_rec_clip_normalized.laz")
writeLAS(RMNP_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_005_rec_clip_normalized.laz")
writeLAS(RMNP_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_006_rec_clip_normalized.laz")
writeLAS(RMNP_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_007_rec_clip_normalized.laz")
writeLAS(RMNP_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_011_rec_clip_normalized.laz")
writeLAS(RMNP_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_012_rec_clip_normalized.laz")
writeLAS(RMNP_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_016_rec_clip_normalized.laz")
writeLAS(RMNP_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_017_rec_clip_normalized.laz")
writeLAS(RMNP_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_RMNP/HtNorm_250_radius/RMNP_018_rec_clip_normalized.laz")

# Domain 10: STER #################### - point
ctg_STER <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/DP1.30003.001/neon-aop-products/2017/FullSite/D10/2017_STER_2/L1/DiscreteLidar/ClassifiedPointCloud") 
STER_005_circ_clip <- clip_circle(ctg_STER,666746.584721581,4480745.38513228,radius=250)
STER_006_circ_clip <- clip_circle(ctg_STER,666568.228125937,4481105.26035748,radius=250)
STER_018_circ_clip <- clip_circle(ctg_STER,666627.014151829,4481253.84098911,radius=250)
STER_026_circ_clip <- clip_circle(ctg_STER,667476.812556816,4482322.60536237,radius=250)
STER_027_circ_clip <- clip_circle(ctg_STER,667926.046863519,4483011.73527646,radius=250)
STER_028_circ_clip <- clip_circle(ctg_STER,667986.24753517,4482174.09504514,radius=250)
STER_029_circ_clip <- clip_circle(ctg_STER,668556.196258583,4481663.57282413,radius=250)
STER_032_circ_clip <- clip_circle(ctg_STER,667415.492850483,4482023.13288607,radius=250)
STER_033_circ_clip <- clip_circle(ctg_STER,668526.694377924,4482532.44629882,radius=250)
STER_035_circ_clip <- clip_circle(ctg_STER,668136.775365262,4481782.74876985,radius=250)
#
hist(STER_005_circ_clip@data$Z, breaks=100)
hist(STER_006_circ_clip@data$Z, breaks=100)
hist(STER_018_circ_clip@data$Z, breaks=100)
hist(STER_026_circ_clip@data$Z, breaks=100)
hist(STER_027_circ_clip@data$Z, breaks=100)
hist(STER_028_circ_clip@data$Z, breaks=100)
hist(STER_029_circ_clip@data$Z, breaks=100)
hist(STER_032_circ_clip@data$Z, breaks=100)
hist(STER_033_circ_clip@data$Z, breaks=100)
hist(STER_035_circ_clip@data$Z, breaks=100)
STER_005_circ_clip <- filter_poi(STER_005_circ_clip, Z >= 100, Z<= 600)
STER_006_circ_clip <- filter_poi(STER_006_circ_clip, Z >= 100, Z<= 600)
STER_018_circ_clip <- filter_poi(STER_018_circ_clip, Z >= 100, Z<= 1368)
STER_026_circ_clip <- filter_poi(STER_026_circ_clip, Z >= 100, Z<= 600)
STER_027_circ_clip <- filter_poi(STER_027_circ_clip, Z >= 100, Z<= 600)
STER_028_circ_clip <- filter_poi(STER_028_circ_clip, Z >= 1200, Z<= 1500)
STER_029_circ_clip <- filter_poi(STER_029_circ_clip, Z >= 100, Z<= 600)
STER_032_circ_clip <- filter_poi(STER_032_circ_clip, Z >= 1100, Z<= 1500)
STER_033_circ_clip <- filter_poi(STER_033_circ_clip, Z >= 100, Z<= 600)
STER_035_circ_clip <- filter_poi(STER_035_circ_clip, Z >= 100, Z<= 1370)
#
STER_005_circ_clip_dtm_idw <- grid_terrain(STER_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_006_circ_clip_dtm_idw <- grid_terrain(STER_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_018_circ_clip_dtm_idw <- grid_terrain(STER_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_026_circ_clip_dtm_idw <- grid_terrain(STER_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_027_circ_clip_dtm_idw <- grid_terrain(STER_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_028_circ_clip_dtm_idw <- grid_terrain(STER_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_029_circ_clip_dtm_idw <- grid_terrain(STER_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_032_circ_clip_dtm_idw <- grid_terrain(STER_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_033_circ_clip_dtm_idw <- grid_terrain(STER_033_circ_clip, algorithm = knnidw(k = 10L, p = 2))
STER_035_circ_clip_dtm_idw <- grid_terrain(STER_035_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
STER_005_rec_clip_normalized <- filter_poi(normalize_height(STER_005_circ_clip,STER_005_circ_clip_dtm_idw),Z >= 0)
STER_006_rec_clip_normalized <- filter_poi(normalize_height(STER_006_circ_clip,STER_006_circ_clip_dtm_idw),Z >= 0)
STER_018_rec_clip_normalized <- filter_poi(normalize_height(STER_018_circ_clip,STER_018_circ_clip_dtm_idw),Z >= 0)
STER_026_rec_clip_normalized <- filter_poi(normalize_height(STER_026_circ_clip,STER_026_circ_clip_dtm_idw),Z >= 0)
STER_027_rec_clip_normalized <- filter_poi(normalize_height(STER_027_circ_clip,STER_027_circ_clip_dtm_idw),Z >= 0)
STER_028_rec_clip_normalized <- filter_poi(normalize_height(STER_028_circ_clip,STER_028_circ_clip_dtm_idw),Z >= 0)
STER_029_rec_clip_normalized <- filter_poi(normalize_height(STER_029_circ_clip,STER_029_circ_clip_dtm_idw),Z >= 0)
STER_032_rec_clip_normalized <- filter_poi(normalize_height(STER_032_circ_clip,STER_032_circ_clip_dtm_idw),Z >= 0)
STER_033_rec_clip_normalized <- filter_poi(normalize_height(STER_033_circ_clip,STER_033_circ_clip_dtm_idw),Z >= 0)
STER_035_rec_clip_normalized <- filter_poi(normalize_height(STER_035_circ_clip,STER_035_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(STER_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_005_rec_clip_normalized.laz")
writeLAS(STER_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_006_rec_clip_normalized.laz")
writeLAS(STER_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_018_rec_clip_normalized.laz")
writeLAS(STER_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_026_rec_clip_normalized.laz")
writeLAS(STER_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_027_rec_clip_normalized.laz")
writeLAS(STER_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_028_rec_clip_normalized.laz")
writeLAS(STER_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_029_rec_clip_normalized.laz")
writeLAS(STER_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_032_rec_clip_normalized.laz")
writeLAS(STER_033_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_033_rec_clip_normalized.laz")
writeLAS(STER_035_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D10_STER/HtNorm_250_radius/STER_035_rec_clip_normalized.laz")

# Domain 11: OAES ####################
ctg_OAES <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/DP1.30003.001/neon-aop-products/2017/FullSite/D11/2017_OAES_2/L1/DiscreteLidar/ClassifiedPointCloud")
OAES_001_circ_clip <- clip_circle(ctg_OAES,494650.58,3919025.197,radius=250)
OAES_002_circ_clip <- clip_circle(ctg_OAES,495450.298,3919431.517,radius=250)
OAES_003_circ_clip <- clip_circle(ctg_OAES,493665.66,3918728.541,radius=250)
OAES_005_circ_clip <- clip_circle(ctg_OAES,492954.043,3917858.722,radius=250)
OAES_010_circ_clip <- clip_circle(ctg_OAES,494601.989,3917109.944,radius=250)
OAES_013_circ_clip <- clip_circle(ctg_OAES,494636.299,3918163.508,radius=250)
OAES_031_circ_clip <- clip_circle(ctg_OAES,493845.478,3917768.29,radius=250)
#
hist(OAES_001_circ_clip@data$Z, breaks=100)
hist(OAES_002_circ_clip@data$Z, breaks=100)
hist(OAES_003_circ_clip@data$Z, breaks=100)
hist(OAES_005_circ_clip@data$Z, breaks=100)
hist(OAES_010_circ_clip@data$Z, breaks=100)
hist(OAES_013_circ_clip@data$Z, breaks=100)
hist(OAES_031_circ_clip@data$Z, breaks=100)
OAES_001_circ_clip <- filter_poi(OAES_001_circ_clip, Z >= 100, Z<= 700)
OAES_002_circ_clip <- filter_poi(OAES_002_circ_clip, Z >= 100, Z<= 700)
OAES_003_circ_clip <- filter_poi(OAES_003_circ_clip, Z >= 100, Z<= 600)
OAES_005_circ_clip <- filter_poi(OAES_005_circ_clip, Z >= 100, Z<= 700)
OAES_010_circ_clip <- filter_poi(OAES_010_circ_clip, Z >= 100, Z<= 700)
OAES_013_circ_clip <- filter_poi(OAES_013_circ_clip, Z >= 100, Z<= 700)
OAES_031_circ_clip <- filter_poi(OAES_031_circ_clip, Z >= 100, Z<= 600)
#
OAES_001_circ_clip_dtm_idw <- grid_terrain(OAES_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_002_circ_clip_dtm_idw <- grid_terrain(OAES_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_003_circ_clip_dtm_idw <- grid_terrain(OAES_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_005_circ_clip_dtm_idw <- grid_terrain(OAES_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_010_circ_clip_dtm_idw <- grid_terrain(OAES_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_013_circ_clip_dtm_idw <- grid_terrain(OAES_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
OAES_031_circ_clip_dtm_idw <- grid_terrain(OAES_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
OAES_001_rec_clip_normalized <- filter_poi(normalize_height(OAES_001_circ_clip,OAES_001_circ_clip_dtm_idw),Z >= 0)
OAES_002_rec_clip_normalized <- filter_poi(normalize_height(OAES_002_circ_clip,OAES_002_circ_clip_dtm_idw),Z >= 0)
OAES_003_rec_clip_normalized <- filter_poi(normalize_height(OAES_003_circ_clip,OAES_003_circ_clip_dtm_idw),Z >= 0)
OAES_005_rec_clip_normalized <- filter_poi(normalize_height(OAES_005_circ_clip,OAES_005_circ_clip_dtm_idw),Z >= 0)
OAES_010_rec_clip_normalized <- filter_poi(normalize_height(OAES_010_circ_clip,OAES_010_circ_clip_dtm_idw),Z >= 0)
OAES_013_rec_clip_normalized <- filter_poi(normalize_height(OAES_013_circ_clip,OAES_013_circ_clip_dtm_idw),Z >= 0)
OAES_031_rec_clip_normalized <- filter_poi(normalize_height(OAES_031_circ_clip,OAES_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(OAES_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_001_rec_clip_normalized.laz")
writeLAS(OAES_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_002_rec_clip_normalized.laz")
writeLAS(OAES_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_003_rec_clip_normalized.laz")
writeLAS(OAES_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_005_rec_clip_normalized.laz")
writeLAS(OAES_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_010_rec_clip_normalized.laz")
writeLAS(OAES_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_013_rec_clip_normalized.laz")
writeLAS(OAES_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D11_OAES/HtNorm_250_radius/OAES_031_rec_clip_normalized.laz")

# Domain 13: MOAB ####################
ctg_MOAB <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/DP1.30003.001/neon-aop-products/2017/FullSite/D13/2017_MOAB_1/L1/DiscreteLidar/ClassifiedPointCloud")
MOAB_001_circ_clip <- clip_circle(ctg_MOAB,638793.41,4235519.683,radius=250)
MOAB_002_circ_clip <- clip_circle(ctg_MOAB,639018.897,4230390.683,radius=250)
MOAB_003_circ_clip <- clip_circle(ctg_MOAB,644704.343,4236014.97,radius=250)
MOAB_004_circ_clip <- clip_circle(ctg_MOAB,640229.102,4232746.756,radius=250)
MOAB_010_circ_clip <- clip_circle(ctg_MOAB,642166.005,4235392.357,radius=250)
MOAB_011_circ_clip <- clip_circle(ctg_MOAB,638946.445,4236480.644,radius=250)
MOAB_012_circ_clip <- clip_circle(ctg_MOAB,640900.137,4233641.953,radius=250)
MOAB_015_circ_clip <- clip_circle(ctg_MOAB,637365.353,4235267.018,radius=250)
MOAB_019_circ_clip <- clip_circle(ctg_MOAB,638745.471,4237482.882,radius=250)
MOAB_026_circ_clip <- clip_circle(ctg_MOAB,644504.0593,4237536.169,radius=250)
MOAB_032_circ_clip <- clip_circle(ctg_MOAB,643718.6285,4236909.551,radius=250)
MOAB_033_circ_clip <- clip_circle(ctg_MOAB,643302.4572,4237870.778,radius=250)
#
hist(MOAB_001_circ_clip@data$Z, breaks=100)
hist(MOAB_002_circ_clip@data$Z, breaks=100)
hist(MOAB_003_circ_clip@data$Z, breaks=100)
hist(MOAB_004_circ_clip@data$Z, breaks=100)
hist(MOAB_010_circ_clip@data$Z, breaks=100)
hist(MOAB_011_circ_clip@data$Z, breaks=100)
hist(MOAB_012_circ_clip@data$Z, breaks=100)
hist(MOAB_015_circ_clip@data$Z, breaks=100)
hist(MOAB_019_circ_clip@data$Z, breaks=100)
hist(MOAB_026_circ_clip@data$Z, breaks=100)
hist(MOAB_032_circ_clip@data$Z, breaks=100)
hist(MOAB_033_circ_clip@data$Z, breaks=100)
MOAB_001_circ_clip <- filter_poi(MOAB_001_circ_clip, Z >= 100, Z<= 1900)
MOAB_002_circ_clip <- filter_poi(MOAB_002_circ_clip, Z >= 100, Z<= 600)
MOAB_003_circ_clip <- filter_poi(MOAB_003_circ_clip, Z >= 100, Z<= 600)
MOAB_004_circ_clip <- filter_poi(MOAB_004_circ_clip, Z >= 1700, Z<= 1900)
MOAB_010_circ_clip <- filter_poi(MOAB_010_circ_clip, Z >= 100, Z<= 600)
MOAB_011_circ_clip <- filter_poi(MOAB_011_circ_clip, Z >= 100, Z<= 600)
MOAB_012_circ_clip <- filter_poi(MOAB_012_circ_clip, Z >= 1750, Z<= 1900)
MOAB_015_circ_clip <- filter_poi(MOAB_015_circ_clip, Z >= 100, Z<= 2000)
MOAB_019_circ_clip <- filter_poi(MOAB_019_circ_clip, Z >= 1700, Z<= 1900)
MOAB_026_circ_clip <- filter_poi(MOAB_026_circ_clip, Z >= 100, Z<= 600)
MOAB_032_circ_clip <- filter_poi(MOAB_032_circ_clip, Z >= 100, Z<= 600)
MOAB_033_circ_clip <- filter_poi(MOAB_033_circ_clip, Z >= 100, Z<= 600)
#
MOAB_001_circ_clip_dtm_idw <- grid_terrain(MOAB_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_002_circ_clip_dtm_idw <- grid_terrain(MOAB_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_003_circ_clip_dtm_idw <- grid_terrain(MOAB_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_004_circ_clip_dtm_idw <- grid_terrain(MOAB_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_010_circ_clip_dtm_idw <- grid_terrain(MOAB_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_011_circ_clip_dtm_idw <- grid_terrain(MOAB_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_012_circ_clip_dtm_idw <- grid_terrain(MOAB_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_015_circ_clip_dtm_idw <- grid_terrain(MOAB_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_019_circ_clip_dtm_idw <- grid_terrain(MOAB_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_026_circ_clip_dtm_idw <- grid_terrain(MOAB_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_032_circ_clip_dtm_idw <- grid_terrain(MOAB_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
MOAB_033_circ_clip_dtm_idw <- grid_terrain(MOAB_033_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
MOAB_001_rec_clip_normalized <- filter_poi(normalize_height(MOAB_001_circ_clip,MOAB_001_circ_clip_dtm_idw),Z >= 0)
MOAB_002_rec_clip_normalized <- filter_poi(normalize_height(MOAB_002_circ_clip,MOAB_002_circ_clip_dtm_idw),Z >= 0)
MOAB_003_rec_clip_normalized <- filter_poi(normalize_height(MOAB_003_circ_clip,MOAB_003_circ_clip_dtm_idw),Z >= 0)
MOAB_004_rec_clip_normalized <- filter_poi(normalize_height(MOAB_004_circ_clip,MOAB_004_circ_clip_dtm_idw),Z >= 0)
MOAB_010_rec_clip_normalized <- filter_poi(normalize_height(MOAB_010_circ_clip,MOAB_010_circ_clip_dtm_idw),Z >= 0)
MOAB_011_rec_clip_normalized <- filter_poi(normalize_height(MOAB_011_circ_clip,MOAB_011_circ_clip_dtm_idw),Z >= 0)
MOAB_012_rec_clip_normalized <- filter_poi(normalize_height(MOAB_012_circ_clip,MOAB_012_circ_clip_dtm_idw),Z >= 0)
MOAB_015_rec_clip_normalized <- filter_poi(normalize_height(MOAB_015_circ_clip,MOAB_015_circ_clip_dtm_idw),Z >= 0)
MOAB_019_rec_clip_normalized <- filter_poi(normalize_height(MOAB_019_circ_clip,MOAB_019_circ_clip_dtm_idw),Z >= 0)
MOAB_026_rec_clip_normalized <- filter_poi(normalize_height(MOAB_026_circ_clip,MOAB_026_circ_clip_dtm_idw),Z >= 0)
MOAB_032_rec_clip_normalized <- filter_poi(normalize_height(MOAB_032_circ_clip,MOAB_032_circ_clip_dtm_idw),Z >= 0)
MOAB_033_rec_clip_normalized <- filter_poi(normalize_height(MOAB_033_circ_clip,MOAB_033_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(MOAB_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_001_rec_clip_normalized.laz")
writeLAS(MOAB_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_002_rec_clip_normalized.laz")
writeLAS(MOAB_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_003_rec_clip_normalized.laz")
writeLAS(MOAB_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_004_rec_clip_normalized.laz")
writeLAS(MOAB_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_010_rec_clip_normalized.laz")
writeLAS(MOAB_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_011_rec_clip_normalized.laz")
writeLAS(MOAB_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_012_rec_clip_normalized.laz")
writeLAS(MOAB_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_015_rec_clip_normalized.laz")
writeLAS(MOAB_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_019_rec_clip_normalized.laz")
writeLAS(MOAB_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_026_rec_clip_normalized.laz")
writeLAS(MOAB_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_032_rec_clip_normalized.laz")
writeLAS(MOAB_033_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D13_MOAB/HtNorm_250_radius/MOAB_033_rec_clip_normalized.laz")

# Domain 14: JORN ####################
ctg_JORN <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/DP1.30003.001/neon-aop-products/2017/FullSite/D14/2017_JORN_1/L1/DiscreteLidar/ClassifiedPointCloud")
JORN_001_circ_clip <- clip_circle(ctg_JORN,330904.714,3608895.168,radius=250)
JORN_003_circ_clip <- clip_circle(ctg_JORN,327524.44,3608411.69,radius=250)
JORN_004_circ_clip <- clip_circle(ctg_JORN,325443.495,3611723.48,radius=250)
JORN_005_circ_clip <- clip_circle(ctg_JORN,330729.532,3605727.056,radius=250)
JORN_006_circ_clip <- clip_circle(ctg_JORN,328770.302,3607330.322,radius=250)
JORN_007_circ_clip <- clip_circle(ctg_JORN,325771.51,3609384.485,radius=250)
JORN_008_circ_clip <- clip_circle(ctg_JORN,331324.995,3607730.141,radius=250)
JORN_012_circ_clip <- clip_circle(ctg_JORN,329790.154,3610378.891,radius=250)
JORN_018_circ_clip <- clip_circle(ctg_JORN,326911.439,3610788.686,radius=250)
JORN_031_circ_clip <- clip_circle(ctg_JORN,328407.485,3609185.173,radius=250)
#
hist(JORN_001_circ_clip@data$Z, breaks=100)
hist(JORN_003_circ_clip@data$Z, breaks=100)
hist(JORN_004_circ_clip@data$Z, breaks=100)
hist(JORN_005_circ_clip@data$Z, breaks=100)
hist(JORN_006_circ_clip@data$Z, breaks=100)
hist(JORN_007_circ_clip@data$Z, breaks=100)
hist(JORN_008_circ_clip@data$Z, breaks=100)
hist(JORN_012_circ_clip@data$Z, breaks=100)
hist(JORN_018_circ_clip@data$Z, breaks=100)
hist(JORN_031_circ_clip@data$Z, breaks=100)
JORN_001_circ_clip <- filter_poi(JORN_001_circ_clip, Z >= 100, Z<= 600)
JORN_003_circ_clip <- filter_poi(JORN_003_circ_clip, Z >= 100, Z<= 1330)
JORN_004_circ_clip <- filter_poi(JORN_004_circ_clip, Z >= 1300, Z<= 1500)
JORN_005_circ_clip <- filter_poi(JORN_005_circ_clip, Z >= 100, Z<= 600)
JORN_006_circ_clip <- filter_poi(JORN_006_circ_clip, Z >= 100, Z<= 600)
JORN_007_circ_clip <- filter_poi(JORN_007_circ_clip, Z >= 1200, Z<= 1600)
JORN_008_circ_clip <- filter_poi(JORN_008_circ_clip, Z >= 1200, Z<= 1600)
JORN_012_circ_clip <- filter_poi(JORN_012_circ_clip, Z >= 1200, Z<= 1360)
JORN_018_circ_clip <- filter_poi(JORN_018_circ_clip, Z >= 100, Z<= 1600)
JORN_031_circ_clip <- filter_poi(JORN_031_circ_clip, Z >= 1200, Z<= 1600)
#
JORN_001_circ_clip_dtm_idw <- grid_terrain(JORN_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_003_circ_clip_dtm_idw <- grid_terrain(JORN_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_004_circ_clip_dtm_idw <- grid_terrain(JORN_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_005_circ_clip_dtm_idw <- grid_terrain(JORN_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_006_circ_clip_dtm_idw <- grid_terrain(JORN_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_007_circ_clip_dtm_idw <- grid_terrain(JORN_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_008_circ_clip_dtm_idw <- grid_terrain(JORN_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_012_circ_clip_dtm_idw <- grid_terrain(JORN_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_018_circ_clip_dtm_idw <- grid_terrain(JORN_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
JORN_031_circ_clip_dtm_idw <- grid_terrain(JORN_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
JORN_001_rec_clip_normalized <- filter_poi(normalize_height(JORN_001_circ_clip,JORN_001_circ_clip_dtm_idw),Z >= 0)
JORN_003_rec_clip_normalized <- filter_poi(normalize_height(JORN_003_circ_clip,JORN_003_circ_clip_dtm_idw),Z >= 0)
JORN_004_rec_clip_normalized <- filter_poi(normalize_height(JORN_004_circ_clip,JORN_004_circ_clip_dtm_idw),Z >= 0)
JORN_005_rec_clip_normalized <- filter_poi(normalize_height(JORN_005_circ_clip,JORN_005_circ_clip_dtm_idw),Z >= 0)
JORN_006_rec_clip_normalized <- filter_poi(normalize_height(JORN_006_circ_clip,JORN_006_circ_clip_dtm_idw),Z >= 0)
JORN_007_rec_clip_normalized <- filter_poi(normalize_height(JORN_007_circ_clip,JORN_007_circ_clip_dtm_idw),Z >= 0)
JORN_008_rec_clip_normalized <- filter_poi(normalize_height(JORN_008_circ_clip,JORN_008_circ_clip_dtm_idw),Z >= 0)
JORN_012_rec_clip_normalized <- filter_poi(normalize_height(JORN_012_circ_clip,JORN_012_circ_clip_dtm_idw),Z >= 0)
JORN_018_rec_clip_normalized <- filter_poi(normalize_height(JORN_018_circ_clip,JORN_018_circ_clip_dtm_idw),Z >= 0)
JORN_031_rec_clip_normalized <- filter_poi(normalize_height(JORN_031_circ_clip,JORN_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(JORN_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_001_rec_clip_normalized.laz")
writeLAS(JORN_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_003_rec_clip_normalized.laz")
writeLAS(JORN_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_004_rec_clip_normalized.laz")
writeLAS(JORN_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_005_rec_clip_normalized.laz")
writeLAS(JORN_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_006_rec_clip_normalized.laz")
writeLAS(JORN_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_007_rec_clip_normalized.laz")
writeLAS(JORN_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_008_rec_clip_normalized.laz")
writeLAS(JORN_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_012_rec_clip_normalized.laz")
writeLAS(JORN_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_018_rec_clip_normalized.laz")
writeLAS(JORN_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D14_JORN/HtNorm_250_radius/JORN_031_rec_clip_normalized.laz")

# Domain 16: ABBY #################### - point
ctg_ABBY <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/DP1.30003.001/neon-aop-products/2017/FullSite/D16/2017_ABBY_1/L1/DiscreteLidar/ClassifiedPointCloud") 
ABBY_001_circ_clip <- clip_circle(ctg_ABBY,550819.049778066,5068992.1287844,radius=250)
ABBY_002_circ_clip <- clip_circle(ctg_ABBY,553747.94840441,5065287.46057622,radius=250)
ABBY_003_circ_clip <- clip_circle(ctg_ABBY,548906.132543146,5067798.6959549,radius=250)
ABBY_004_circ_clip <- clip_circle(ctg_ABBY,554526.391298674,5068574.76603517,radius=250)
ABBY_005_circ_clip <- clip_circle(ctg_ABBY,547473.903080368,5068783.24154544,radius=250)
ABBY_006_circ_clip <- clip_circle(ctg_ABBY,554557.966107168,5066960.94022939,radius=250)
ABBY_007_circ_clip <- clip_circle(ctg_ABBY,549684.233654773,5068573.739602,radius=250)
ABBY_008_circ_clip <- clip_circle(ctg_ABBY,550131.792122895,5068846.43937313,radius=250)
ABBY_009_circ_clip <- clip_circle(ctg_ABBY,554467.389443488,5068244.25029156,radius=250)
ABBY_010_circ_clip <- clip_circle(ctg_ABBY,548516.999643442,5069410.3942179,radius=250)
ABBY_011_circ_clip <- clip_circle(ctg_ABBY,549863.526051046,5065733.56070986,radius=250)
ABBY_012_circ_clip <- clip_circle(ctg_ABBY,547890.408004763,5066929.36614528,radius=250)
ABBY_013_circ_clip <- clip_circle(ctg_ABBY,548787.304014831,5065944.02474331,radius=250)
ABBY_014_circ_clip <- clip_circle(ctg_ABBY,553093.779252095,5066629.71814115,radius=250)
ABBY_015_circ_clip <- clip_circle(ctg_ABBY,554436.098158709,5064540.44918049,radius=250)
ABBY_016_circ_clip <- clip_circle(ctg_ABBY,551927.720979049,5066154.21555472,radius=250)
ABBY_017_circ_clip <- clip_circle(ctg_ABBY,548997.269461196,5068993.61338223,radius=250)
ABBY_018_circ_clip <- clip_circle(ctg_ABBY,547684.040350575,5068068.0876041,radius=250)
ABBY_019_circ_clip <- clip_circle(ctg_ABBY,552435.077556614,5066780.46259118,radius=250)
ABBY_020_circ_clip <- clip_circle(ctg_ABBY,554169.018529261,5068483.97581482,radius=250)
ABBY_021_circ_clip <- clip_circle(ctg_ABBY,553122.283363709,5065823.85963759,radius=250)
ABBY_022_circ_clip <- clip_circle(ctg_ABBY,552853.063874079,5067111.77407154,radius=250)
ABBY_023_circ_clip <- clip_circle(ctg_ABBY,548099.374480496,5065856.11538089,radius=250)
ABBY_027_circ_clip <- clip_circle(ctg_ABBY,554645.642140503,5069560.36582609,radius=250)
ABBY_029_circ_clip <- clip_circle(ctg_ABBY,553364.371680911,5068064.13158902,radius=250)
ABBY_030_circ_clip <- clip_circle(ctg_ABBY,553150.836426453,5068990.62884789,radius=250)
#
hist(ABBY_001_circ_clip@data$Z, breaks=100)
hist(ABBY_002_circ_clip@data$Z, breaks=100)
hist(ABBY_003_circ_clip@data$Z, breaks=100)
hist(ABBY_004_circ_clip@data$Z, breaks=100)
hist(ABBY_005_circ_clip@data$Z, breaks=100)
hist(ABBY_006_circ_clip@data$Z, breaks=100)
hist(ABBY_007_circ_clip@data$Z, breaks=100)
hist(ABBY_008_circ_clip@data$Z, breaks=100)
hist(ABBY_009_circ_clip@data$Z, breaks=100)
hist(ABBY_010_circ_clip@data$Z, breaks=100)
hist(ABBY_011_circ_clip@data$Z, breaks=100)
hist(ABBY_012_circ_clip@data$Z, breaks=100)
hist(ABBY_013_circ_clip@data$Z, breaks=100)
hist(ABBY_014_circ_clip@data$Z, breaks=100)
hist(ABBY_015_circ_clip@data$Z, breaks=100)
hist(ABBY_016_circ_clip@data$Z, breaks=100)
hist(ABBY_017_circ_clip@data$Z, breaks=100)
hist(ABBY_018_circ_clip@data$Z, breaks=100)
hist(ABBY_019_circ_clip@data$Z, breaks=100)
hist(ABBY_020_circ_clip@data$Z, breaks=100)
hist(ABBY_021_circ_clip@data$Z, breaks=100)
hist(ABBY_022_circ_clip@data$Z, breaks=100)
hist(ABBY_023_circ_clip@data$Z, breaks=100)
hist(ABBY_027_circ_clip@data$Z, breaks=100)
hist(ABBY_029_circ_clip@data$Z, breaks=100)
hist(ABBY_030_circ_clip@data$Z, breaks=100)
ABBY_001_circ_clip <- filter_poi(ABBY_001_circ_clip, Z >= 0, Z<= 600)
ABBY_002_circ_clip <- filter_poi(ABBY_002_circ_clip, Z >= 100, Z<= 900)
ABBY_003_circ_clip <- filter_poi(ABBY_003_circ_clip, Z >= 400, Z<= 1000)
ABBY_004_circ_clip <- filter_poi(ABBY_004_circ_clip, Z >= 400, Z<= 1000)
ABBY_005_circ_clip <- filter_poi(ABBY_005_circ_clip, Z >= 300, Z<= 700)
ABBY_006_circ_clip <- filter_poi(ABBY_006_circ_clip, Z >= 200, Z<= 800)
ABBY_007_circ_clip <- filter_poi(ABBY_007_circ_clip, Z >= 100, Z<= 900)
ABBY_008_circ_clip <- filter_poi(ABBY_008_circ_clip, Z >= 200, Z<= 800)
ABBY_009_circ_clip <- filter_poi(ABBY_009_circ_clip, Z >= 400, Z<= 900)
ABBY_010_circ_clip <- filter_poi(ABBY_010_circ_clip, Z >= 100, Z<= 900)
ABBY_011_circ_clip <- filter_poi(ABBY_011_circ_clip, Z >= 100, Z<= 900)
ABBY_012_circ_clip <- filter_poi(ABBY_012_circ_clip, Z >= 100, Z<= 800)
ABBY_013_circ_clip <- filter_poi(ABBY_013_circ_clip, Z >= 100, Z<= 900)
ABBY_014_circ_clip <- filter_poi(ABBY_014_circ_clip, Z >= 100, Z<= 900)
ABBY_015_circ_clip <- filter_poi(ABBY_015_circ_clip, Z >= 500, Z<= 1000)
ABBY_016_circ_clip <- filter_poi(ABBY_016_circ_clip, Z >= 100, Z<= 900)
ABBY_017_circ_clip <- filter_poi(ABBY_017_circ_clip, Z >= 300, Z<= 900)
ABBY_018_circ_clip <- filter_poi(ABBY_018_circ_clip, Z >= 100, Z<= 900)
ABBY_019_circ_clip <- filter_poi(ABBY_019_circ_clip, Z >= 100, Z<= 540)
ABBY_020_circ_clip <- filter_poi(ABBY_020_circ_clip, Z >= 300, Z<= 900)
ABBY_021_circ_clip <- filter_poi(ABBY_021_circ_clip, Z >= 400, Z<= 900)
ABBY_022_circ_clip <- filter_poi(ABBY_022_circ_clip, Z >= 100, Z<= 900)
ABBY_023_circ_clip <- filter_poi(ABBY_023_circ_clip, Z >= 100, Z<= 900)
ABBY_027_circ_clip <- filter_poi(ABBY_027_circ_clip, Z >= 500, Z<= 900)
ABBY_029_circ_clip <- filter_poi(ABBY_029_circ_clip, Z >= 100, Z<= 600)
ABBY_030_circ_clip <- filter_poi(ABBY_030_circ_clip, Z >= 100, Z<= 900)
#
ABBY_001_circ_clip_dtm_idw <- grid_terrain(ABBY_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_002_circ_clip_dtm_idw <- grid_terrain(ABBY_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_003_circ_clip_dtm_idw <- grid_terrain(ABBY_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_004_circ_clip_dtm_idw <- grid_terrain(ABBY_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_005_circ_clip_dtm_idw <- grid_terrain(ABBY_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_006_circ_clip_dtm_idw <- grid_terrain(ABBY_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_007_circ_clip_dtm_idw <- grid_terrain(ABBY_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_008_circ_clip_dtm_idw <- grid_terrain(ABBY_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_009_circ_clip_dtm_idw <- grid_terrain(ABBY_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_010_circ_clip_dtm_idw <- grid_terrain(ABBY_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_011_circ_clip_dtm_idw <- grid_terrain(ABBY_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_012_circ_clip_dtm_idw <- grid_terrain(ABBY_012_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_013_circ_clip_dtm_idw <- grid_terrain(ABBY_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_014_circ_clip_dtm_idw <- grid_terrain(ABBY_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_015_circ_clip_dtm_idw <- grid_terrain(ABBY_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_016_circ_clip_dtm_idw <- grid_terrain(ABBY_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_017_circ_clip_dtm_idw <- grid_terrain(ABBY_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_018_circ_clip_dtm_idw <- grid_terrain(ABBY_018_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_019_circ_clip_dtm_idw <- grid_terrain(ABBY_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_020_circ_clip_dtm_idw <- grid_terrain(ABBY_020_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_021_circ_clip_dtm_idw <- grid_terrain(ABBY_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_022_circ_clip_dtm_idw <- grid_terrain(ABBY_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_023_circ_clip_dtm_idw <- grid_terrain(ABBY_023_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_027_circ_clip_dtm_idw <- grid_terrain(ABBY_027_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_029_circ_clip_dtm_idw <- grid_terrain(ABBY_029_circ_clip, algorithm = knnidw(k = 10L, p = 2))
ABBY_030_circ_clip_dtm_idw <- grid_terrain(ABBY_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
ABBY_001_rec_clip_normalized <- filter_poi(normalize_height(ABBY_001_circ_clip,ABBY_001_circ_clip_dtm_idw),Z >= 0)
ABBY_002_rec_clip_normalized <- filter_poi(normalize_height(ABBY_002_circ_clip,ABBY_002_circ_clip_dtm_idw),Z >= 0)
ABBY_003_rec_clip_normalized <- filter_poi(normalize_height(ABBY_003_circ_clip,ABBY_003_circ_clip_dtm_idw),Z >= 0)
ABBY_004_rec_clip_normalized <- filter_poi(normalize_height(ABBY_004_circ_clip,ABBY_004_circ_clip_dtm_idw),Z >= 0)
ABBY_005_rec_clip_normalized <- filter_poi(normalize_height(ABBY_005_circ_clip,ABBY_005_circ_clip_dtm_idw),Z >= 0)
ABBY_006_rec_clip_normalized <- filter_poi(normalize_height(ABBY_006_circ_clip,ABBY_006_circ_clip_dtm_idw),Z >= 0)
ABBY_007_rec_clip_normalized <- filter_poi(normalize_height(ABBY_007_circ_clip,ABBY_007_circ_clip_dtm_idw),Z >= 0)
ABBY_008_rec_clip_normalized <- filter_poi(normalize_height(ABBY_008_circ_clip,ABBY_008_circ_clip_dtm_idw),Z >= 0)
ABBY_009_rec_clip_normalized <- filter_poi(normalize_height(ABBY_009_circ_clip,ABBY_009_circ_clip_dtm_idw),Z >= 0)
ABBY_010_rec_clip_normalized <- filter_poi(normalize_height(ABBY_010_circ_clip,ABBY_010_circ_clip_dtm_idw),Z >= 0)
ABBY_011_rec_clip_normalized <- filter_poi(normalize_height(ABBY_011_circ_clip,ABBY_011_circ_clip_dtm_idw),Z >= 0)
ABBY_012_rec_clip_normalized <- filter_poi(normalize_height(ABBY_012_circ_clip,ABBY_012_circ_clip_dtm_idw),Z >= 0)
ABBY_013_rec_clip_normalized <- filter_poi(normalize_height(ABBY_013_circ_clip,ABBY_013_circ_clip_dtm_idw),Z >= 0)
ABBY_014_rec_clip_normalized <- filter_poi(normalize_height(ABBY_014_circ_clip,ABBY_014_circ_clip_dtm_idw),Z >= 0)
ABBY_015_rec_clip_normalized <- filter_poi(normalize_height(ABBY_015_circ_clip,ABBY_015_circ_clip_dtm_idw),Z >= 0)
ABBY_016_rec_clip_normalized <- filter_poi(normalize_height(ABBY_016_circ_clip,ABBY_016_circ_clip_dtm_idw),Z >= 0)
ABBY_017_rec_clip_normalized <- filter_poi(normalize_height(ABBY_017_circ_clip,ABBY_017_circ_clip_dtm_idw),Z >= 0)
ABBY_018_rec_clip_normalized <- filter_poi(normalize_height(ABBY_018_circ_clip,ABBY_018_circ_clip_dtm_idw),Z >= 0)
ABBY_019_rec_clip_normalized <- filter_poi(normalize_height(ABBY_019_circ_clip,ABBY_019_circ_clip_dtm_idw),Z >= 0)
ABBY_020_rec_clip_normalized <- filter_poi(normalize_height(ABBY_020_circ_clip,ABBY_020_circ_clip_dtm_idw),Z >= 0)
ABBY_021_rec_clip_normalized <- filter_poi(normalize_height(ABBY_021_circ_clip,ABBY_021_circ_clip_dtm_idw),Z >= 0)
ABBY_022_rec_clip_normalized <- filter_poi(normalize_height(ABBY_022_circ_clip,ABBY_022_circ_clip_dtm_idw),Z >= 0)
ABBY_023_rec_clip_normalized <- filter_poi(normalize_height(ABBY_023_circ_clip,ABBY_023_circ_clip_dtm_idw),Z >= 0)
ABBY_027_rec_clip_normalized <- filter_poi(normalize_height(ABBY_027_circ_clip,ABBY_027_circ_clip_dtm_idw),Z >= 0)
ABBY_029_rec_clip_normalized <- filter_poi(normalize_height(ABBY_029_circ_clip,ABBY_029_circ_clip_dtm_idw),Z >= 0)
ABBY_030_rec_clip_normalized <- filter_poi(normalize_height(ABBY_030_circ_clip,ABBY_030_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(ABBY_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_001_rec_clip_normalized.laz")
writeLAS(ABBY_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_002_rec_clip_normalized.laz")
writeLAS(ABBY_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_003_rec_clip_normalized.laz")
writeLAS(ABBY_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_004_rec_clip_normalized.laz")
writeLAS(ABBY_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_005_rec_clip_normalized.laz")
writeLAS(ABBY_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_006_rec_clip_normalized.laz")
writeLAS(ABBY_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_007_rec_clip_normalized.laz")
writeLAS(ABBY_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_008_rec_clip_normalized.laz")
writeLAS(ABBY_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_009_rec_clip_normalized.laz")
writeLAS(ABBY_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_010_rec_clip_normalized.laz")
writeLAS(ABBY_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_011_rec_clip_normalized.laz")
writeLAS(ABBY_012_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_012_rec_clip_normalized.laz")
writeLAS(ABBY_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_013_rec_clip_normalized.laz")
writeLAS(ABBY_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_014_rec_clip_normalized.laz")
writeLAS(ABBY_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_015_rec_clip_normalized.laz")
writeLAS(ABBY_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_016_rec_clip_normalized.laz")
writeLAS(ABBY_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_017_rec_clip_normalized.laz")
writeLAS(ABBY_018_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_018_rec_clip_normalized.laz")
writeLAS(ABBY_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_019_rec_clip_normalized.laz")
writeLAS(ABBY_020_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_020_rec_clip_normalized.laz")
writeLAS(ABBY_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_021_rec_clip_normalized.laz")
writeLAS(ABBY_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_022_rec_clip_normalized.laz")
writeLAS(ABBY_023_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_023_rec_clip_normalized.laz")
writeLAS(ABBY_027_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_027_rec_clip_normalized.laz")
writeLAS(ABBY_029_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_029_rec_clip_normalized.laz")
writeLAS(ABBY_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D16_ABBY/HtNorm_250_radius/ABBY_030_rec_clip_normalized.laz")

# Domain 17: SOAP #################### - point
ctg_SOAP <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/DP1.30003.001/neon-aop-products/2017/FullSite/D17/2017_SOAP_2/L1/DiscreteLidar/ClassifiedPointCloud") 
SOAP_001_circ_clip <- clip_circle(ctg_SOAP,297796.07783503,4101493.72978121,radius=250)
SOAP_002_circ_clip <- clip_circle(ctg_SOAP,297044.493276923,4100712.93207103,radius=250)
SOAP_003_circ_clip <- clip_circle(ctg_SOAP,299804.449662424,4101011.29777245,radius=250)
SOAP_004_circ_clip <- clip_circle(ctg_SOAP,298154.724348205,4101432.75868818,radius=250)
SOAP_005_circ_clip <- clip_circle(ctg_SOAP,298695.601215174,4100831.23265886,radius=250)
SOAP_006_circ_clip <- clip_circle(ctg_SOAP,297046.98478678,4100085.9308623,radius=250)
SOAP_007_circ_clip <- clip_circle(ctg_SOAP,299864.853167768,4100411.91612283,radius=250)
SOAP_008_circ_clip <- clip_circle(ctg_SOAP,297527.644756533,4100534.48629907,radius=250)
SOAP_009_circ_clip <- clip_circle(ctg_SOAP,299295.179687566,4101462.12106192,radius=250)
SOAP_010_circ_clip <- clip_circle(ctg_SOAP,297764.607957302,4101193.83593823,radius=250)
SOAP_011_circ_clip <- clip_circle(ctg_SOAP,298755.085054133,4101404.5711502,radius=250)
SOAP_015_circ_clip <- clip_circle(ctg_SOAP,299742.488829449,4101488.0408808,radius=250)
SOAP_016_circ_clip <- clip_circle(ctg_SOAP,299595.90775844,4100410.17949905,radius=250)
SOAP_017_circ_clip <- clip_circle(ctg_SOAP,300554.107201022,4100651.42360349,radius=250)
SOAP_019_circ_clip <- clip_circle(ctg_SOAP,300253.721382181,4100652.18439324,radius=250)
SOAP_023_circ_clip <- clip_circle(ctg_SOAP,300046.210236415,4101253.15175818,radius=250)
SOAP_026_circ_clip <- clip_circle(ctg_SOAP,298066.017240982,4100651.17750953,radius=250)
SOAP_028_circ_clip <- clip_circle(ctg_SOAP,297795.073136674,4100081.67185344,radius=250)
SOAP_030_circ_clip <- clip_circle(ctg_SOAP,297165.20617824,4101040.10469297,radius=250)
#
hist(SOAP_001_circ_clip@data$Z, breaks=100)
hist(SOAP_002_circ_clip@data$Z, breaks=100)
hist(SOAP_003_circ_clip@data$Z, breaks=100)
hist(SOAP_004_circ_clip@data$Z, breaks=100)
hist(SOAP_005_circ_clip@data$Z, breaks=100)
hist(SOAP_006_circ_clip@data$Z, breaks=100)
hist(SOAP_007_circ_clip@data$Z, breaks=100)
hist(SOAP_008_circ_clip@data$Z, breaks=100)
hist(SOAP_009_circ_clip@data$Z, breaks=100)
hist(SOAP_010_circ_clip@data$Z, breaks=100)
hist(SOAP_011_circ_clip@data$Z, breaks=100)
hist(SOAP_015_circ_clip@data$Z, breaks=100)
hist(SOAP_016_circ_clip@data$Z, breaks=100)
hist(SOAP_017_circ_clip@data$Z, breaks=100)
hist(SOAP_019_circ_clip@data$Z, breaks=100)
hist(SOAP_023_circ_clip@data$Z, breaks=100)
hist(SOAP_026_circ_clip@data$Z, breaks=100)
hist(SOAP_028_circ_clip@data$Z, breaks=100)
hist(SOAP_030_circ_clip@data$Z, breaks=100)
SOAP_001_circ_clip <- filter_poi(SOAP_001_circ_clip, Z >= 1000, Z<= 1600)
SOAP_002_circ_clip <- filter_poi(SOAP_002_circ_clip, Z >= 1000, Z<= 1600)
SOAP_003_circ_clip <- filter_poi(SOAP_003_circ_clip, Z >= 1000, Z<= 1600)
SOAP_004_circ_clip <- filter_poi(SOAP_004_circ_clip, Z >= 100, Z<= 1600)
SOAP_005_circ_clip <- filter_poi(SOAP_005_circ_clip, Z >= 100, Z<= 600)
SOAP_006_circ_clip <- filter_poi(SOAP_006_circ_clip, Z >= 1000, Z<= 1600)
SOAP_007_circ_clip <- filter_poi(SOAP_007_circ_clip, Z >= 1000, Z<= 1600)
SOAP_008_circ_clip <- filter_poi(SOAP_008_circ_clip, Z >= 1000, Z<= 1600)
SOAP_009_circ_clip <- filter_poi(SOAP_009_circ_clip, Z >= 100, Z<= 1600)
SOAP_010_circ_clip <- filter_poi(SOAP_010_circ_clip, Z >= 100, Z<= 1600)
SOAP_011_circ_clip <- filter_poi(SOAP_011_circ_clip, Z >= 1000, Z<= 1600)
SOAP_015_circ_clip <- filter_poi(SOAP_015_circ_clip, Z >= 100, Z<= 1600)
SOAP_016_circ_clip <- filter_poi(SOAP_016_circ_clip, Z >= 100, Z<= 1600)
SOAP_017_circ_clip <- filter_poi(SOAP_017_circ_clip, Z >= 100, Z<= 1600)
SOAP_019_circ_clip <- filter_poi(SOAP_019_circ_clip, Z >= 100, Z<= 1600)
SOAP_023_circ_clip <- filter_poi(SOAP_023_circ_clip, Z >= 800, Z<= 1500)
SOAP_026_circ_clip <- filter_poi(SOAP_026_circ_clip, Z >= 1000, Z<= 1600)
SOAP_028_circ_clip <- filter_poi(SOAP_028_circ_clip, Z >= 1000, Z<= 1600)
SOAP_030_circ_clip <- filter_poi(SOAP_030_circ_clip, Z >= 100, Z<= 1600)
#
SOAP_001_circ_clip_dtm_idw <- grid_terrain(SOAP_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_002_circ_clip_dtm_idw <- grid_terrain(SOAP_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_003_circ_clip_dtm_idw <- grid_terrain(SOAP_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_004_circ_clip_dtm_idw <- grid_terrain(SOAP_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_005_circ_clip_dtm_idw <- grid_terrain(SOAP_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_006_circ_clip_dtm_idw <- grid_terrain(SOAP_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_007_circ_clip_dtm_idw <- grid_terrain(SOAP_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_008_circ_clip_dtm_idw <- grid_terrain(SOAP_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_009_circ_clip_dtm_idw <- grid_terrain(SOAP_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_010_circ_clip_dtm_idw <- grid_terrain(SOAP_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_011_circ_clip_dtm_idw <- grid_terrain(SOAP_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_015_circ_clip_dtm_idw <- grid_terrain(SOAP_015_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_016_circ_clip_dtm_idw <- grid_terrain(SOAP_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_017_circ_clip_dtm_idw <- grid_terrain(SOAP_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_019_circ_clip_dtm_idw <- grid_terrain(SOAP_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_023_circ_clip_dtm_idw <- grid_terrain(SOAP_023_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_026_circ_clip_dtm_idw <- grid_terrain(SOAP_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_028_circ_clip_dtm_idw <- grid_terrain(SOAP_028_circ_clip, algorithm = knnidw(k = 10L, p = 2))
SOAP_030_circ_clip_dtm_idw <- grid_terrain(SOAP_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
SOAP_001_rec_clip_normalized <- filter_poi(normalize_height(SOAP_001_circ_clip,SOAP_001_circ_clip_dtm_idw),Z >= 0)
SOAP_002_rec_clip_normalized <- filter_poi(normalize_height(SOAP_002_circ_clip,SOAP_002_circ_clip_dtm_idw),Z >= 0)
SOAP_003_rec_clip_normalized <- filter_poi(normalize_height(SOAP_003_circ_clip,SOAP_003_circ_clip_dtm_idw),Z >= 0)
SOAP_004_rec_clip_normalized <- filter_poi(normalize_height(SOAP_004_circ_clip,SOAP_004_circ_clip_dtm_idw),Z >= 0)
SOAP_005_rec_clip_normalized <- filter_poi(normalize_height(SOAP_005_circ_clip,SOAP_005_circ_clip_dtm_idw),Z >= 0)
SOAP_006_rec_clip_normalized <- filter_poi(normalize_height(SOAP_006_circ_clip,SOAP_006_circ_clip_dtm_idw),Z >= 0)
SOAP_007_rec_clip_normalized <- filter_poi(normalize_height(SOAP_007_circ_clip,SOAP_007_circ_clip_dtm_idw),Z >= 0)
SOAP_008_rec_clip_normalized <- filter_poi(normalize_height(SOAP_008_circ_clip,SOAP_008_circ_clip_dtm_idw),Z >= 0)
SOAP_009_rec_clip_normalized <- filter_poi(normalize_height(SOAP_009_circ_clip,SOAP_009_circ_clip_dtm_idw),Z >= 0)
SOAP_010_rec_clip_normalized <- filter_poi(normalize_height(SOAP_010_circ_clip,SOAP_010_circ_clip_dtm_idw),Z >= 0)
SOAP_011_rec_clip_normalized <- filter_poi(normalize_height(SOAP_011_circ_clip,SOAP_011_circ_clip_dtm_idw),Z >= 0)
SOAP_015_rec_clip_normalized <- filter_poi(normalize_height(SOAP_015_circ_clip,SOAP_015_circ_clip_dtm_idw),Z >= 0)
SOAP_016_rec_clip_normalized <- filter_poi(normalize_height(SOAP_016_circ_clip,SOAP_016_circ_clip_dtm_idw),Z >= 0)
SOAP_017_rec_clip_normalized <- filter_poi(normalize_height(SOAP_017_circ_clip,SOAP_017_circ_clip_dtm_idw),Z >= 0)
SOAP_019_rec_clip_normalized <- filter_poi(normalize_height(SOAP_019_circ_clip,SOAP_019_circ_clip_dtm_idw),Z >= 0)
SOAP_023_rec_clip_normalized <- filter_poi(normalize_height(SOAP_023_circ_clip,SOAP_023_circ_clip_dtm_idw),Z >= 0)
SOAP_026_rec_clip_normalized <- filter_poi(normalize_height(SOAP_026_circ_clip,SOAP_026_circ_clip_dtm_idw),Z >= 0)
SOAP_028_rec_clip_normalized <- filter_poi(normalize_height(SOAP_028_circ_clip,SOAP_028_circ_clip_dtm_idw),Z >= 0)
SOAP_030_rec_clip_normalized <- filter_poi(normalize_height(SOAP_030_circ_clip,SOAP_030_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(SOAP_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_001_rec_clip_normalized.laz")
writeLAS(SOAP_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_002_rec_clip_normalized.laz")
writeLAS(SOAP_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_003_rec_clip_normalized.laz")
writeLAS(SOAP_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_004_rec_clip_normalized.laz")
writeLAS(SOAP_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_005_rec_clip_normalized.laz")
writeLAS(SOAP_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_006_rec_clip_normalized.laz")
writeLAS(SOAP_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_007_rec_clip_normalized.laz")
writeLAS(SOAP_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_008_rec_clip_normalized.laz")
writeLAS(SOAP_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_009_rec_clip_normalized.laz")
writeLAS(SOAP_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_010_rec_clip_normalized.laz")
writeLAS(SOAP_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_011_rec_clip_normalized.laz")
writeLAS(SOAP_015_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_015_rec_clip_normalized.laz")
writeLAS(SOAP_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_016_rec_clip_normalized.laz")
writeLAS(SOAP_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_017_rec_clip_normalized.laz")
writeLAS(SOAP_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_019_rec_clip_normalized.laz")
writeLAS(SOAP_023_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_023_rec_clip_normalized.laz")
writeLAS(SOAP_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_026_rec_clip_normalized.laz")
writeLAS(SOAP_028_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_028_rec_clip_normalized.laz")
writeLAS(SOAP_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_SOAP/HtNorm_250_radius/SOAP_030_rec_clip_normalized.laz")

# Domain 17: TEAK ####################
ctg_TEAK <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/DP1.30003.001/neon-aop-products/2017/FullSite/D17/2017_TEAK_2/L1/DiscreteLidar/ClassifiedPointCloud")
TEAK_001_circ_clip <- clip_circle(ctg_TEAK,320517.366,4094184.226,radius=250)
TEAK_003_circ_clip <- clip_circle(ctg_TEAK,321234.856,4098173.908,radius=250)
TEAK_004_circ_clip <- clip_circle(ctg_TEAK,318787.531,4096975.834,radius=250)
TEAK_006_circ_clip <- clip_circle(ctg_TEAK,317118.613,4094174.062,radius=250)
TEAK_007_circ_clip <- clip_circle(ctg_TEAK,317411.385,4096773.33,radius=250)
TEAK_008_circ_clip <- clip_circle(ctg_TEAK,319134.621,4101688.841,radius=250)
TEAK_009_circ_clip <- clip_circle(ctg_TEAK,320294.718,4102263.799,radius=250)
TEAK_010_circ_clip <- clip_circle(ctg_TEAK,317702.894,4098382.735,radius=250)
TEAK_013_circ_clip <- clip_circle(ctg_TEAK,318268.913,4094175.374,radius=250)
TEAK_025_circ_clip <- clip_circle(ctg_TEAK,319981.5397,4095602.459,radius=250)
TEAK_026_circ_clip <- clip_circle(ctg_TEAK,319638.1221,4100675.17,radius=250)
TEAK_031_circ_clip <- clip_circle(ctg_TEAK,318479.987,4095831.144,radius=250)
#
hist(TEAK_001_circ_clip@data$Z, breaks=100)
hist(TEAK_003_circ_clip@data$Z, breaks=100)
hist(TEAK_004_circ_clip@data$Z, breaks=100)
hist(TEAK_006_circ_clip@data$Z, breaks=100)
hist(TEAK_007_circ_clip@data$Z, breaks=100)
hist(TEAK_008_circ_clip@data$Z, breaks=100)
hist(TEAK_009_circ_clip@data$Z, breaks=100)
hist(TEAK_010_circ_clip@data$Z, breaks=100)
hist(TEAK_013_circ_clip@data$Z, breaks=100)
hist(TEAK_025_circ_clip@data$Z, breaks=100)
hist(TEAK_026_circ_clip@data$Z, breaks=100)
hist(TEAK_031_circ_clip@data$Z, breaks=100)
TEAK_001_circ_clip <- filter_poi(TEAK_001_circ_clip, Z >= 2000, Z<= 2400)
TEAK_003_circ_clip <- filter_poi(TEAK_003_circ_clip, Z >= 100, Z<= 2600)
TEAK_004_circ_clip <- filter_poi(TEAK_004_circ_clip, Z >= 2000, Z<= 2600)
TEAK_006_circ_clip <- filter_poi(TEAK_006_circ_clip, Z >= 100, Z<= 600)
TEAK_007_circ_clip <- filter_poi(TEAK_007_circ_clip, Z >= 100, Z<= 600)
TEAK_008_circ_clip <- filter_poi(TEAK_008_circ_clip, Z >= 100, Z<= 600)
TEAK_009_circ_clip <- filter_poi(TEAK_009_circ_clip, Z >= 2400, Z<= 3000)
TEAK_010_circ_clip <- filter_poi(TEAK_010_circ_clip, Z >= 2000, Z<= 3000)
TEAK_013_circ_clip <- filter_poi(TEAK_013_circ_clip, Z >= 2000, Z<= 2550)
TEAK_025_circ_clip <- filter_poi(TEAK_025_circ_clip, Z >= 2000, Z<= 3000)
TEAK_026_circ_clip <- filter_poi(TEAK_026_circ_clip, Z >= 2300, Z<= 3000)
TEAK_031_circ_clip <- filter_poi(TEAK_031_circ_clip, Z >= 2000, Z<= 3000)
#
TEAK_001_circ_clip_dtm_idw <- grid_terrain(TEAK_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_003_circ_clip_dtm_idw <- grid_terrain(TEAK_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_004_circ_clip_dtm_idw <- grid_terrain(TEAK_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_006_circ_clip_dtm_idw <- grid_terrain(TEAK_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_007_circ_clip_dtm_idw <- grid_terrain(TEAK_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_008_circ_clip_dtm_idw <- grid_terrain(TEAK_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_009_circ_clip_dtm_idw <- grid_terrain(TEAK_009_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_010_circ_clip_dtm_idw <- grid_terrain(TEAK_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_013_circ_clip_dtm_idw <- grid_terrain(TEAK_013_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_025_circ_clip_dtm_idw <- grid_terrain(TEAK_025_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_026_circ_clip_dtm_idw <- grid_terrain(TEAK_026_circ_clip, algorithm = knnidw(k = 10L, p = 2))
TEAK_031_circ_clip_dtm_idw <- grid_terrain(TEAK_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
TEAK_001_rec_clip_normalized <- filter_poi(normalize_height(TEAK_001_circ_clip,TEAK_001_circ_clip_dtm_idw),Z >= 0)
TEAK_003_rec_clip_normalized <- filter_poi(normalize_height(TEAK_003_circ_clip,TEAK_003_circ_clip_dtm_idw),Z >= 0)
TEAK_004_rec_clip_normalized <- filter_poi(normalize_height(TEAK_004_circ_clip,TEAK_004_circ_clip_dtm_idw),Z >= 0)
TEAK_006_rec_clip_normalized <- filter_poi(normalize_height(TEAK_006_circ_clip,TEAK_006_circ_clip_dtm_idw),Z >= 0)
TEAK_007_rec_clip_normalized <- filter_poi(normalize_height(TEAK_007_circ_clip,TEAK_007_circ_clip_dtm_idw),Z >= 0)
TEAK_008_rec_clip_normalized <- filter_poi(normalize_height(TEAK_008_circ_clip,TEAK_008_circ_clip_dtm_idw),Z >= 0)
TEAK_009_rec_clip_normalized <- filter_poi(normalize_height(TEAK_009_circ_clip,TEAK_009_circ_clip_dtm_idw),Z >= 0)
TEAK_010_rec_clip_normalized <- filter_poi(normalize_height(TEAK_010_circ_clip,TEAK_010_circ_clip_dtm_idw),Z >= 0)
TEAK_013_rec_clip_normalized <- filter_poi(normalize_height(TEAK_013_circ_clip,TEAK_013_circ_clip_dtm_idw),Z >= 0)
TEAK_025_rec_clip_normalized <- filter_poi(normalize_height(TEAK_025_circ_clip,TEAK_025_circ_clip_dtm_idw),Z >= 0)
TEAK_026_rec_clip_normalized <- filter_poi(normalize_height(TEAK_026_circ_clip,TEAK_026_circ_clip_dtm_idw),Z >= 0)
TEAK_031_rec_clip_normalized <- filter_poi(normalize_height(TEAK_031_circ_clip,TEAK_031_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(TEAK_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_001_rec_clip_normalized.laz")
writeLAS(TEAK_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_003_rec_clip_normalized.laz")
writeLAS(TEAK_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_004_rec_clip_normalized.laz")
writeLAS(TEAK_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_006_rec_clip_normalized.laz")
writeLAS(TEAK_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_007_rec_clip_normalized.laz")
writeLAS(TEAK_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_008_rec_clip_normalized.laz")
writeLAS(TEAK_009_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_009_rec_clip_normalized.laz")
writeLAS(TEAK_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_010_rec_clip_normalized.laz")
writeLAS(TEAK_013_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_013_rec_clip_normalized.laz")
writeLAS(TEAK_025_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_025_rec_clip_normalized.laz")
writeLAS(TEAK_026_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_026_rec_clip_normalized.laz")
writeLAS(TEAK_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D17_TEAK/HtNorm_250_radius/TEAK_031_rec_clip_normalized.laz")

# Domain 18: BARR ####################
ctg_BARR <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/DP1.30003.001/neon-aop-products/2017/FullSite/D18/2017_BARR_1/L1/DiscreteLidar/ClassifiedPointCloud")
BARR_021_circ_clip <- clip_circle(ctg_BARR,587675.591,7907558.936,radius=250)
BARR_030_circ_clip <- clip_circle(ctg_BARR,592392.528,7906805.996,radius=250)
BARR_031_circ_clip <- clip_circle(ctg_BARR,589098.736,7907135.821,radius=250)
BARR_034_circ_clip <- clip_circle(ctg_BARR,588464.315,7908114.702,radius=250)
BARR_035_circ_clip <- clip_circle(ctg_BARR,587811.973,7906797.11,radius=250)
BARR_038_circ_clip <- clip_circle(ctg_BARR,591355.305,7907437.729,radius=250)
BARR_039_circ_clip <- clip_circle(ctg_BARR,590385.977,7907647.347,radius=250)
BARR_040_circ_clip <- clip_circle(ctg_BARR,584956.5539,7913707.877,radius=250)
#
hist(BARR_021_circ_clip@data$Z, breaks=100)
hist(BARR_030_circ_clip@data$Z, breaks=100)
hist(BARR_031_circ_clip@data$Z, breaks=100)
hist(BARR_034_circ_clip@data$Z, breaks=100)
hist(BARR_035_circ_clip@data$Z, breaks=100)
hist(BARR_038_circ_clip@data$Z, breaks=100)
hist(BARR_039_circ_clip@data$Z, breaks=100)
hist(BARR_040_circ_clip@data$Z, breaks=100)
BARR_021_circ_clip <- filter_poi(BARR_021_circ_clip, Z >= 0, Z<= 40)
BARR_030_circ_clip <- filter_poi(BARR_030_circ_clip, Z >= 0, Z<= 600)
BARR_031_circ_clip <- filter_poi(BARR_031_circ_clip, Z >= 0, Z<= 600)
BARR_034_circ_clip <- filter_poi(BARR_034_circ_clip, Z >= 0, Z<= 600)
BARR_035_circ_clip <- filter_poi(BARR_035_circ_clip, Z >= 0, Z<= 25)
BARR_038_circ_clip <- filter_poi(BARR_038_circ_clip, Z >= 0, Z<= 600)
BARR_039_circ_clip <- filter_poi(BARR_039_circ_clip, Z >= 0, Z<= 600)
BARR_040_circ_clip <- filter_poi(BARR_040_circ_clip, Z >= 0, Z<= 600)
#
BARR_021_circ_clip_dtm_idw <- grid_terrain(BARR_021_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_030_circ_clip_dtm_idw <- grid_terrain(BARR_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_031_circ_clip_dtm_idw <- grid_terrain(BARR_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_034_circ_clip_dtm_idw <- grid_terrain(BARR_034_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_035_circ_clip_dtm_idw <- grid_terrain(BARR_035_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_038_circ_clip_dtm_idw <- grid_terrain(BARR_038_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_039_circ_clip_dtm_idw <- grid_terrain(BARR_039_circ_clip, algorithm = knnidw(k = 10L, p = 2))
BARR_040_circ_clip_dtm_idw <- grid_terrain(BARR_040_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
BARR_021_rec_clip_normalized <- filter_poi(normalize_height(BARR_021_circ_clip,BARR_021_circ_clip_dtm_idw),Z >= 0)
BARR_030_rec_clip_normalized <- filter_poi(normalize_height(BARR_030_circ_clip,BARR_030_circ_clip_dtm_idw),Z >= 0)
BARR_031_rec_clip_normalized <- filter_poi(normalize_height(BARR_031_circ_clip,BARR_031_circ_clip_dtm_idw),Z >= 0)
BARR_034_rec_clip_normalized <- filter_poi(normalize_height(BARR_034_circ_clip,BARR_034_circ_clip_dtm_idw),Z >= 0)
BARR_035_rec_clip_normalized <- filter_poi(normalize_height(BARR_035_circ_clip,BARR_035_circ_clip_dtm_idw),Z >= 0)
BARR_038_rec_clip_normalized <- filter_poi(normalize_height(BARR_038_circ_clip,BARR_038_circ_clip_dtm_idw),Z >= 0)
BARR_039_rec_clip_normalized <- filter_poi(normalize_height(BARR_039_circ_clip,BARR_039_circ_clip_dtm_idw),Z >= 0)
BARR_040_rec_clip_normalized <- filter_poi(normalize_height(BARR_040_circ_clip,BARR_040_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(BARR_021_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_021_rec_clip_normalized.laz")
writeLAS(BARR_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_030_rec_clip_normalized.laz")
writeLAS(BARR_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_031_rec_clip_normalized.laz")
writeLAS(BARR_034_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_034_rec_clip_normalized.laz")
writeLAS(BARR_035_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_035_rec_clip_normalized.laz")
writeLAS(BARR_038_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_038_rec_clip_normalized.laz")
writeLAS(BARR_039_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_039_rec_clip_normalized.laz")
writeLAS(BARR_040_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D18_BARR/HtNorm_250_radius/BARR_040_rec_clip_normalized.laz")

# Domain 19: DEJU ####################
ctg_DEJU <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/DP1.30003.001/neon-aop-products/2017/FullSite/D19/2017_DEJU_1/L1/DiscreteLidar/ClassifiedPointCloud")
DEJU_003_circ_clip <- clip_circle(ctg_DEJU,561023.044,7089779.105,radius=250)
DEJU_004_circ_clip <- clip_circle(ctg_DEJU,560748.526,7087649.403,radius=250)
DEJU_005_circ_clip <- clip_circle(ctg_DEJU,560949.708,7086255.072,radius=250)
DEJU_006_circ_clip <- clip_circle(ctg_DEJU,561471.843,7079475.662,radius=250)
DEJU_007_circ_clip <- clip_circle(ctg_DEJU,562622.572,7082738.522,radius=250)
DEJU_016_circ_clip <- clip_circle(ctg_DEJU,561098.56,7081588.491,radius=250)
DEJU_017_circ_clip <- clip_circle(ctg_DEJU,559978.862,7084599.978,radius=250)
DEJU_019_circ_clip <- clip_circle(ctg_DEJU,561152.935,7085249.096,radius=250)
DEJU_022_circ_clip <- clip_circle(ctg_DEJU,562575.314,7083538.022,radius=250)
DEJU_031_circ_clip <- clip_circle(ctg_DEJU,561489.0741,7083318.954,radius=250)
DEJU_032_circ_clip <- clip_circle(ctg_DEJU,561600.602,7080681.427,radius=250)
#
hist(DEJU_003_circ_clip@data$Z, breaks=100)
hist(DEJU_004_circ_clip@data$Z, breaks=100)
hist(DEJU_005_circ_clip@data$Z, breaks=100)
hist(DEJU_006_circ_clip@data$Z, breaks=100)
hist(DEJU_007_circ_clip@data$Z, breaks=100)
hist(DEJU_016_circ_clip@data$Z, breaks=100)
hist(DEJU_017_circ_clip@data$Z, breaks=100)
hist(DEJU_019_circ_clip@data$Z, breaks=100)
hist(DEJU_022_circ_clip@data$Z, breaks=100)
hist(DEJU_031_circ_clip@data$Z, breaks=100)
hist(DEJU_032_circ_clip@data$Z, breaks=100)
DEJU_003_circ_clip <- filter_poi(DEJU_003_circ_clip, Z >= 100, Z<= 480)
DEJU_004_circ_clip <- filter_poi(DEJU_004_circ_clip, Z >= 100, Z<= 600)
DEJU_005_circ_clip <- filter_poi(DEJU_005_circ_clip, Z >= 100, Z<= 600)
DEJU_006_circ_clip <- filter_poi(DEJU_006_circ_clip, Z >= 100, Z<= 600)
DEJU_007_circ_clip <- filter_poi(DEJU_007_circ_clip, Z >= 100, Z<= 600)
DEJU_016_circ_clip <- filter_poi(DEJU_016_circ_clip, Z >= 100, Z<= 600)
DEJU_017_circ_clip <- filter_poi(DEJU_017_circ_clip, Z >= 100, Z<= 600)
DEJU_019_circ_clip <- filter_poi(DEJU_019_circ_clip, Z >= 100, Z<= 700)
DEJU_022_circ_clip <- filter_poi(DEJU_022_circ_clip, Z >= 100, Z<= 700)
DEJU_031_circ_clip <- filter_poi(DEJU_031_circ_clip, Z >= 100, Z<= 600)
DEJU_032_circ_clip <- filter_poi(DEJU_032_circ_clip, Z >= 100, Z<= 600)
#
DEJU_003_circ_clip_dtm_idw <- grid_terrain(DEJU_003_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_004_circ_clip_dtm_idw <- grid_terrain(DEJU_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_005_circ_clip_dtm_idw <- grid_terrain(DEJU_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_006_circ_clip_dtm_idw <- grid_terrain(DEJU_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_007_circ_clip_dtm_idw <- grid_terrain(DEJU_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_016_circ_clip_dtm_idw <- grid_terrain(DEJU_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_017_circ_clip_dtm_idw <- grid_terrain(DEJU_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_019_circ_clip_dtm_idw <- grid_terrain(DEJU_019_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_022_circ_clip_dtm_idw <- grid_terrain(DEJU_022_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_031_circ_clip_dtm_idw <- grid_terrain(DEJU_031_circ_clip, algorithm = knnidw(k = 10L, p = 2))
DEJU_032_circ_clip_dtm_idw <- grid_terrain(DEJU_032_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
DEJU_003_rec_clip_normalized <- filter_poi(normalize_height(DEJU_003_circ_clip,DEJU_003_circ_clip_dtm_idw),Z >= 0)
DEJU_004_rec_clip_normalized <- filter_poi(normalize_height(DEJU_004_circ_clip,DEJU_004_circ_clip_dtm_idw),Z >= 0)
DEJU_005_rec_clip_normalized <- filter_poi(normalize_height(DEJU_005_circ_clip,DEJU_005_circ_clip_dtm_idw),Z >= 0)
DEJU_006_rec_clip_normalized <- filter_poi(normalize_height(DEJU_006_circ_clip,DEJU_006_circ_clip_dtm_idw),Z >= 0)
DEJU_007_rec_clip_normalized <- filter_poi(normalize_height(DEJU_007_circ_clip,DEJU_007_circ_clip_dtm_idw),Z >= 0)
DEJU_016_rec_clip_normalized <- filter_poi(normalize_height(DEJU_016_circ_clip,DEJU_016_circ_clip_dtm_idw),Z >= 0)
DEJU_017_rec_clip_normalized <- filter_poi(normalize_height(DEJU_017_circ_clip,DEJU_017_circ_clip_dtm_idw),Z >= 0)
DEJU_019_rec_clip_normalized <- filter_poi(normalize_height(DEJU_019_circ_clip,DEJU_019_circ_clip_dtm_idw),Z >= 0)
DEJU_022_rec_clip_normalized <- filter_poi(normalize_height(DEJU_022_circ_clip,DEJU_022_circ_clip_dtm_idw),Z >= 0)
DEJU_031_rec_clip_normalized <- filter_poi(normalize_height(DEJU_031_circ_clip,DEJU_031_circ_clip_dtm_idw),Z >= 0)
DEJU_032_rec_clip_normalized <- filter_poi(normalize_height(DEJU_032_circ_clip,DEJU_032_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(DEJU_003_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_003_rec_clip_normalized.laz")
writeLAS(DEJU_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_004_rec_clip_normalized.laz")
writeLAS(DEJU_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_005_rec_clip_normalized.laz")
writeLAS(DEJU_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_006_rec_clip_normalized.laz")
writeLAS(DEJU_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_007_rec_clip_normalized.laz")
writeLAS(DEJU_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_016_rec_clip_normalized.laz")
writeLAS(DEJU_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_017_rec_clip_normalized.laz")
writeLAS(DEJU_019_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_019_rec_clip_normalized.laz")
writeLAS(DEJU_022_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_022_rec_clip_normalized.laz")
writeLAS(DEJU_031_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_031_rec_clip_normalized.laz")
writeLAS(DEJU_032_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_DEJU/HtNorm_250_radius/DEJU_032_rec_clip_normalized.laz")

# Domain 19: HEAL ####################
ctg_HEAL <- readLAScatalog("/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/DP1.30003.001/neon-aop-products/2017/FullSite/D19/2017_HEAL_1/L1/DiscreteLidar/ClassifiedPointCloud")
HEAL_001_circ_clip <- clip_circle(ctg_HEAL,391739.724,7086468.279,radius=250)
HEAL_002_circ_clip <- clip_circle(ctg_HEAL,389943.625,7084549.797,radius=250)
HEAL_004_circ_clip <- clip_circle(ctg_HEAL,388259.326,7083781.239,radius=250)
HEAL_005_circ_clip <- clip_circle(ctg_HEAL,390782.988,7087475.13,radius=250)
HEAL_010_circ_clip <- clip_circle(ctg_HEAL,388937.972,7085369.946,radius=250)
HEAL_011_circ_clip <- clip_circle(ctg_HEAL,387007.154,7086445.68,radius=250)
HEAL_014_circ_clip <- clip_circle(ctg_HEAL,388311.507,7086325.033,radius=250)
HEAL_016_circ_clip <- clip_circle(ctg_HEAL,391804.023,7085184.556,radius=250)
HEAL_030_circ_clip <- clip_circle(ctg_HEAL,390898.019,7084370.089,radius=250)
HEAL_006_circ_clip <- clip_circle(ctg_HEAL,387611.8655,7084545.422,radius=250)
HEAL_007_circ_clip <- clip_circle(ctg_HEAL,388147.1838,7085478.306,radius=250)
HEAL_008_circ_clip <- clip_circle(ctg_HEAL,388286.0233,7087171.673,radius=250)
HEAL_017_circ_clip <- clip_circle(ctg_HEAL,389014.7592,7084242.837,radius=250)
#
hist(HEAL_001_circ_clip@data$Z, breaks=100)
hist(HEAL_002_circ_clip@data$Z, breaks=100)
hist(HEAL_004_circ_clip@data$Z, breaks=100)
hist(HEAL_005_circ_clip@data$Z, breaks=100)
hist(HEAL_010_circ_clip@data$Z, breaks=100)
hist(HEAL_011_circ_clip@data$Z, breaks=100)
hist(HEAL_014_circ_clip@data$Z, breaks=100)
hist(HEAL_016_circ_clip@data$Z, breaks=100)
hist(HEAL_030_circ_clip@data$Z, breaks=100)
hist(HEAL_006_circ_clip@data$Z, breaks=100)
hist(HEAL_007_circ_clip@data$Z, breaks=100)
hist(HEAL_008_circ_clip@data$Z, breaks=100)
hist(HEAL_017_circ_clip@data$Z, breaks=100)
HEAL_001_circ_clip <- filter_poi(HEAL_001_circ_clip, Z >= 400, Z<= 900)
HEAL_002_circ_clip <- filter_poi(HEAL_002_circ_clip, Z >= 600, Z<= 900)
HEAL_004_circ_clip <- filter_poi(HEAL_004_circ_clip, Z >= 600, Z<= 900)
HEAL_005_circ_clip <- filter_poi(HEAL_005_circ_clip, Z >= 500, Z<= 750)
HEAL_010_circ_clip <- filter_poi(HEAL_010_circ_clip, Z >= 600, Z<= 800)
HEAL_011_circ_clip <- filter_poi(HEAL_011_circ_clip, Z >= 100, Z<= 600)
HEAL_014_circ_clip <- filter_poi(HEAL_014_circ_clip, Z >= 600, Z<= 690)
HEAL_016_circ_clip <- filter_poi(HEAL_016_circ_clip, Z >= 500, Z<= 1000)
HEAL_030_circ_clip <- filter_poi(HEAL_030_circ_clip, Z >= 400, Z<= 900)
HEAL_006_circ_clip <- filter_poi(HEAL_006_circ_clip, Z >= 500, Z<= 900)
HEAL_007_circ_clip <- filter_poi(HEAL_007_circ_clip, Z >= 100, Z<= 800)
HEAL_008_circ_clip <- filter_poi(HEAL_008_circ_clip, Z >= 100, Z<= 900)
HEAL_017_circ_clip <- filter_poi(HEAL_017_circ_clip, Z >= 100, Z<= 600)
#
HEAL_001_circ_clip_dtm_idw <- grid_terrain(HEAL_001_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_002_circ_clip_dtm_idw <- grid_terrain(HEAL_002_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_004_circ_clip_dtm_idw <- grid_terrain(HEAL_004_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_005_circ_clip_dtm_idw <- grid_terrain(HEAL_005_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_010_circ_clip_dtm_idw <- grid_terrain(HEAL_010_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_011_circ_clip_dtm_idw <- grid_terrain(HEAL_011_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_014_circ_clip_dtm_idw <- grid_terrain(HEAL_014_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_016_circ_clip_dtm_idw <- grid_terrain(HEAL_016_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_030_circ_clip_dtm_idw <- grid_terrain(HEAL_030_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_006_circ_clip_dtm_idw <- grid_terrain(HEAL_006_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_007_circ_clip_dtm_idw <- grid_terrain(HEAL_007_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_008_circ_clip_dtm_idw <- grid_terrain(HEAL_008_circ_clip, algorithm = knnidw(k = 10L, p = 2))
HEAL_017_circ_clip_dtm_idw <- grid_terrain(HEAL_017_circ_clip, algorithm = knnidw(k = 10L, p = 2))
#
HEAL_001_rec_clip_normalized <- filter_poi(normalize_height(HEAL_001_circ_clip,HEAL_001_circ_clip_dtm_idw),Z >= 0)
HEAL_002_rec_clip_normalized <- filter_poi(normalize_height(HEAL_002_circ_clip,HEAL_002_circ_clip_dtm_idw),Z >= 0)
HEAL_004_rec_clip_normalized <- filter_poi(normalize_height(HEAL_004_circ_clip,HEAL_004_circ_clip_dtm_idw),Z >= 0)
HEAL_005_rec_clip_normalized <- filter_poi(normalize_height(HEAL_005_circ_clip,HEAL_005_circ_clip_dtm_idw),Z >= 0)
HEAL_010_rec_clip_normalized <- filter_poi(normalize_height(HEAL_010_circ_clip,HEAL_010_circ_clip_dtm_idw),Z >= 0)
HEAL_011_rec_clip_normalized <- filter_poi(normalize_height(HEAL_011_circ_clip,HEAL_011_circ_clip_dtm_idw),Z >= 0)
HEAL_014_rec_clip_normalized <- filter_poi(normalize_height(HEAL_014_circ_clip,HEAL_014_circ_clip_dtm_idw),Z >= 0)
HEAL_016_rec_clip_normalized <- filter_poi(normalize_height(HEAL_016_circ_clip,HEAL_016_circ_clip_dtm_idw),Z >= 0)
HEAL_030_rec_clip_normalized <- filter_poi(normalize_height(HEAL_030_circ_clip,HEAL_030_circ_clip_dtm_idw),Z >= 0)
HEAL_006_rec_clip_normalized <- filter_poi(normalize_height(HEAL_006_circ_clip,HEAL_006_circ_clip_dtm_idw),Z >= 0)
HEAL_007_rec_clip_normalized <- filter_poi(normalize_height(HEAL_007_circ_clip,HEAL_007_circ_clip_dtm_idw),Z >= 0)
HEAL_008_rec_clip_normalized <- filter_poi(normalize_height(HEAL_008_circ_clip,HEAL_008_circ_clip_dtm_idw),Z >= 0)
HEAL_017_rec_clip_normalized <- filter_poi(normalize_height(HEAL_017_circ_clip,HEAL_017_circ_clip_dtm_idw),Z >= 0)
#
writeLAS(HEAL_001_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_001_rec_clip_normalized.laz")
writeLAS(HEAL_002_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_002_rec_clip_normalized.laz")
writeLAS(HEAL_004_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_004_rec_clip_normalized.laz")
writeLAS(HEAL_005_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_005_rec_clip_normalized.laz")
writeLAS(HEAL_010_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_010_rec_clip_normalized.laz")
writeLAS(HEAL_011_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_011_rec_clip_normalized.laz")
writeLAS(HEAL_014_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_014_rec_clip_normalized.laz")
writeLAS(HEAL_016_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_016_rec_clip_normalized.laz")
writeLAS(HEAL_030_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_030_rec_clip_normalized.laz")
writeLAS(HEAL_006_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_006_rec_clip_normalized.laz")
writeLAS(HEAL_007_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_007_rec_clip_normalized.laz")
writeLAS(HEAL_008_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_008_rec_clip_normalized.laz")
writeLAS(HEAL_017_rec_clip_normalized, "/Users/colinsweeney/Documents/Documents/PhD/Chapter1/2017_LiDAR/D19_HEAL/HtNorm_250_radius/HEAL_017_rec_clip_normalized.laz")

################################################################################


